<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Reading in data locally and from the web | Data Science: A First Introduction</title>
  <meta name="description" content="This is a textbook for teaching a first introduction to data science." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Reading in data locally and from the web | Data Science: A First Introduction" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a textbook for teaching a first introduction to data science." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Reading in data locally and from the web | Data Science: A First Introduction" />
  
  <meta name="twitter:description" content="This is a textbook for teaching a first introduction to data science." />
  

<meta name="author" content="Tiffany-Anne Timbers" />
<meta name="author" content="Trevor Campbell" />
<meta name="author" content="Melissa Lee" />


<meta name="date" content="2021-01-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="wrangling.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Science: A First Introduction</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> R, Jupyter, and the tidyverse</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#chapter-learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#jupyter-notebooks"><i class="fa fa-check"></i><b>1.2</b> Jupyter notebooks</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#loading-a-spreadsheet-like-dataset"><i class="fa fa-check"></i><b>1.3</b> Loading a spreadsheet-like dataset</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#assigning-value-to-a-data-frame"><i class="fa fa-check"></i><b>1.4</b> Assigning value to a data frame</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#creating-subsets-of-data-frames-with-select-filter"><i class="fa fa-check"></i><b>1.5</b> Creating subsets of data frames with <code>select</code> &amp; <code>filter</code></a><ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#using-select-to-extract-multiple-columns"><i class="fa fa-check"></i><b>1.5.1</b> Using <code>select</code> to extract multiple columns</a></li>
<li class="chapter" data-level="1.5.2" data-path="index.html"><a href="index.html#using-select-to-extract-a-range-of-columns"><i class="fa fa-check"></i><b>1.5.2</b> Using <code>select</code> to extract a range of columns</a></li>
<li class="chapter" data-level="1.5.3" data-path="index.html"><a href="index.html#using-filter-to-extract-a-single-row"><i class="fa fa-check"></i><b>1.5.3</b> Using <code>filter</code> to extract a single row</a></li>
<li class="chapter" data-level="1.5.4" data-path="index.html"><a href="index.html#using-filter-to-extract-rows-with-values-above-a-threshold"><i class="fa fa-check"></i><b>1.5.4</b> Using <code>filter</code> to extract rows with values above a threshold</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#exploring-data-with-visualizations"><i class="fa fa-check"></i><b>1.6</b> Exploring data with visualizations</a><ul>
<li class="chapter" data-level="1.6.1" data-path="index.html"><a href="index.html#using-ggplot-to-create-a-scatter-plot"><i class="fa fa-check"></i><b>1.6.1</b> Using <code>ggplot</code> to create a scatter plot</a></li>
<li class="chapter" data-level="1.6.2" data-path="index.html"><a href="index.html#formatting-ggplot-objects"><i class="fa fa-check"></i><b>1.6.2</b> Formatting ggplot objects</a></li>
<li class="chapter" data-level="1.6.3" data-path="index.html"><a href="index.html#changing-the-units"><i class="fa fa-check"></i><b>1.6.3</b> Changing the units</a></li>
<li class="chapter" data-level="1.6.4" data-path="index.html"><a href="index.html#coloring-points-by-group"><i class="fa fa-check"></i><b>1.6.4</b> Coloring points by group</a></li>
<li class="chapter" data-level="1.6.5" data-path="index.html"><a href="index.html#putting-it-all-together"><i class="fa fa-check"></i><b>1.6.5</b> Putting it all together</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reading.html"><a href="reading.html"><i class="fa fa-check"></i><b>2</b> Reading in data locally and from the web</a><ul>
<li class="chapter" data-level="2.1" data-path="reading.html"><a href="reading.html#overview"><i class="fa fa-check"></i><b>2.1</b> Overview</a></li>
<li class="chapter" data-level="2.2" data-path="reading.html"><a href="reading.html#chapter-learning-objectives-1"><i class="fa fa-check"></i><b>2.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="2.3" data-path="reading.html"><a href="reading.html#absolute-and-relative-file-paths"><i class="fa fa-check"></i><b>2.3</b> Absolute and relative file paths</a></li>
<li class="chapter" data-level="2.4" data-path="reading.html"><a href="reading.html#reading-tabular-data-from-a-plain-text-file-into-r"><i class="fa fa-check"></i><b>2.4</b> Reading tabular data from a plain text file into R</a><ul>
<li class="chapter" data-level="2.4.1" data-path="reading.html"><a href="reading.html#skipping-rows-when-reading-in-data"><i class="fa fa-check"></i><b>2.4.1</b> Skipping rows when reading in data</a></li>
<li class="chapter" data-level="2.4.2" data-path="reading.html"><a href="reading.html#read_delim-as-a-more-flexible-method-to-get-tabular-data-into-r"><i class="fa fa-check"></i><b>2.4.2</b> <code>read_delim</code> as a more flexible method to get tabular data into R</a></li>
<li class="chapter" data-level="2.4.3" data-path="reading.html"><a href="reading.html#reading-tabular-data-directly-from-a-url"><i class="fa fa-check"></i><b>2.4.3</b> Reading tabular data directly from a URL</a></li>
<li class="chapter" data-level="2.4.4" data-path="reading.html"><a href="reading.html#previewing-a-data-file-before-reading-it-into-r"><i class="fa fa-check"></i><b>2.4.4</b> Previewing a data file before reading it into R</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="reading.html"><a href="reading.html#reading-data-from-an-microsoft-excel-file"><i class="fa fa-check"></i><b>2.5</b> Reading data from an Microsoft Excel file</a></li>
<li class="chapter" data-level="2.6" data-path="reading.html"><a href="reading.html#reading-data-from-a-database"><i class="fa fa-check"></i><b>2.6</b> Reading data from a database</a><ul>
<li class="chapter" data-level="2.6.1" data-path="reading.html"><a href="reading.html#connecting-to-a-database"><i class="fa fa-check"></i><b>2.6.1</b> Connecting to a database</a></li>
<li class="chapter" data-level="2.6.2" data-path="reading.html"><a href="reading.html#interacting-with-a-database"><i class="fa fa-check"></i><b>2.6.2</b> Interacting with a database</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="reading.html"><a href="reading.html#writing-data-from-r-to-a-.csv-file"><i class="fa fa-check"></i><b>2.7</b> Writing data from R to a <code>.csv</code> file</a></li>
<li class="chapter" data-level="2.8" data-path="reading.html"><a href="reading.html#scraping-data-off-the-web-using-r"><i class="fa fa-check"></i><b>2.8</b> Scraping data off the web using R</a><ul>
<li class="chapter" data-level="2.8.1" data-path="reading.html"><a href="reading.html#html-and-css-selectors"><i class="fa fa-check"></i><b>2.8.1</b> HTML and CSS selectors</a></li>
<li class="chapter" data-level="2.8.2" data-path="reading.html"><a href="reading.html#are-you-allowed-to-scrape-that-website"><i class="fa fa-check"></i><b>2.8.2</b> Are you allowed to scrape that website?</a></li>
<li class="chapter" data-level="2.8.3" data-path="reading.html"><a href="reading.html#using-rvest"><i class="fa fa-check"></i><b>2.8.3</b> Using <code>rvest</code></a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="reading.html"><a href="reading.html#additional-resources"><i class="fa fa-check"></i><b>2.9</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="wrangling.html"><a href="wrangling.html"><i class="fa fa-check"></i><b>3</b> Cleaning and wrangling data</a><ul>
<li class="chapter" data-level="3.1" data-path="wrangling.html"><a href="wrangling.html#overview-1"><i class="fa fa-check"></i><b>3.1</b> Overview</a></li>
<li class="chapter" data-level="3.2" data-path="wrangling.html"><a href="wrangling.html#chapter-learning-objectives-2"><i class="fa fa-check"></i><b>3.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="3.3" data-path="wrangling.html"><a href="wrangling.html#vectors-and-data-frames"><i class="fa fa-check"></i><b>3.3</b> Vectors and Data frames</a><ul>
<li class="chapter" data-level="3.3.1" data-path="wrangling.html"><a href="wrangling.html#what-is-a-data-frame"><i class="fa fa-check"></i><b>3.3.1</b> What is a data frame?</a></li>
<li class="chapter" data-level="3.3.2" data-path="wrangling.html"><a href="wrangling.html#what-is-a-vector"><i class="fa fa-check"></i><b>3.3.2</b> What is a vector?</a></li>
<li class="chapter" data-level="3.3.3" data-path="wrangling.html"><a href="wrangling.html#how-are-vectors-different-from-a-list"><i class="fa fa-check"></i><b>3.3.3</b> How are vectors different from a list?</a></li>
<li class="chapter" data-level="3.3.4" data-path="wrangling.html"><a href="wrangling.html#what-does-this-have-to-do-with-data-frames"><i class="fa fa-check"></i><b>3.3.4</b> What does this have to do with data frames?</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="wrangling.html"><a href="wrangling.html#tidy-data"><i class="fa fa-check"></i><b>3.4</b> Tidy Data</a><ul>
<li class="chapter" data-level="3.4.1" data-path="wrangling.html"><a href="wrangling.html#what-is-tidy-data"><i class="fa fa-check"></i><b>3.4.1</b> What is tidy data?</a></li>
<li class="chapter" data-level="3.4.2" data-path="wrangling.html"><a href="wrangling.html#why-is-tidy-data-important-in-r"><i class="fa fa-check"></i><b>3.4.2</b> Why is tidy data important in R?</a></li>
<li class="chapter" data-level="3.4.3" data-path="wrangling.html"><a href="wrangling.html#going-from-wide-to-long-or-tidy-using-pivot_longer"><i class="fa fa-check"></i><b>3.4.3</b> Going from wide to long (or tidy!) using <code>pivot_longer</code></a></li>
<li class="chapter" data-level="3.4.4" data-path="wrangling.html"><a href="wrangling.html#going-from-long-to-wide-using-pivot_wider"><i class="fa fa-check"></i><b>3.4.4</b> Going from long to wide using <code>pivot_wider</code></a></li>
<li class="chapter" data-level="3.4.5" data-path="wrangling.html"><a href="wrangling.html#using-separate-to-deal-with-multiple-delimiters"><i class="fa fa-check"></i><b>3.4.5</b> Using <code>separate</code> to deal with multiple delimiters</a></li>
<li class="chapter" data-level="3.4.6" data-path="wrangling.html"><a href="wrangling.html#notes-on-defining-tidy-data"><i class="fa fa-check"></i><b>3.4.6</b> Notes on defining tidy data</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="wrangling.html"><a href="wrangling.html#combining-functions-using-the-pipe-operator"><i class="fa fa-check"></i><b>3.5</b> Combining functions using the pipe operator, <code>%&gt;%</code>:</a><ul>
<li class="chapter" data-level="3.5.1" data-path="wrangling.html"><a href="wrangling.html#using-to-combine-filter-and-select"><i class="fa fa-check"></i><b>3.5.1</b> Using <code>%&gt;%</code> to combine <code>filter</code> and <code>select</code></a></li>
<li class="chapter" data-level="3.5.2" data-path="wrangling.html"><a href="wrangling.html#using-with-more-than-two-functions"><i class="fa fa-check"></i><b>3.5.2</b> Using <code>%&gt;%</code> with more than two functions</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="wrangling.html"><a href="wrangling.html#iterating-over-data-with-group_by-summarize"><i class="fa fa-check"></i><b>3.6</b> Iterating over data with <code>group_by</code> + <code>summarize</code></a><ul>
<li class="chapter" data-level="3.6.1" data-path="wrangling.html"><a href="wrangling.html#calculating-summary-statistics"><i class="fa fa-check"></i><b>3.6.1</b> Calculating summary statistics:</a></li>
<li class="chapter" data-level="3.6.2" data-path="wrangling.html"><a href="wrangling.html#calculating-group-summary-statistics"><i class="fa fa-check"></i><b>3.6.2</b> Calculating group summary statistics:</a></li>
<li class="chapter" data-level="3.6.3" data-path="wrangling.html"><a href="wrangling.html#additional-reading-on-the-dplyr-functions"><i class="fa fa-check"></i><b>3.6.3</b> Additional reading on the <code>dplyr</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="wrangling.html"><a href="wrangling.html#using-purrrs-map-functions-to-iterate"><i class="fa fa-check"></i><b>3.7</b> Using <code>purrr</code>’s <code>map*</code> functions to iterate</a></li>
<li class="chapter" data-level="3.8" data-path="wrangling.html"><a href="wrangling.html#additional-resources-1"><i class="fa fa-check"></i><b>3.8</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="viz.html"><a href="viz.html"><i class="fa fa-check"></i><b>4</b> Effective data visualization</a><ul>
<li class="chapter" data-level="4.1" data-path="viz.html"><a href="viz.html#overview-2"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="viz.html"><a href="viz.html#chapter-learning-objectives-3"><i class="fa fa-check"></i><b>4.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="4.3" data-path="viz.html"><a href="viz.html#choosing-the-visualization"><i class="fa fa-check"></i><b>4.3</b> Choosing the visualization</a></li>
<li class="chapter" data-level="4.4" data-path="viz.html"><a href="viz.html#refining-the-visualization"><i class="fa fa-check"></i><b>4.4</b> Refining the visualization</a></li>
<li class="chapter" data-level="4.5" data-path="viz.html"><a href="viz.html#creating-visualizations-with-ggplot2"><i class="fa fa-check"></i><b>4.5</b> Creating visualizations with <code>ggplot2</code></a><ul>
<li class="chapter" data-level="4.5.1" data-path="viz.html"><a href="viz.html#the-mauna-loa-co2-data-set"><i class="fa fa-check"></i><b>4.5.1</b> The Mauna Loa CO2 data set</a></li>
<li class="chapter" data-level="4.5.2" data-path="viz.html"><a href="viz.html#the-island-landmass-data-set"><i class="fa fa-check"></i><b>4.5.2</b> The island landmass data set</a></li>
<li class="chapter" data-level="4.5.3" data-path="viz.html"><a href="viz.html#the-old-faithful-eruptionwaiting-time-data-set"><i class="fa fa-check"></i><b>4.5.3</b> The Old Faithful eruption/waiting time data set</a></li>
<li class="chapter" data-level="4.5.4" data-path="viz.html"><a href="viz.html#the-michelson-speed-of-light-data-set"><i class="fa fa-check"></i><b>4.5.4</b> The Michelson speed of light data set</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="viz.html"><a href="viz.html#explaining-the-visualization"><i class="fa fa-check"></i><b>4.6</b> Explaining the visualization</a></li>
<li class="chapter" data-level="4.7" data-path="viz.html"><a href="viz.html#saving-the-visualization"><i class="fa fa-check"></i><b>4.7</b> Saving the visualization</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="version-control.html"><a href="version-control.html"><i class="fa fa-check"></i><b>5</b> Collaboration with version control</a><ul>
<li class="chapter" data-level="5.1" data-path="version-control.html"><a href="version-control.html#overview-3"><i class="fa fa-check"></i><b>5.1</b> Overview</a></li>
<li class="chapter" data-level="5.2" data-path="version-control.html"><a href="version-control.html#chapter-learning-objectives-4"><i class="fa fa-check"></i><b>5.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="5.3" data-path="version-control.html"><a href="version-control.html#what-is-version-control-and-why-should-i-use-it"><i class="fa fa-check"></i><b>5.3</b> What is version control, and why should I use it?</a></li>
<li class="chapter" data-level="5.4" data-path="version-control.html"><a href="version-control.html#creating-a-space-for-your-project-online"><i class="fa fa-check"></i><b>5.4</b> Creating a space for your project online</a></li>
<li class="chapter" data-level="5.5" data-path="version-control.html"><a href="version-control.html#creating-and-editing-files-on-github"><i class="fa fa-check"></i><b>5.5</b> Creating and editing files on GitHub</a><ul>
<li class="chapter" data-level="5.5.1" data-path="version-control.html"><a href="version-control.html#the-pen-tool"><i class="fa fa-check"></i><b>5.5.1</b> The pen tool</a></li>
<li class="chapter" data-level="5.5.2" data-path="version-control.html"><a href="version-control.html#the-add-file-menu"><i class="fa fa-check"></i><b>5.5.2</b> The “Add file” menu</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="version-control.html"><a href="version-control.html#cloning-your-repository-on-jupyterhub"><i class="fa fa-check"></i><b>5.6</b> Cloning your repository on JupyterHub</a></li>
<li class="chapter" data-level="5.7" data-path="version-control.html"><a href="version-control.html#working-in-a-cloned-repository-on-jupyterhub"><i class="fa fa-check"></i><b>5.7</b> Working in a cloned repository on JupyterHub</a><ul>
<li class="chapter" data-level="5.7.1" data-path="version-control.html"><a href="version-control.html#specifying-files-to-commit"><i class="fa fa-check"></i><b>5.7.1</b> Specifying files to commit</a></li>
<li class="chapter" data-level="5.7.2" data-path="version-control.html"><a href="version-control.html#making-the-commit"><i class="fa fa-check"></i><b>5.7.2</b> Making the commit</a></li>
<li class="chapter" data-level="5.7.3" data-path="version-control.html"><a href="version-control.html#pushing-the-commits-to-github"><i class="fa fa-check"></i><b>5.7.3</b> Pushing the commits to GitHub</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="version-control.html"><a href="version-control.html#collaboration"><i class="fa fa-check"></i><b>5.8</b> Collaboration</a><ul>
<li class="chapter" data-level="5.8.1" data-path="version-control.html"><a href="version-control.html#giving-collaborators-access-to-your-project"><i class="fa fa-check"></i><b>5.8.1</b> Giving collaborators access to your project</a></li>
<li class="chapter" data-level="5.8.2" data-path="version-control.html"><a href="version-control.html#pulling-changes-from-github"><i class="fa fa-check"></i><b>5.8.2</b> Pulling changes from GitHub</a></li>
<li class="chapter" data-level="5.8.3" data-path="version-control.html"><a href="version-control.html#handling-merge-conflicts"><i class="fa fa-check"></i><b>5.8.3</b> Handling merge conflicts</a></li>
<li class="chapter" data-level="5.8.4" data-path="version-control.html"><a href="version-control.html#communicating-using-github-issues"><i class="fa fa-check"></i><b>5.8.4</b> Communicating using GitHub issues</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="version-control.html"><a href="version-control.html#additional-resources-2"><i class="fa fa-check"></i><b>5.9</b> Additional resources</a><ul>
<li class="chapter" data-level="5.9.1" data-path="version-control.html"><a href="version-control.html#best-practices-and-workflows"><i class="fa fa-check"></i><b>5.9.1</b> Best practices and workflows</a></li>
<li class="chapter" data-level="5.9.2" data-path="version-control.html"><a href="version-control.html#technical-references"><i class="fa fa-check"></i><b>5.9.2</b> Technical references</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>6</b> Classification I: training &amp; predicting</a><ul>
<li class="chapter" data-level="6.1" data-path="classification.html"><a href="classification.html#overview-4"><i class="fa fa-check"></i><b>6.1</b> Overview</a></li>
<li class="chapter" data-level="6.2" data-path="classification.html"><a href="classification.html#chapter-learning-objectives-5"><i class="fa fa-check"></i><b>6.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="6.3" data-path="classification.html"><a href="classification.html#the-classification-problem"><i class="fa fa-check"></i><b>6.3</b> The classification problem</a></li>
<li class="chapter" data-level="6.4" data-path="classification.html"><a href="classification.html#exploring-a-labelled-data-set"><i class="fa fa-check"></i><b>6.4</b> Exploring a labelled data set</a></li>
<li class="chapter" data-level="6.5" data-path="classification.html"><a href="classification.html#classification-with-k-nearest-neighbours"><i class="fa fa-check"></i><b>6.5</b> Classification with K-nearest neighbours</a></li>
<li class="chapter" data-level="6.6" data-path="classification.html"><a href="classification.html#k-nearest-neighbours-with-tidymodels"><i class="fa fa-check"></i><b>6.6</b> K-nearest neighbours with <code>tidymodels</code></a></li>
<li class="chapter" data-level="6.7" data-path="classification.html"><a href="classification.html#data-preprocessing-with-tidymodels"><i class="fa fa-check"></i><b>6.7</b> Data preprocessing with <code>tidymodels</code></a><ul>
<li class="chapter" data-level="6.7.1" data-path="classification.html"><a href="classification.html#centering-and-scaling"><i class="fa fa-check"></i><b>6.7.1</b> Centering and scaling</a></li>
<li class="chapter" data-level="6.7.2" data-path="classification.html"><a href="classification.html#balancing"><i class="fa fa-check"></i><b>6.7.2</b> Balancing</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="classification.html"><a href="classification.html#putting-it-together-in-a-workflow"><i class="fa fa-check"></i><b>6.8</b> Putting it together in a <code>workflow</code></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="classification-continued.html"><a href="classification-continued.html"><i class="fa fa-check"></i><b>7</b> Classification II: evaluation &amp; tuning</a><ul>
<li class="chapter" data-level="7.1" data-path="classification-continued.html"><a href="classification-continued.html#overview-5"><i class="fa fa-check"></i><b>7.1</b> Overview</a></li>
<li class="chapter" data-level="7.2" data-path="classification-continued.html"><a href="classification-continued.html#chapter-learning-objectives-6"><i class="fa fa-check"></i><b>7.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="7.3" data-path="classification-continued.html"><a href="classification-continued.html#evaluating-accuracy"><i class="fa fa-check"></i><b>7.3</b> Evaluating accuracy</a></li>
<li class="chapter" data-level="7.4" data-path="classification-continued.html"><a href="classification-continued.html#tuning-the-classifier"><i class="fa fa-check"></i><b>7.4</b> Tuning the classifier</a><ul>
<li class="chapter" data-level="7.4.1" data-path="classification-continued.html"><a href="classification-continued.html#cross-validation"><i class="fa fa-check"></i><b>7.4.1</b> Cross-validation</a></li>
<li class="chapter" data-level="7.4.2" data-path="classification-continued.html"><a href="classification-continued.html#parameter-value-selection"><i class="fa fa-check"></i><b>7.4.2</b> Parameter value selection</a></li>
<li class="chapter" data-level="7.4.3" data-path="classification-continued.html"><a href="classification-continued.html#underoverfitting"><i class="fa fa-check"></i><b>7.4.3</b> Under/overfitting</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="classification-continued.html"><a href="classification-continued.html#splitting-data"><i class="fa fa-check"></i><b>7.5</b> Splitting data</a></li>
<li class="chapter" data-level="7.6" data-path="classification-continued.html"><a href="classification-continued.html#summary"><i class="fa fa-check"></i><b>7.6</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="regression1.html"><a href="regression1.html"><i class="fa fa-check"></i><b>8</b> Regression I: K-nearest neighbours</a><ul>
<li class="chapter" data-level="8.1" data-path="regression1.html"><a href="regression1.html#overview-6"><i class="fa fa-check"></i><b>8.1</b> Overview</a></li>
<li class="chapter" data-level="8.2" data-path="regression1.html"><a href="regression1.html#chapter-learning-objectives-7"><i class="fa fa-check"></i><b>8.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="8.3" data-path="regression1.html"><a href="regression1.html#regression"><i class="fa fa-check"></i><b>8.3</b> Regression</a></li>
<li class="chapter" data-level="8.4" data-path="regression1.html"><a href="regression1.html#sacremento-real-estate-example"><i class="fa fa-check"></i><b>8.4</b> Sacremento real estate example</a></li>
<li class="chapter" data-level="8.5" data-path="regression1.html"><a href="regression1.html#k-nearest-neighbours-regression"><i class="fa fa-check"></i><b>8.5</b> K-nearest neighbours regression</a></li>
<li class="chapter" data-level="8.6" data-path="regression1.html"><a href="regression1.html#training-evaluating-and-tuning-the-model"><i class="fa fa-check"></i><b>8.6</b> Training, evaluating, and tuning the model</a></li>
<li class="chapter" data-level="8.7" data-path="regression1.html"><a href="regression1.html#underfitting-and-overfitting"><i class="fa fa-check"></i><b>8.7</b> Underfitting and overfitting</a></li>
<li class="chapter" data-level="8.8" data-path="regression1.html"><a href="regression1.html#evaluating-on-the-test-set"><i class="fa fa-check"></i><b>8.8</b> Evaluating on the test set</a></li>
<li class="chapter" data-level="8.9" data-path="regression1.html"><a href="regression1.html#strengths-and-limitations-of-k-nn-regression"><i class="fa fa-check"></i><b>8.9</b> Strengths and limitations of K-NN regression</a></li>
<li class="chapter" data-level="8.10" data-path="regression1.html"><a href="regression1.html#multivariate-k-nn-regression"><i class="fa fa-check"></i><b>8.10</b> Multivariate K-NN regression</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="regression2.html"><a href="regression2.html"><i class="fa fa-check"></i><b>9</b> Regression II: linear regression</a><ul>
<li class="chapter" data-level="9.1" data-path="regression2.html"><a href="regression2.html#overview-7"><i class="fa fa-check"></i><b>9.1</b> Overview</a></li>
<li class="chapter" data-level="9.2" data-path="regression2.html"><a href="regression2.html#chapter-learning-objectives-8"><i class="fa fa-check"></i><b>9.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="9.3" data-path="regression2.html"><a href="regression2.html#simple-linear-regression"><i class="fa fa-check"></i><b>9.3</b> Simple linear regression</a></li>
<li class="chapter" data-level="9.4" data-path="regression2.html"><a href="regression2.html#linear-regression-in-r"><i class="fa fa-check"></i><b>9.4</b> Linear regression in R</a></li>
<li class="chapter" data-level="9.5" data-path="regression2.html"><a href="regression2.html#comparing-simple-linear-and-k-nn-regression"><i class="fa fa-check"></i><b>9.5</b> Comparing simple linear and K-NN regression</a></li>
<li class="chapter" data-level="9.6" data-path="regression2.html"><a href="regression2.html#multivariate-linear-regression"><i class="fa fa-check"></i><b>9.6</b> Multivariate linear regression</a></li>
<li class="chapter" data-level="9.7" data-path="regression2.html"><a href="regression2.html#the-other-side-of-regression"><i class="fa fa-check"></i><b>9.7</b> The other side of regression</a></li>
<li class="chapter" data-level="9.8" data-path="regression2.html"><a href="regression2.html#additional-resources-3"><i class="fa fa-check"></i><b>9.8</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>10</b> Clustering</a><ul>
<li class="chapter" data-level="10.1" data-path="clustering.html"><a href="clustering.html#overview-8"><i class="fa fa-check"></i><b>10.1</b> Overview</a></li>
<li class="chapter" data-level="10.2" data-path="clustering.html"><a href="clustering.html#chapter-learning-objectives-9"><i class="fa fa-check"></i><b>10.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="10.3" data-path="clustering.html"><a href="clustering.html#clustering-1"><i class="fa fa-check"></i><b>10.3</b> Clustering</a></li>
<li class="chapter" data-level="10.4" data-path="clustering.html"><a href="clustering.html#k-means"><i class="fa fa-check"></i><b>10.4</b> K-means</a><ul>
<li class="chapter" data-level="10.4.1" data-path="clustering.html"><a href="clustering.html#measuring-cluster-quality"><i class="fa fa-check"></i><b>10.4.1</b> Measuring cluster quality</a></li>
<li class="chapter" data-level="10.4.2" data-path="clustering.html"><a href="clustering.html#the-clustering-algorithm"><i class="fa fa-check"></i><b>10.4.2</b> The clustering algorithm</a></li>
<li class="chapter" data-level="10.4.3" data-path="clustering.html"><a href="clustering.html#random-restarts"><i class="fa fa-check"></i><b>10.4.3</b> Random restarts</a></li>
<li class="chapter" data-level="10.4.4" data-path="clustering.html"><a href="clustering.html#choosing-k"><i class="fa fa-check"></i><b>10.4.4</b> Choosing K</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="clustering.html"><a href="clustering.html#data-pre-processing-for-k-means"><i class="fa fa-check"></i><b>10.5</b> Data pre-processing for K-means</a></li>
<li class="chapter" data-level="10.6" data-path="clustering.html"><a href="clustering.html#k-means-in-r"><i class="fa fa-check"></i><b>10.6</b> K-means in R</a></li>
<li class="chapter" data-level="10.7" data-path="clustering.html"><a href="clustering.html#additional-resources-4"><i class="fa fa-check"></i><b>10.7</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>11</b> Introduction to Statistical Inference</a><ul>
<li class="chapter" data-level="11.1" data-path="inference.html"><a href="inference.html#overview-9"><i class="fa fa-check"></i><b>11.1</b> Overview</a></li>
<li class="chapter" data-level="11.2" data-path="inference.html"><a href="inference.html#chapter-learning-objectives-10"><i class="fa fa-check"></i><b>11.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="11.3" data-path="inference.html"><a href="inference.html#why-do-we-need-sampling"><i class="fa fa-check"></i><b>11.3</b> Why do we need sampling?</a></li>
<li class="chapter" data-level="11.4" data-path="inference.html"><a href="inference.html#sampling-distributions"><i class="fa fa-check"></i><b>11.4</b> Sampling distributions</a><ul>
<li class="chapter" data-level="11.4.1" data-path="inference.html"><a href="inference.html#sampling-distributions-for-proportions"><i class="fa fa-check"></i><b>11.4.1</b> Sampling distributions for proportions</a></li>
<li class="chapter" data-level="11.4.2" data-path="inference.html"><a href="inference.html#sampling-distributions-for-means"><i class="fa fa-check"></i><b>11.4.2</b> Sampling distributions for means</a></li>
<li class="chapter" data-level="11.4.3" data-path="inference.html"><a href="inference.html#summary-1"><i class="fa fa-check"></i><b>11.4.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="inference.html"><a href="inference.html#bootstrapping"><i class="fa fa-check"></i><b>11.5</b> Bootstrapping</a><ul>
<li class="chapter" data-level="11.5.1" data-path="inference.html"><a href="inference.html#overview-10"><i class="fa fa-check"></i><b>11.5.1</b> Overview</a></li>
<li class="chapter" data-level="11.5.2" data-path="inference.html"><a href="inference.html#bootstrapping-in-r"><i class="fa fa-check"></i><b>11.5.2</b> Bootstrapping in R</a></li>
<li class="chapter" data-level="11.5.3" data-path="inference.html"><a href="inference.html#using-the-bootstrap-to-calculate-a-plausible-range"><i class="fa fa-check"></i><b>11.5.3</b> Using the bootstrap to calculate a plausible range</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="inference.html"><a href="inference.html#additional-resources-5"><i class="fa fa-check"></i><b>11.6</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="move-to-your-own-machine.html"><a href="move-to-your-own-machine.html"><i class="fa fa-check"></i><b>12</b> Moving to your own machine</a><ul>
<li class="chapter" data-level="12.1" data-path="move-to-your-own-machine.html"><a href="move-to-your-own-machine.html#overview-11"><i class="fa fa-check"></i><b>12.1</b> Overview</a></li>
<li class="chapter" data-level="12.2" data-path="move-to-your-own-machine.html"><a href="move-to-your-own-machine.html#chapter-learning-objectives-11"><i class="fa fa-check"></i><b>12.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="12.3" data-path="move-to-your-own-machine.html"><a href="move-to-your-own-machine.html#installing-software-on-your-own-computer"><i class="fa fa-check"></i><b>12.3</b> Installing software on your own computer</a><ul>
<li class="chapter" data-level="12.3.1" data-path="move-to-your-own-machine.html"><a href="move-to-your-own-machine.html#git"><i class="fa fa-check"></i><b>12.3.1</b> Git</a></li>
<li class="chapter" data-level="12.3.2" data-path="move-to-your-own-machine.html"><a href="move-to-your-own-machine.html#miniconda"><i class="fa fa-check"></i><b>12.3.2</b> Miniconda</a></li>
<li class="chapter" data-level="12.3.3" data-path="move-to-your-own-machine.html"><a href="move-to-your-own-machine.html#jupyterlab"><i class="fa fa-check"></i><b>12.3.3</b> JupyterLab</a></li>
<li class="chapter" data-level="12.3.4" data-path="move-to-your-own-machine.html"><a href="move-to-your-own-machine.html#r-and-the-irkernel"><i class="fa fa-check"></i><b>12.3.4</b> R and the IRkernel</a></li>
<li class="chapter" data-level="12.3.5" data-path="move-to-your-own-machine.html"><a href="move-to-your-own-machine.html#r-packages"><i class="fa fa-check"></i><b>12.3.5</b> R packages</a></li>
<li class="chapter" data-level="12.3.6" data-path="move-to-your-own-machine.html"><a href="move-to-your-own-machine.html#latex"><i class="fa fa-check"></i><b>12.3.6</b> LaTeX</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="move-to-your-own-machine.html"><a href="move-to-your-own-machine.html#moving-files-to-your-computer"><i class="fa fa-check"></i><b>12.4</b> Moving files to your computer</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science: A First Introduction</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="reading" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Reading in data locally and from the web</h1>
<div id="overview" class="section level2">
<h2><span class="header-section-number">2.1</span> Overview</h2>
<p>In this chapter, you’ll learn to read spreadsheet-like data of various formats into R from your local device and the web. “Reading” (or “loading”) is the process of converting data (stored as plain text, a database, HTML, etc.) into an object (e.g., a data frame) that R can easily access and manipulate. Thus reading data is the gateway to any data analysis; you won’t be able to analyze data unless you’ve loaded it first. And because there are many ways to store data, there are similarly many ways to read data into R. The more time you spend upfront matching the data reading method to the type of data you have, the less time you will have to devote to re-formatting, cleaning and wrangling your data (the second step to all data analyses). It’s like making sure your shoelaces are tied well before going for a run so that you don’t trip later on!</p>
</div>
<div id="chapter-learning-objectives-1" class="section level2">
<h2><span class="header-section-number">2.2</span> Chapter learning objectives</h2>
<p>By the end of the chapter, students will be able to:</p>
<ul>
<li><p>define the following:</p>
<ul>
<li>absolute file path</li>
<li>relative file path</li>
<li>url</li>
</ul></li>
<li><p>read data into R using a relative path and a url</p></li>
<li><p>compare and contrast the following functions:</p>
<ul>
<li><code>read_csv</code></li>
<li><code>read_tsv</code></li>
<li><code>read_csv2</code></li>
<li><code>read_delim</code></li>
<li><code>read_excel</code></li>
</ul></li>
<li><p>match the following <code>tidyverse</code> <code>read_*</code> function arguments to their descriptions:</p>
<ul>
<li><code>file</code></li>
<li><code>delim</code></li>
<li><code>col_names</code></li>
<li><code>skip</code></li>
</ul></li>
<li><p>choose the appropriate <code>tidyverse</code> <code>read_*</code> function and function arguments to load a given plain text tabular data set into R</p></li>
<li><p>use <code>readxl</code> package’s <code>read_excel</code> function and arguments to load a sheet from an excel file into R</p></li>
<li><p>connect to a database using the <code>DBI</code> package’s <code>dbConnect</code> function</p></li>
<li><p>list the tables in a database using the <code>DBI</code> package’s <code>dbListTables</code> function</p></li>
<li><p>create a reference to a database table that is queriable using the <code>tbl</code> from the <code>dbplyr</code> package</p></li>
<li><p>retrieve data from a database query and bring it into R using the <code>collect</code> function from the <code>dbplyr</code> package</p></li>
<li><p>use <code>write_csv</code> to save a data frame to a <code>.csv</code> file</p></li>
<li><p>(<em>optional</em>) scrape data from the web</p>
<ul>
<li>read/scrape data from an internet URL using the rvest <code>html_nodes</code> and <code>html_text</code> functions</li>
<li>compare downloading tabular data from a plain text file (e.g. <code>.csv</code>) from the web versus scraping data from a <code>.html</code> file</li>
</ul></li>
</ul>
</div>
<div id="absolute-and-relative-file-paths" class="section level2">
<h2><span class="header-section-number">2.3</span> Absolute and relative file paths</h2>
<p>When you load a data set into R, you first need to tell R where those files live. The file could live on your
computer (<em>local</em>) or somewhere on the internet (<em>remote</em>). In this section, we will discuss the case where the file lives on your computer.</p>
<p>The place where the file lives on your computer is called the “path”. You can think of the path as directions to the file. There are two kinds of
paths: relative paths and absolute paths. A relative path is where the file is with respect to where you currently are on the computer (e.g., where the
Jupyter notebook file that you’re working in is). On the other hand, an absolute path is where the file is in respect to the base (or root) folder of
the computer’s filesystem.</p>
<p>Suppose our computer’s filesystem looks like the picture below, and we are working in the Jupyter notebook titled <code>worksheetk_02.ipynb</code>. If we want to
read in the <code>.csv</code> file named <code>happiness_report.csv</code> into our Jupyter notebook using R, we could do this using either a relative or an absolute path.
We show both choices below.</p>
<div class="figure"><span id="fig:file-system-for-export-to-intro-datascience"></span>
<img src="img/file-system-for-export-to-intro-datascience.svg" alt="Example file system" width="840" />
<p class="caption">
Figure 2.1: Example file system
</p>
</div>
<p><strong>Reading <code>happiness_report.csv</code> using a relative path:</strong></p>
<pre><code>happiness_data &lt;- read_csv(&quot;data/happiness_report.csv&quot;)</code></pre>
<p><strong>Reading <code>happiness_report.csv</code> using an absolute path:</strong></p>
<pre><code>happiness_data &lt;- read_csv(&quot;/home/jupyter/dsci-100/worksheet_02/data/happiness_report.csv&quot;)</code></pre>
<p>So which one should you use? Generally speaking, to ensure your code can be run
on a different computer, you should use relative paths. An added bonus is that
it’s also less typing! This is because the absolute path of a file (the names of
folders between the computer’s root <code>/</code> and the file) isn’t usually the same
across different computers. For example, suppose Fatima and Jayden are working on a
project together on the <code>happiness_report.csv</code> data. Fatima’s file is stored at</p>
<p><code>/home/Fatima/project/data/happiness_report.csv</code>,</p>
<p>while Jayden’s is stored at</p>
<p><code>/home/Jayden/project/data/happiness_report.csv</code>.</p>
<p>Even though Fatima and Jayden stored their files in the same place on their computers (in their home folders), the absolute paths are different due to their different usernames.
If Jayden has code that loads the <code>happiness_report.csv</code> data using an absolute path, the code won’t work on Fatima’s computer.
But the relative path from inside the <code>project</code> folder (<code>data/happiness_report.csv</code>) is the same on both computers; any code that uses relative paths will work on both!</p>
<!--Why would the absolute path not work on a different computer? The reason for this is that the names and the folder structure of the path between a computer's root 
folder (named `/`) and any files and folders you are usually working with will be different depending on who owns the computer (usually there is a different user name 
on each computer) and where the files and folders happen to be located on that particular computer. -->
<p>See this video for another explanation:</p>
<iframe width="840" height="473" src="https://www.youtube.com/embed/ephId3mYu9o" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<p><em>Source: <a href="https://www.udacity.com/course/linux-command-line-basics--ud595">Udacity course “Linux Command Line Basics”</a></em></p>
</div>
<div id="reading-tabular-data-from-a-plain-text-file-into-r" class="section level2">
<h2><span class="header-section-number">2.4</span> Reading tabular data from a plain text file into R</h2>
<p>Now we will learn more about reading tabular data from a plain text file into R, as well as how to write tabular data to a file.
Last chapter, we learned about using the <code>tidyverse</code> <code>read_csv</code> function when reading files that match that function’s expected defaults
(column names are present, and commas are used as the delimiter/separator between columns). In this section, we will learn how to read
files that do not satisfy the default expectations of <code>read_csv</code>.</p>
<p>Before we jump into the cases where the data aren’t in the expected default format for <code>tidyverse</code> and <code>read_csv</code>, let’s revisit the more straightforward
case where the defaults hold, and the only argument we need to give to the function is the path to the file, <code>data/can_lang.csv</code>. The <code>can_lang</code> data set contains language data from the 2016 Canadian census. We put <code>data/</code> before the file’s name when we are loading the data set because this data set is located in a sub-folder, named <code>data</code>, relative to where we are running our R code.</p>
<p>Here is what the file would look like in a plain text editor:</p>
<pre><code>category,language,mother_tongue,most_at_home,most_at_work,lang_known
Aboriginal languages,&quot;Aboriginal languages, n.o.s.&quot;,590,235,30,665
Non-Official &amp; Non-Aboriginal languages,Afrikaans,10260,4785,85,23415
Non-Official &amp; Non-Aboriginal languages,&quot;Afro-Asiatic languages, n.i.e.&quot;,1150,445,10,2775
Non-Official &amp; Non-Aboriginal languages,Akan (Twi),13460,5985,25,22150
Non-Official &amp; Non-Aboriginal languages,Albanian,26895,13135,345,31930
Aboriginal languages,&quot;Algonquian languages, n.i.e.&quot;,45,10,0,120
Aboriginal languages,Algonquin,1260,370,40,2480
Non-Official &amp; Non-Aboriginal languages,American Sign Language,2685,3020,1145,21930
Non-Official &amp; Non-Aboriginal languages,Amharic,22465,12785,200,33670</code></pre>
<p>And here is a review of how we can use <code>read_csv</code> to load it into R. First we
load the <code>tidyverse</code> package to gain access to useful functions for reading the
data.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="reading.html#cb34-1"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<blockquote>
<p>Note: it is normal and expected that a message is printed out after
loading the <code>tidyverse</code> and some packages. Generally, this message let’s you
know if functions from the different packages were loaded share the same name
(which is confusing to R), and if so, which one you can access using just it’s
name (and which one you need to refer the package name and the function name to
refer to it, this is called masking). Additionally, the <code>tidyverse</code> is a special
R package - it is a meta-package that bundles together several
related and commonly used packages. Because of this it lists the packages it
does the job of loading. In future when we load this package in this book we
will silence these messages to help with readability of the book.</p>
</blockquote>
<p>Next we use <code>read_csv</code> to load the data into R, and in that call we specify the
relative path to the file.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="reading.html#cb35-1"></a>canlang_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/can_lang.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   category = col_character(),
##   language = col_character(),
##   mother_tongue = col_double(),
##   most_at_home = col_double(),
##   most_at_work = col_double(),
##   lang_known = col_double()
## )</code></pre>
<blockquote>
<p>Note: it is also normal and expected that a message is printed out after using
the <code>read_csv</code> and related functions. This message functions to let you know the
data types of each of the columns that R inferred while reading the data into R.
In future when we use this and related functions to load data in this book we
will silence these messages to help with readability of the book.</p>
</blockquote>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="reading.html#cb37-1"></a>canlang_data</span></code></pre></div>
<pre><code>## # A tibble: 214 x 6
##    category                  language            mother_tongue most_at_home most_at_work lang_known
##    &lt;chr&gt;                     &lt;chr&gt;                       &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;
##  1 Aboriginal languages      Aboriginal languag…           590          235           30        665
##  2 Non-Official &amp; Non-Abori… Afrikaans                   10260         4785           85      23415
##  3 Non-Official &amp; Non-Abori… Afro-Asiatic langu…          1150          445           10       2775
##  4 Non-Official &amp; Non-Abori… Akan (Twi)                  13460         5985           25      22150
##  5 Non-Official &amp; Non-Abori… Albanian                    26895        13135          345      31930
##  6 Aboriginal languages      Algonquian languag…            45           10            0        120
##  7 Aboriginal languages      Algonquin                    1260          370           40       2480
##  8 Non-Official &amp; Non-Abori… American Sign Lang…          2685         3020         1145      21930
##  9 Non-Official &amp; Non-Abori… Amharic                     22465        12785          200      33670
## 10 Non-Official &amp; Non-Abori… Arabic                     419890       223535         5585     629055
## # … with 204 more rows</code></pre>
<div id="skipping-rows-when-reading-in-data" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Skipping rows when reading in data</h3>
<p>Often times information about how data was collected, or other relevant information, is included at the top of the data file. This information is usually written in sentence and paragraph form, with no delimiter because it is not organized into columns. An example of this is shown below. This
information gives the data scientist useful context and information about the data, however, it is not well formatted or intended to be read into
a data frame cell along with the tabular data that follows later in the file.</p>
<pre><code>Data source: https://ttimbers.github.io/canlang/
Data originally published in: Statistics Canada Census of Population 2016.
Reproduced and distributed on an as is basis with the permission of Statistics Canada.
category,language,mother_tongue,most_at_home,most_at_work,lang_known
Aboriginal languages,&quot;Aboriginal languages, n.o.s.&quot;,590,235,30,665
Non-Official &amp; Non-Aboriginal languages,Afrikaans,10260,4785,85,23415
Non-Official &amp; Non-Aboriginal languages,&quot;Afro-Asiatic languages, n.i.e.&quot;,1150,445,10,2775
Non-Official &amp; Non-Aboriginal languages,Akan (Twi),13460,5985,25,22150
Non-Official &amp; Non-Aboriginal languages,Albanian,26895,13135,345,31930
Aboriginal languages,&quot;Algonquian languages, n.i.e.&quot;,45,10,0,120
Aboriginal languages,Algonquin,1260,370,40,2480
Non-Official &amp; Non-Aboriginal languages,American Sign Language,2685,3020,1145,21930
Non-Official &amp; Non-Aboriginal languages,Amharic,22465,12785,200,33670</code></pre>
<p>With this extra information being present at the top of the file, using <code>read_csv</code> as we did previously does not allow us to correctly load the data into R. In the case of this file we end up only reading in one column of the data set:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="reading.html#cb40-1"></a>canlang_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/can_lang_meta-data.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: 215 parsing failures.
## row col  expected    actual                          file
##   3  -- 1 columns 6 columns &#39;data/can_lang_meta-data.csv&#39;
##   4  -- 1 columns 6 columns &#39;data/can_lang_meta-data.csv&#39;
##   5  -- 1 columns 6 columns &#39;data/can_lang_meta-data.csv&#39;
##   6  -- 1 columns 6 columns &#39;data/can_lang_meta-data.csv&#39;
##   7  -- 1 columns 6 columns &#39;data/can_lang_meta-data.csv&#39;
## ... ... ......... ......... .............................
## See problems(...) for more details.</code></pre>
<blockquote>
<p>Note: In contrast to the normal and expected messages above, this time R
printed out a warning for us indicating that there might be a problem with how
our data is being read in.</p>
</blockquote>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="reading.html#cb42-1"></a>canlang_data</span></code></pre></div>
<pre><code>## # A tibble: 217 x 1
##    `Data source: https://ttimbers.github.io/canlang/`                                    
##    &lt;chr&gt;                                                                                 
##  1 Data originally published in: Statistics Canada Census of Population 2016.            
##  2 Reproduced and distributed on an as is basis with the permission of Statistics Canada.
##  3 category                                                                              
##  4 Aboriginal languages                                                                  
##  5 Non-Official &amp; Non-Aboriginal languages                                               
##  6 Non-Official &amp; Non-Aboriginal languages                                               
##  7 Non-Official &amp; Non-Aboriginal languages                                               
##  8 Non-Official &amp; Non-Aboriginal languages                                               
##  9 Aboriginal languages                                                                  
## 10 Aboriginal languages                                                                  
## # … with 207 more rows</code></pre>
<p>To successfully read data like this into R, the <code>skip</code> argument can be useful to tell R how many lines to skip before it should start reading in the data. In the example above, we would set this value to 3:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="reading.html#cb44-1"></a>canlang_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/can_lang_meta-data.csv&quot;</span>, <span class="dt">skip =</span> <span class="dv">3</span>)</span>
<span id="cb44-2"><a href="reading.html#cb44-2"></a>canlang_data</span></code></pre></div>
<pre><code>## # A tibble: 214 x 6
##    category                  language            mother_tongue most_at_home most_at_work lang_known
##    &lt;chr&gt;                     &lt;chr&gt;                       &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;
##  1 Aboriginal languages      Aboriginal languag…           590          235           30        665
##  2 Non-Official &amp; Non-Abori… Afrikaans                   10260         4785           85      23415
##  3 Non-Official &amp; Non-Abori… Afro-Asiatic langu…          1150          445           10       2775
##  4 Non-Official &amp; Non-Abori… Akan (Twi)                  13460         5985           25      22150
##  5 Non-Official &amp; Non-Abori… Albanian                    26895        13135          345      31930
##  6 Aboriginal languages      Algonquian languag…            45           10            0        120
##  7 Aboriginal languages      Algonquin                    1260          370           40       2480
##  8 Non-Official &amp; Non-Abori… American Sign Lang…          2685         3020         1145      21930
##  9 Non-Official &amp; Non-Abori… Amharic                     22465        12785          200      33670
## 10 Non-Official &amp; Non-Abori… Arabic                     419890       223535         5585     629055
## # … with 204 more rows</code></pre>
</div>
<div id="read_delim-as-a-more-flexible-method-to-get-tabular-data-into-r" class="section level3">
<h3><span class="header-section-number">2.4.2</span> <code>read_delim</code> as a more flexible method to get tabular data into R</h3>
<p>When our tabular data comes in a different format, we can use the <code>read_delim</code> function instead. For example, a different version of this same data set has no column names and uses tabs as the delimiter instead of commas.</p>
<p>Here is how the file would look in a plain text editor:</p>
<pre><code>Aboriginal languages    Aboriginal languages, n.o.s.    590 235 30  665
Non-Official &amp; Non-Aboriginal languages Afrikaans   10260   4785    85  23415
Non-Official &amp; Non-Aboriginal languages Afro-Asiatic languages, n.i.e.  1150    445 10  2775
Non-Official &amp; Non-Aboriginal languages Akan (Twi)  13460   5985    25  22150
Non-Official &amp; Non-Aboriginal languages Albanian    26895   13135   345 31930
Aboriginal languages    Algonquian languages, n.i.e.    45  10  0   120
Aboriginal languages    Algonquin   1260    370 40  2480
Non-Official &amp; Non-Aboriginal languages American Sign Language  2685    3020    1145    21930
Non-Official &amp; Non-Aboriginal languages Amharic 22465   12785   200 33670
Non-Official &amp; Non-Aboriginal languages Arabic  419890  223535  5585    629055</code></pre>
<p>To get this into R using the <code>read_delim()</code> function, we specify the first argument as the path to the file (as done with <code>read_csv</code>), and then provide values to the <code>delim</code> argument (here a tab, which we represent by <code>"\t"</code>) and the <code>col_names</code> argument (here we specify that there are no column names to assign, and give it the value of <code>FALSE</code>). Both <code>read_csv()</code> and <code>read_delim()</code> have a <code>col_names</code> argument and the default is <code>TRUE</code>.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="reading.html#cb47-1"></a>canlang_data &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;data/can_lang.tsv&quot;</span>, <span class="dt">delim =</span> <span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>, <span class="dt">col_names =</span> <span class="ot">FALSE</span>)</span>
<span id="cb47-2"><a href="reading.html#cb47-2"></a>canlang_data</span></code></pre></div>
<pre><code>## # A tibble: 214 x 6
##    X1                                      X2                                X3     X4    X5     X6
##    &lt;chr&gt;                                   &lt;chr&gt;                          &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
##  1 Aboriginal languages                    Aboriginal languages, n.o.s.     590    235    30    665
##  2 Non-Official &amp; Non-Aboriginal languages Afrikaans                      10260   4785    85  23415
##  3 Non-Official &amp; Non-Aboriginal languages Afro-Asiatic languages, n.i.…   1150    445    10   2775
##  4 Non-Official &amp; Non-Aboriginal languages Akan (Twi)                     13460   5985    25  22150
##  5 Non-Official &amp; Non-Aboriginal languages Albanian                       26895  13135   345  31930
##  6 Aboriginal languages                    Algonquian languages, n.i.e.      45     10     0    120
##  7 Aboriginal languages                    Algonquin                       1260    370    40   2480
##  8 Non-Official &amp; Non-Aboriginal languages American Sign Language          2685   3020  1145  21930
##  9 Non-Official &amp; Non-Aboriginal languages Amharic                        22465  12785   200  33670
## 10 Non-Official &amp; Non-Aboriginal languages Arabic                        419890 223535  5585 629055
## # … with 204 more rows</code></pre>
<p>Data frames in R need to have column names, thus if you read data into R as a data frame without column names then R assigns column names for them. If you used the <code>read_*</code> functions to read the data into R, then R gives each column a name of X1, X2, …, XN, where N is the number of columns in the data set.</p>
</div>
<div id="reading-tabular-data-directly-from-a-url" class="section level3">
<h3><span class="header-section-number">2.4.3</span> Reading tabular data directly from a URL</h3>
<p>We can also use <code>read_csv()</code> or <code>read_delim()</code> (and related functions) to read in tabular data directly from a url that contains tabular data. In this case, we provide the url to <code>read_csv()</code> as the path to the file instead of a path to a local file on our computer. Similar to when we specify a path on our local computer, here we need to surround the url by quotes. All other arguments that we use are the same as when using these functions with a local file on our computer.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="reading.html#cb49-1"></a>canlang_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/UBC-DSCI/introduction-to-datascience/master/data/can_lang.csv&quot;</span>)</span>
<span id="cb49-2"><a href="reading.html#cb49-2"></a>canlang_data</span></code></pre></div>
<pre><code>## # A tibble: 214 x 6
##    category                  language            mother_tongue most_at_home most_at_work lang_known
##    &lt;chr&gt;                     &lt;chr&gt;                       &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;
##  1 Aboriginal languages      Aboriginal languag…           590          235           30        665
##  2 Non-Official &amp; Non-Abori… Afrikaans                   10260         4785           85      23415
##  3 Non-Official &amp; Non-Abori… Afro-Asiatic langu…          1150          445           10       2775
##  4 Non-Official &amp; Non-Abori… Akan (Twi)                  13460         5985           25      22150
##  5 Non-Official &amp; Non-Abori… Albanian                    26895        13135          345      31930
##  6 Aboriginal languages      Algonquian languag…            45           10            0        120
##  7 Aboriginal languages      Algonquin                    1260          370           40       2480
##  8 Non-Official &amp; Non-Abori… American Sign Lang…          2685         3020         1145      21930
##  9 Non-Official &amp; Non-Abori… Amharic                     22465        12785          200      33670
## 10 Non-Official &amp; Non-Abori… Arabic                     419890       223535         5585     629055
## # … with 204 more rows</code></pre>
</div>
<div id="previewing-a-data-file-before-reading-it-into-r" class="section level3">
<h3><span class="header-section-number">2.4.4</span> Previewing a data file before reading it into R</h3>
<p>In all the examples above, we gave you previews of the data file before we read it into R. This is essential so that you can see whether or not there are column names, what the
delimiters are, and if there are lines you need to skip. You should do this yourself when trying to read in data files. In Jupyter, you preview data as a plain text file by right-clicking
on the file’s name in the Jupyter home menu and selecting “Open with” and then selecting “Editor”.</p>
<div class="figure"><span id="fig:open-data-w-editor-01"></span>
<img src="_main_files/figure-html/open-data-w-editor-01-1.png" alt="Opening data files with an editor in Jupyter" width="100%" />
<p class="caption">
Figure 2.2: Opening data files with an editor in Jupyter
</p>
</div>
<div class="figure"><span id="fig:open-data-w-editor-02"></span>
<img src="_main_files/figure-html/open-data-w-editor-02-1.png" alt="A data file as viewed in an editor in Jupyter" width="100%" />
<p class="caption">
Figure 2.3: A data file as viewed in an editor in Jupyter
</p>
</div>
<p>If you do not specify to open the data file with an editor, then Jupyter will
render a nice table for you and you will not be able to see the column
delimiters, and therefore you will not know which function to use, nor
which arguments to use and values to specify for them.</p>
<p>This is also demonstrated in the video below:</p>
<iframe width="840" height="473" src="https://www.youtube.com/embed/6orO4YMAyeQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</div>
</div>
<div id="reading-data-from-an-microsoft-excel-file" class="section level2">
<h2><span class="header-section-number">2.5</span> Reading data from an Microsoft Excel file</h2>
<p>There are many other ways to store tabular data sets beyond plain text files, and similarly, many ways to load those data sets into R. For example, it is very common to encounter,
and need to load into R, data stored as a Microsoft Excel spreadsheet (with the filename extension <code>.xlsx</code>).
To be able to do this, a key thing to know is that even though <code>.csv</code> and <code>.xlsx</code> files look almost
identical when loaded into Excel, the data themselves are stored completely differently.
While <code>.csv</code> files are plain text files, where the characters you see when you open the file in a text editor are exactly the data they represent,
this is not the case for <code>.xlsx</code> files. Take a look at what a <code>.xlsx</code> file would look like in a text editor:</p>
<pre><code>,?&#39;O
    _rels/.rels???J1??&gt;E?{7?
&lt;?V????w8?&#39;J???&#39;QrJ???Tf?d??d?o?wZ&#39;???@&gt;?4&#39;?|??hlIo??F
t                                                       8f??3wn
????t??u&quot;/
          %~Ed2??&lt;?w??
                       ?Pd(??J-?E???7?&#39;t(?-GZ?????y???c~N?g[^_r?4
                                                                  yG?O
                                                                      ?K??G?RPX?&lt;??,?&#39;O[Content_Types].xml???n?0E%?J
                                                                                                                    ]TUEe??O??c[???????6q??s??d?m???\???H?^????3} ?rZY? ?:L60?^?????XTP+?|?3???&quot;~?3T1W3???,?#p?R?!??w(??R???[S?D?kP?P!XS(?i?t?$?ei
X?a??4VT?,D?Jq
                D
                 ?????u?]??;??L?.8AhfNv}?hHF*??Jr?Q?%?g?U??CtX&quot;8x&gt;?.|????5j?/$???JE?c??~??4iw?????E;?+?S??w?cV+?:???2l???=?2nel???;|?V??????c&#39;?????9?P&amp;Bcj,?&#39;OdocProps/app.xml??1
                                                     ?0???k????A?u?U?]??{#?:;/&lt;?g?Cd????M+?=???Z?O??R+??u?P?X KV@??M$??a???d?_???4??5v?R????9D????t??Fk?Ú&#39;P?=?,?&#39;OdocProps/core.xml??MO?0
                                                             ??J?{???3j?h&#39;??(q??U4J
                                                                                   ??=i?I&#39;?b??[v?!??{gk?
                                                                                                         F2????v5yj??&quot;J???,?d???J???C??l??4?-?`$?4t?K?.;?%c?J??G&lt;?H????
                                                  X????z???6?????~q??X??????q^&gt;??tH???*?D???M?g
??D?????????d?:g).?3.??j?P?F?&#39;Oxl/_rels/workbook.xml.rels??Ak1??J?{7???R?^J?kk@Hf7??I?L???E]A?Þ?{a??`f?????b?6xUQ?@o?m}??o????X{???Q?????;?y?\?
                        O
?YY??4?L??S??k?252j??
??V ?C?g?C]???????
?
???E??TENyf6%
             ?Y????|??:%???}^ N?Q?N&#39;????)??F?\??P?G??,?&#39;O&#39;xl/printerSettings/printerSettings1.bin?Wmn? 
                                                                                                        ??Sp&gt;?G???q?#
                                                                                                                     ?I??5R&#39;???q????(?L
??m??8F?5&lt;  L`??`?A??2{dp??9R#?&gt;7??Xu???/?X??HI?|?
                                                          ??r)???\?VA8?2dFfq???I]]o
5`????6A ?</code></pre>
<p>This type of file representation allows Excel files to store additional things that you cannot store in a <code>.csv</code> file, such as fonts, text formatting, graphics, multiple sheets
and more. And despite looking odd in a plain text editor, we can read Excel spreadsheets into R using the <code>readxl</code> package developed
specifically for this purpose.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="reading.html#cb52-1"></a><span class="kw">library</span>(readxl)</span>
<span id="cb52-2"><a href="reading.html#cb52-2"></a>canlang_data &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;data/can_lang.xlsx&quot;</span>)</span>
<span id="cb52-3"><a href="reading.html#cb52-3"></a>canlang_data</span></code></pre></div>
<pre><code>## # A tibble: 214 x 6
##    category                  language            mother_tongue most_at_home most_at_work lang_known
##    &lt;chr&gt;                     &lt;chr&gt;                       &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;
##  1 Aboriginal languages      Aboriginal languag…           590          235           30        665
##  2 Non-Official &amp; Non-Abori… Afrikaans                   10260         4785           85      23415
##  3 Non-Official &amp; Non-Abori… Afro-Asiatic langu…          1150          445           10       2775
##  4 Non-Official &amp; Non-Abori… Akan (Twi)                  13460         5985           25      22150
##  5 Non-Official &amp; Non-Abori… Albanian                    26895        13135          345      31930
##  6 Aboriginal languages      Algonquian languag…            45           10            0        120
##  7 Aboriginal languages      Algonquin                    1260          370           40       2480
##  8 Non-Official &amp; Non-Abori… American Sign Lang…          2685         3020         1145      21930
##  9 Non-Official &amp; Non-Abori… Amharic                     22465        12785          200      33670
## 10 Non-Official &amp; Non-Abori… Arabic                     419890       223535         5585     629055
## # … with 204 more rows</code></pre>
<p>If the <code>.xlsx</code> file has multiple sheets, you have to use the <code>sheet</code> argument to specify the sheet number or name. You can also specify cell ranges using the <code>range</code> argument. This functionality is useful when a single sheet contains multiple tables (a sad thing that happens to many Excel spreadsheets).</p>
<p>As with plain text files, you should always explore the data file before importing it into R. Exploring the data beforehand helps you decide which arguments you need to to load the data into R successfully. If you do not have the Excel program on your computer, you can use other programs to preview the file. Examples include Google Sheets and Libre Office.</p>
</div>
<div id="reading-data-from-a-database" class="section level2">
<h2><span class="header-section-number">2.6</span> Reading data from a database</h2>
<p>Another very common form of data storage is the relational database. There are many relational database management systems, such as
<a href="https://www.sqlite.org/index.html">SQLite</a>, <a href="https://www.mysql.com/">MySQL</a>, <a href="https://www.postgresql.org/">PostgreSQL</a>, <a href="https://www.oracle.com/ca-en/index.html">Oracle</a>, and many more. These different relational database management systems each have their own advantages and limitations. Almost all employ SQL (<em>structured query language</em>) to pull data from the database. Thankfully, you don’t need to know SQL
to analyze data from a database;
several packages have been written
that allows R to connect to relational databases and use the R programming language as the front end (what the user types in) to pull data from them. These different relational database management systems have their own advantages, limitations, and excels in particular scenarios. In this book, we will
give examples of how to do this using R with SQLite and PostgreSQL databases.</p>
<div id="connecting-to-a-database" class="section level3">
<h3><span class="header-section-number">2.6.1</span> Connecting to a database</h3>
<div id="reading-data-from-a-sqlite-database" class="section level4">
<h4><span class="header-section-number">2.6.1.1</span> Reading data from a SQLite database</h4>
<p>SQLite is probably the simplest relational database that one can use in combination with R. SQLite databases are self-contained and usually stored and accessed locally on one computer. Data is usually stored in a file with a <code>.db</code> extension. Similar to Excel files, these are not plain text files and cannot be read in a plain text editor.</p>
<p>The first thing you need to do to read data into R from a database is to connect to the database. We do that using the <code>dbConnect</code> function from the <code>DBI</code> (database interface) package. This does not read in the data, but simply tells R where the database is and opens up a communication channel.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="reading.html#cb54-1"></a><span class="kw">library</span>(DBI)</span>
<span id="cb54-2"><a href="reading.html#cb54-2"></a>con_lang_data &lt;-<span class="st"> </span><span class="kw">dbConnect</span>(RSQLite<span class="op">::</span><span class="kw">SQLite</span>(), <span class="st">&quot;data/can_lang.db&quot;</span>)</span></code></pre></div>
<p>Often relational databases have many tables, and their power comes from the useful ways they can be joined. Thus anytime you want to access data from a relational database, you need to know the table names. You can get the names of all the tables in the database using the <code>dbListTables</code> function:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="reading.html#cb55-1"></a>tables &lt;-<span class="st"> </span><span class="kw">dbListTables</span>(con_lang_data)</span>
<span id="cb55-2"><a href="reading.html#cb55-2"></a>tables</span></code></pre></div>
<pre><code>## [1] &quot;lang&quot;</code></pre>
<p>We only get one table name returned from calling <code>dbListTables</code>, which tells us that there is only one table in this database. To reference a table in the database to do things like select columns and filter rows, we use the <code>tbl</code> function from the <code>dbplyr</code> package. The package <code>dbplyr</code> allows us to work with data stored in databases as if they were local data frames, which is useful because we can do a lot with big datasets without actually having to bring these vast amounts of data into your computer!</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="reading.html#cb57-1"></a><span class="kw">library</span>(dbplyr)</span>
<span id="cb57-2"><a href="reading.html#cb57-2"></a>lang_db &lt;-<span class="st"> </span><span class="kw">tbl</span>(con_lang_data, <span class="st">&quot;lang&quot;</span>)</span>
<span id="cb57-3"><a href="reading.html#cb57-3"></a>lang_db</span></code></pre></div>
<pre><code>## # Source:   table&lt;lang&gt; [?? x 6]
## # Database: sqlite 3.30.1 [/home/rstudio/introduction-to-datascience/data/can_lang.db]
##    category                  language            mother_tongue most_at_home most_at_work lang_known
##    &lt;chr&gt;                     &lt;chr&gt;                       &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;
##  1 Aboriginal languages      Aboriginal languag…           590          235           30        665
##  2 Non-Official &amp; Non-Abori… Afrikaans                   10260         4785           85      23415
##  3 Non-Official &amp; Non-Abori… Afro-Asiatic langu…          1150          445           10       2775
##  4 Non-Official &amp; Non-Abori… Akan (Twi)                  13460         5985           25      22150
##  5 Non-Official &amp; Non-Abori… Albanian                    26895        13135          345      31930
##  6 Aboriginal languages      Algonquian languag…            45           10            0        120
##  7 Aboriginal languages      Algonquin                    1260          370           40       2480
##  8 Non-Official &amp; Non-Abori… American Sign Lang…          2685         3020         1145      21930
##  9 Non-Official &amp; Non-Abori… Amharic                     22465        12785          200      33670
## 10 Non-Official &amp; Non-Abori… Arabic                     419890       223535         5585     629055
## # … with more rows</code></pre>
<p>Although it looks like we just got a data frame from the database, we didn’t! It’s a <em>reference</em>, showing us data that is still in the SQLite database (note the first two lines of the output).
It does this because databases are often more efficient at selecting, filtering and joining large data sets than R. And typically, the database will not even be
stored on your computer, but rather a more powerful machine somewhere on the web. So R is lazy and waits to bring this data into memory until you explicitly tell
it to do so using the <code>collect</code> function from the <code>dbplyr</code> package.</p>
<p>Here we will filter for only rows in the Aboriginal languages category according to the 2016 Canada Census, and then use <code>collect</code> to finally bring this data into R as a data frame.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="reading.html#cb59-1"></a>aboriginal_lang_db &lt;-<span class="st"> </span><span class="kw">filter</span>(lang_db, category <span class="op">==</span><span class="st"> &quot;Aboriginal languages&quot;</span>)</span>
<span id="cb59-2"><a href="reading.html#cb59-2"></a>aboriginal_lang_db</span></code></pre></div>
<pre><code>## # Source:   lazy query [?? x 6]
## # Database: sqlite 3.30.1 [/home/rstudio/introduction-to-datascience/data/can_lang.db]
##    category            language                  mother_tongue most_at_home most_at_work lang_known
##    &lt;chr&gt;               &lt;chr&gt;                             &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;
##  1 Aboriginal languag… Aboriginal languages, n.…           590          235           30        665
##  2 Aboriginal languag… Algonquian languages, n.…            45           10            0        120
##  3 Aboriginal languag… Algonquin                          1260          370           40       2480
##  4 Aboriginal languag… Athabaskan languages, n.…            50           10            0         85
##  5 Aboriginal languag… Atikamekw                          6150         5465         1100       6645
##  6 Aboriginal languag… Babine (Wetsuwet&#39;en)                110           20           10        210
##  7 Aboriginal languag… Beaver                              190           50            0        340
##  8 Aboriginal languag… Blackfoot                          2815         1110           85       5645
##  9 Aboriginal languag… Carrier                            1025          250           15       2100
## 10 Aboriginal languag… Cayuga                               45           10           10        125
## # … with more rows</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="reading.html#cb61-1"></a>aboriginal_lang_data &lt;-<span class="st"> </span><span class="kw">collect</span>(aboriginal_lang_db)</span>
<span id="cb61-2"><a href="reading.html#cb61-2"></a>aboriginal_lang_data</span></code></pre></div>
<pre><code>## # A tibble: 67 x 6
##    category            language                  mother_tongue most_at_home most_at_work lang_known
##    &lt;chr&gt;               &lt;chr&gt;                             &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;
##  1 Aboriginal languag… Aboriginal languages, n.…           590          235           30        665
##  2 Aboriginal languag… Algonquian languages, n.…            45           10            0        120
##  3 Aboriginal languag… Algonquin                          1260          370           40       2480
##  4 Aboriginal languag… Athabaskan languages, n.…            50           10            0         85
##  5 Aboriginal languag… Atikamekw                          6150         5465         1100       6645
##  6 Aboriginal languag… Babine (Wetsuwet&#39;en)                110           20           10        210
##  7 Aboriginal languag… Beaver                              190           50            0        340
##  8 Aboriginal languag… Blackfoot                          2815         1110           85       5645
##  9 Aboriginal languag… Carrier                            1025          250           15       2100
## 10 Aboriginal languag… Cayuga                               45           10           10        125
## # … with 57 more rows</code></pre>
<p>Why bother to use the <code>collect</code> function? The data looks pretty similar in both outputs shown above. And <code>dbplyr</code> provides lots of functions similar to <code>filter</code> that
you can use to directly feed the database reference (what <code>tbl</code> gives you) into downstream analysis functions (e.g., <code>ggplot2</code> for data visualization and <code>lm</code> for
linear regression modeling). However, this does not
work in <em>every</em> case; look what happens when we try to use <code>nrow</code> to count rows in a data frame:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="reading.html#cb63-1"></a><span class="kw">nrow</span>(aboriginal_lang_db)</span></code></pre></div>
<pre><code>## [1] NA</code></pre>
<p>or <code>tail</code> to preview the last 6 rows of a data frame:</p>
<pre><code>tail(aboriginal_lang_db)</code></pre>
<pre><code>## Error: tail() is not supported by sql sources</code></pre>
<p>Additionally, some operations will not work to extract columns or single values from the reference given by the <code>tbl</code> function. Thus, once you have finished your data wrangling of the <code>tbl</code> database reference object, it is advisable to bring it into your local machine’s memory using <code>collect</code> as a data frame.</p>
<blockquote>
<p>Warning: Usually, databases are very big! Reading the object into your local machine may give an error or take a lot of time to run so be careful if you plan to do this!</p>
</blockquote>
</div>
<div id="reading-data-from-a-postgresql-database" class="section level4">
<h4><span class="header-section-number">2.6.1.2</span> Reading data from a PostgreSQL database</h4>
<p>PostgreSQL (also called Postgres) is a very popular and open-source option for relational database software. Unlike SQLite, PostgreSQL uses
a client–server database engine, as it was designed to be used and accessed on a network. This means that you have to provide more
information to R when connecting to Postgres databases. The additional information that you need to include when you call the <code>dbConnect</code>
function is listed below:</p>
<ul>
<li><code>dbname</code> - the name of the database (a single PostgreSQL instance can host more than one database)</li>
<li><code>host</code> - the URL pointing to where the database is located</li>
<li><code>port</code> - the communication endpoint between R and the PostgreSQL database (this is typically 5432 for PostgreSQL)</li>
<li><code>user</code> - the username for accessing the database</li>
<li><code>password</code> - the password for accessing the database</li>
</ul>
<p>Additionally, we must use the <code>RPostgres</code> package instead of <code>RSQLite</code> in the <code>dbConnect</code> function call.
Below we demonstrate how to connect to a version of the <code>can_mov_db</code> database, which contains information about Canadian movies (<em>note - this is a synthetic, or artificial, database</em>).</p>
<pre><code>library(RPostgres)
can_mov_db_con &lt;- dbConnect(RPostgres::Postgres(), dbname = &quot;can_mov_db&quot;,
                        host = &quot;r7k3-mds1.stat.ubc.ca&quot;, port = 5432,
                        user = &quot;user0001&quot;, password = &#39;################&#39;)</code></pre>
</div>
</div>
<div id="interacting-with-a-database" class="section level3">
<h3><span class="header-section-number">2.6.2</span> Interacting with a database</h3>
<p>After opening the connection, everything looks and behaves almost identically to when we were using an SQLite database in R. For example, we can again
use <code>dbListTables</code> to find out what tables are in the <code>can_mov_db</code> database:</p>
<pre><code>dbListTables(can_mov_db_con)</code></pre>
<pre><code> [1] &quot;themes&quot;            &quot;medium&quot;           &quot;titles&quot;     &quot;title_aliases&quot;       &quot;forms&quot;            
 [6] &quot;episodes&quot;          &quot;names&quot;      &quot;names_occupations&quot; &quot;occupation&quot;       &quot;ratings&quot; </code></pre>
<p>We see that there are 10 tables in this database. Let’s first look at the <code>"ratings"</code> table to find the lowest rating that exists in the <code>can_mov_db</code> database:</p>
<pre><code>ratings_db &lt;- tbl(can_mov_db_con, &quot;ratings&quot;)
ratings_db</code></pre>
<pre><code># Source:   table&lt;ratings&gt; [?? x 3]
# Database: postgres [user0001@r7k3-mds1.stat.ubc.ca:5432/can_mov_db]
   title              average_rating num_votes
   &lt;chr&gt;                    &lt;dbl&gt;     &lt;int&gt;
 1 The Grand Seduction       6.6       150
 2 Rhymes for Young Ghouls   6.3      1685
 3 Mommy                     7.5      1060
 4 Incendies                 6.1      1101
 5 Bon Cop, Bad Cop          7.0       894
 6 Goon                      5.5      1111
 7 Monsieur Lazhar           5.6       610
 8 What if                   5.3      1401
 9 The Barbarian Invations   5.8        99
10 Away from Her             6.9      2311
# … with more rows</code></pre>
<p>To find the lowest rating that exists in the data base, we first need to extract the <code>average_rating</code> column using <code>select</code>:</p>
<pre><code>avg_rating_db &lt;- select(ratings_db, average_rating)
avg_rating_db</code></pre>
<pre><code># Source:   lazy query [?? x 1]
# Database: postgres [user0001@r7k3-mds1.stat.ubc.ca:5432/can_mov_db]
   average_rating
            &lt;dbl&gt;
 1            6.6
 2            6.3
 3            7.5
 4            6.1
 5            7.0
 6            5.5
 7            5.6
 8            5.3
 9            5.8
10            6.9
# … with more rows</code></pre>
<p>Next we use <code>min</code> to find the minimum rating in that column:</p>
<pre><code>min(avg_rating_db)</code></pre>
<pre><code>Error in min(avg_rating_db) : invalid &#39;type&#39; (list) of argument</code></pre>
<p>Instead of the minimum, we get an error! This is another example of when we need to use the <code>collect</code> function to bring the data into R for further computation:</p>
<pre><code>avg_rating_data &lt;- collect(avg_rating_db)
min(avg_rating_data)</code></pre>
<pre><code>[1] 1</code></pre>
<p>We see the lowest rating given to a movie is 1, indicating that it must have been a really bad movie…</p>
<p><strong>Why should we bother with databases at all?</strong></p>
<p>Opening a database stored in a <code>.db</code> file involved a lot more effort than just opening a <code>.csv</code>, <code>.tsv</code>, or any of the other plain text or Excel formats. It was a bit of a pain to use a database in that setting since we had to use <code>dbplyr</code> to translate <code>tidyverse</code>-like commands (<code>filter</code>, <code>select</code>, <code>head</code>, etc.) into SQL commands that the database understands. Not all <code>tidyverse</code> commands can currently be translated with SQLite databases. For example, we can compute a mean with an SQLite database but can’t easily compute a median. So you might be wondering why should we use databases at all?</p>
<p>Databases are beneficial in a large-scale setting:</p>
<ul>
<li>they enable storing large data sets across multiple computers with automatic redundancy and backups</li>
<li>they allow multiple users to access them simultaneously and remotely without conflicts and errors</li>
<li>they provide mechanisms for ensuring data integrity and validating input</li>
<li>they provide security to keep data safe
For example, <a href="https://www.internetlivestats.com/google-search-statistics/">there are billions of Google searches conducted daily</a>. Can you imagine if Google stored all of the data from those queries in a single <code>.csv file</code>!? Chaos would ensue!</li>
</ul>
</div>
</div>
<div id="writing-data-from-r-to-a-.csv-file" class="section level2">
<h2><span class="header-section-number">2.7</span> Writing data from R to a <code>.csv</code> file</h2>
<p>At the middle and end of a data analysis, we often want to write a data frame that has changed (either through filtering, selecting, mutating or summarizing) to a file
to share it with others or use it for another step in the analysis. The most straightforward way to do this is to use the <code>write_csv</code> function from the <code>tidyverse</code> package.
The default arguments for this file are to use a comma (<code>,</code>) as the delimiter and include column names. Below we demonstrate creating a new version of the Canadian languages data set without the official languages category according to the Canadian 2016 Census, and then writing this to a <code>.csv</code> file:</p>
<pre><code>no_official_lang_data &lt;- filter(can_lang, category != &quot;Official languages&quot;)
write_csv(no_official_lang_data, &quot;data/no_official_languages.csv&quot;)</code></pre>
</div>
<div id="scraping-data-off-the-web-using-r" class="section level2">
<h2><span class="header-section-number">2.8</span> Scraping data off the web using R</h2>
<p>In the first part of this chapter, we learned how to read in data from plain text files that are usually “rectangular” in shape using the <code>tidyverse</code> <code>read_*</code> functions. Sadly, not all data comes in this simple format, but we can happily use many other tools to read in more messy/wild data formats. One common place people often want/need to read in data from is websites. Such data exists in a non-rectangular format. One quick and easy solution to get this data is to copy and paste it. However, this becomes painstakingly long and boring when there is a lot of data that needs gathering. And any time you start doing a lot of copying and pasting, you will likely introduce errors.</p>
<p>The formal name for gathering non-rectangular data from the web and transforming it into a more useful format for data analysis is <strong>web scraping</strong>. There are two different ways to do web scraping: 1) screen scraping (similar to copying and pasting from a website, but done in a programmatic way to minimize errors and maximize efficiency) and 2) web APIs (<strong>a</strong>pplication <strong>p</strong>rogramming <strong>i</strong>nterface) (a website that provides a programatic way of returning the data as JSON or XML files via http requests). In this course, we will explore the first method, screen scraping using R’s <a href="https://github.com/hadley/rvest"><code>rvest</code> package</a>.</p>
<div id="html-and-css-selectors" class="section level3">
<h3><span class="header-section-number">2.8.1</span> HTML and CSS selectors</h3>
<p>Before we jump into scraping, let’s set up some motivation and learn a little bit about what the “source code” of a website looks like. Say we are interested in knowing the average rental price (per square footage) of the most recently available one-bedroom apartments in Vancouver from <a href="https://vancouver.craigslist.org" class="uri">https://vancouver.craigslist.org</a>. When we visit the Vancouver Craigslist website and search for one-bedroom apartments, this is what we are shown:</p>
<p><img src="img/craigslist_human.png" /></p>
<p>From that page, it’s pretty easy for our human eyes to find the apartment price and square footage. But how can we do this programmatically, so we don’t have to copy and paste all these numbers? Well, we have to deal with the webpage source code, which we show a snippet of below (and link to the <a href="img/website_source.txt">entire source code here</a>):</p>
<pre><code>        &lt;span class=&quot;result-meta&quot;&gt;
                &lt;span class=&quot;result-price&quot;&gt;$800&lt;/span&gt;

                &lt;span class=&quot;housing&quot;&gt;
                    1br -
                &lt;/span&gt;

                &lt;span class=&quot;result-hood&quot;&gt; (13768 108th Avenue)&lt;/span&gt;

                &lt;span class=&quot;result-tags&quot;&gt;
                    &lt;span class=&quot;maptag&quot; data-pid=&quot;6786042973&quot;&gt;map&lt;/span&gt;
                &lt;/span&gt;

                &lt;span class=&quot;banish icon icon-trash&quot; role=&quot;button&quot;&gt;
                    &lt;span class=&quot;screen-reader-text&quot;&gt;hide this posting&lt;/span&gt;
                &lt;/span&gt;

            &lt;span class=&quot;unbanish icon icon-trash red&quot; role=&quot;button&quot; aria-hidden=&quot;true&quot;&gt;&lt;/span&gt;
            &lt;a href=&quot;#&quot; class=&quot;restore-link&quot;&gt;
                &lt;span class=&quot;restore-narrow-text&quot;&gt;restore&lt;/span&gt;
                &lt;span class=&quot;restore-wide-text&quot;&gt;restore this posting&lt;/span&gt;
            &lt;/a&gt;

        &lt;/span&gt;
    &lt;/p&gt;
&lt;/li&gt;
         &lt;li class=&quot;result-row&quot; data-pid=&quot;6788463837&quot;&gt;

        &lt;a href=&quot;https://vancouver.craigslist.org/nvn/apa/d/north-vancouver-luxury-1-bedroom/6788463837.html&quot; class=&quot;result-image gallery&quot; data-ids=&quot;1:00U0U_lLWbuS4jBYN,1:00T0T_9JYt6togdOB,1:00r0r_hlMkwxKqoeq,1:00n0n_2U8StpqVRYX,1:00M0M_e93iEG4BRAu,1:00a0a_PaOxz3JIfI,1:00o0o_4VznEcB0NC5,1:00V0V_1xyllKkwa9A,1:00G0G_lufKMygCGj6,1:00202_lutoxKbVTcP,1:00R0R_cQFYHDzGrOK,1:00000_hTXSBn1SrQN,1:00r0r_2toXdps0bT1,1:01616_dbAnv07FaE7,1:00g0g_1yOIckt0O1h,1:00m0m_a9fAvCYmO9L,1:00C0C_8EO8Yl1ELUi,1:00I0I_iL6IqV8n5MB,1:00b0b_c5e1FbpbWUZ,1:01717_6lFcmuJ2glV&quot;&gt;
                &lt;span class=&quot;result-price&quot;&gt;$2285&lt;/span&gt;
        &lt;/a&gt;

    &lt;p class=&quot;result-info&quot;&gt;
        &lt;span class=&quot;icon icon-star&quot; role=&quot;button&quot;&gt;
            &lt;span class=&quot;screen-reader-text&quot;&gt;favorite this post&lt;/span&gt;
        &lt;/span&gt;

            &lt;time class=&quot;result-date&quot; datetime=&quot;2019-01-06 12:06&quot; title=&quot;Sun 06 Jan 12:06:01 PM&quot;&gt;Jan  6&lt;/time&gt;


        &lt;a href=&quot;https://vancouver.craigslist.org/nvn/apa/d/north-vancouver-luxury-1-bedroom/6788463837.html&quot; data-id=&quot;6788463837&quot; class=&quot;result-title hdrlnk&quot;&gt;Luxury 1 Bedroom CentreView with View - Lonsdale&lt;/a&gt;

</code></pre>
<p>This is not easy for our human eyeballs to read! However, it is easy for us to use programmatic tools to extract the data we need by specifying which HTML tags (things inside <code>&lt;</code> and <code>&gt;</code> in the code above). For example, if we look in the code above and search for lines with a price, we can also look at the tags that are near that price and see if there’s a common “word” we can use that is near the price but doesn’t exist on other lines that have the information we are not interested in:</p>
<pre><code>&lt;span class=&quot;result-price&quot;&gt;$800&lt;/span&gt;</code></pre>
<p>and</p>
<pre><code>&lt;span class=&quot;result-price&quot;&gt;$2285&lt;/span&gt;</code></pre>
<p>What we can see is there is a special “word” here, “result-price”, which appears only on the lines with prices and not on the other lines (that have information we are not interested in). This special word and the context in which is is used (learned from the other words inside the HTML tag) can be combined to create something called a CSS selector. The CSS selector can then be used by R’s <code>rvest</code> package to select the information we want (here price) from the website source code.</p>
<p>Now, many websites are quite large and complex, and so then is their website source code. And as you saw above, it is not easy to read and pick out the special words we want with our human eyeballs. So to make this easier, we will use the SelectorGadget tool. It is an open source tool that simplifies generating and finding CSS selectors. We recommend you use the Chrome web browser to use this tool, and install the <a href="https://chrome.google.com/webstore/detail/selectorgadget/mhjhnkcfbdhnjickkkdbjoemdmbfginb">selector gadget tool from the Chrome Web Store</a>. Here is a short video on how to install and use the SelectorGadget tool to get a CSS selector for use in web scraping:</p>
<iframe width="840" height="473" src="https://www.youtube.com/embed/YdIWI6K64zo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
<p>From installing and using the selectorgadget as shown in the video above, we get the two CSS selectors <code>.housing</code> and <code>.result-price</code> that we can use to scrape information about the square footage and the rental price, respectively. The selector gadget returns them to us as a comma separated list (here <code>.housing , .result-price</code>), which is exactly the format we need to provide to R if we are using more than one CSS selector.</p>
</div>
<div id="are-you-allowed-to-scrape-that-website" class="section level3">
<h3><span class="header-section-number">2.8.2</span> Are you allowed to scrape that website?</h3>
<p><strong>BEFORE</strong> scraping data from the web, you should always check whether or not you are <strong>ALLOWED</strong> to scrape it! There are two documents that are important for this: the robots.txt file and reading the website’s Terms of Service document. The website’s Terms of Service document is probably the more important of the two, and so you should look there first. What happens when we look at Craigslist’s Terms of Service document? Well we read this:</p>
<p><em>“You agree not to copy/collect CL content via robots, spiders, scripts, scrapers, crawlers, or any automated or manual equivalent (e.g., by hand).”</em></p>
<p>source: <a href="https://www.craigslist.org/about/terms.of.use" class="uri">https://www.craigslist.org/about/terms.of.use</a></p>
<blockquote>
<p>Want to learn more about the legalities of web scraping and crawling? Read this interesting blog post titled <a href="https://benbernardblog.com/web-scraping-and-crawling-are-perfectly-legal-right/">“Web Scraping and Crawling Are Perfectly Legal, Right?” by Benoit Bernard</a> (this is optional, not required reading).</p>
</blockquote>
<p>So what to do now? Well, we shouldn’t scrape Craigslist! Let’s instead scrape some data on the population of Canadian cities from Wikipedia (who’s <a href="https://foundation.wikimedia.org/wiki/Terms_of_Use/en">Terms of Service document</a> does not explicilty say do not scrape). In this video below we demonstrate using the selectorgadget tool to get CSS Selectors from <a href="https://en.wikipedia.org/wiki/Canada">Wikipedia’s Canada</a> page to scrape a table that contains city names and their populations from the 2016 Canadian Census:</p>
<iframe width="840" height="473" src="https://www.youtube.com/embed/O9HKbdhqYzk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</div>
<div id="using-rvest" class="section level3">
<h3><span class="header-section-number">2.8.3</span> Using <code>rvest</code></h3>
<p>Now that we have our CSS selectors we can use <code>rvest</code> R package to scrape our desired data from the website. First we start by loading the <code>rvest</code> package:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="reading.html#cb82-1"></a><span class="kw">library</span>(rvest)</span></code></pre></div>
<p>Next, we tell R what page we want to scrape by providing the webpage’s URL in quotations to the function <code>read_html</code>:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="reading.html#cb83-1"></a>page &lt;-<span class="st"> </span><span class="kw">read_html</span>(<span class="st">&quot;https://en.wikipedia.org/wiki/Canada&quot;</span>)</span></code></pre></div>
<p>Then we send the page object to the <code>html_nodes</code> function. We also provide that function with the CSS selectors we obtained from the selectorgadget tool. These should be surrounded by quotations. The <code>html_nodes</code> function select nodes from the HTML document using CSS selectors. Nodes are the HTML tag pairs as well as the content between the tags. For our CSS selector <code>td:nth-child(5)</code> and example node that would be selected would be: <code>&lt;td style="text-align:left;background:#f0f0f0;"&gt;&lt;a href="/wiki/London,_Ontario" title="London, Ontario"&gt;London&lt;/a&gt;&lt;/td&gt;</code></p>
<p>We will use <code>head()</code> here to limit the print output of these vectors to 6 lines.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="reading.html#cb84-1"></a>population_nodes &lt;-<span class="st"> </span><span class="kw">html_nodes</span>(page, <span class="st">&quot;td:nth-child(5) , td:nth-child(7) , .infobox:nth-child(122) td:nth-child(1) , .infobox td:nth-child(3)&quot;</span>)</span>
<span id="cb84-2"><a href="reading.html#cb84-2"></a><span class="kw">head</span>(population_nodes)</span></code></pre></div>
<pre><code>## {xml_nodeset (6)}
## [1] &lt;td style=&quot;text-align:right;&quot;&gt;5,928,040&lt;/td&gt;
## [2] &lt;td style=&quot;text-align:left;background:#f0f0f0;&quot;&gt;&lt;a href=&quot;/wiki/London,_Ontario&quot; title=&quot;Londo ...
## [3] &lt;td style=&quot;text-align:right;&quot;&gt;494,069\n&lt;/td&gt;
## [4] &lt;td style=&quot;text-align:right;&quot;&gt;4,098,927&lt;/td&gt;
## [5] &lt;td style=&quot;text-align:left;background:#f0f0f0;&quot;&gt;\n&lt;a href=&quot;/wiki/St._Catharines&quot; title=&quot;St.  ...
## [6] &lt;td style=&quot;text-align:right;&quot;&gt;406,074\n&lt;/td&gt;</code></pre>
<p>Next we extract the meaningful data from the HTML nodes using the <code>html_text</code> function. For our example, this functions only required argument is the an html_nodes object, which we named <code>rent_nodes</code>. In the case of this example node: <code>&lt;td style="text-align:left;background:#f0f0f0;"&gt;&lt;a href="/wiki/London,_Ontario" title="London, Ontario"&gt;London&lt;/a&gt;&lt;/td&gt;</code>, the <code>html_text</code> function would return <code>London</code>.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="reading.html#cb86-1"></a>population_text &lt;-<span class="st"> </span><span class="kw">html_text</span>(population_nodes)</span>
<span id="cb86-2"><a href="reading.html#cb86-2"></a><span class="kw">head</span>(population_text)</span></code></pre></div>
<pre><code>## [1] &quot;5,928,040&quot;              &quot;London&quot;                 &quot;494,069\n&quot;             
## [4] &quot;4,098,927&quot;              &quot;St. Catharines–Niagara&quot; &quot;406,074\n&quot;</code></pre>
<p>Are we done? Not quite… If you look at the data closely you see that the data is not in an optimal format for data analysis. Both the city names and population are encoded as characters in a single vector instead of being in a data frame with one character column for city and one numeric column for population (think of how you would organize the data in a spreadsheet). Additionally, the populations contain commas (not useful for programmatically dealing with numbers), and some even contain a line break character at the end (<code>\n</code>). Next chapter we will learn more about data wrangling using R so that we can easily clean up this data with a few lines of code.</p>
</div>
</div>
<div id="additional-resources" class="section level2">
<h2><span class="header-section-number">2.9</span> Additional resources</h2>
<ul>
<li><a href="https://r4ds.had.co.nz/data-import.html">Data import chapter</a> from <a href="https://r4ds.had.co.nz/">R for Data Science</a> by Garrett Grolemund &amp; Hadley Wickham</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="wrangling.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/01-reading.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
