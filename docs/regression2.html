<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Regression II: linear regression | Introduction to Data Science</title>
  <meta name="description" content="This is an open source textbook for teaching introductory data science." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Regression II: linear regression | Introduction to Data Science" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is an open source textbook for teaching introductory data science." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Regression II: linear regression | Introduction to Data Science" />
  
  <meta name="twitter:description" content="This is an open source textbook for teaching introductory data science." />
  

<meta name="author" content="Tiffany-Anne Timbers" />
<meta name="author" content="Trevor Campbell" />
<meta name="author" content="Melissa Lee" />


<meta name="date" content="2020-12-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="regression1.html"/>
<link rel="next" href="clustering.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Data Science</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> R, Jupyter, and the tidyverse</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#chapter-learning-objectives"><i class="fa fa-check"></i><b>1.1</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#jupyter-notebooks"><i class="fa fa-check"></i><b>1.2</b> Jupyter notebooks</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#loading-a-spreadsheet-like-dataset"><i class="fa fa-check"></i><b>1.3</b> Loading a spreadsheet-like dataset</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#assigning-value-to-a-data-frame"><i class="fa fa-check"></i><b>1.4</b> Assigning value to a data frame</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#creating-subsets-of-data-frames-with-select-filter"><i class="fa fa-check"></i><b>1.5</b> Creating subsets of data frames with <code>select</code> &amp; <code>filter</code></a><ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#using-select-to-extract-multiple-columns"><i class="fa fa-check"></i><b>1.5.1</b> Using <code>select</code> to extract multiple columns</a></li>
<li class="chapter" data-level="1.5.2" data-path="index.html"><a href="index.html#using-select-to-extract-a-range-of-columns"><i class="fa fa-check"></i><b>1.5.2</b> Using <code>select</code> to extract a range of columns</a></li>
<li class="chapter" data-level="1.5.3" data-path="index.html"><a href="index.html#using-filter-to-extract-a-single-row"><i class="fa fa-check"></i><b>1.5.3</b> Using <code>filter</code> to extract a single row</a></li>
<li class="chapter" data-level="1.5.4" data-path="index.html"><a href="index.html#using-filter-to-extract-rows-with-values-above-a-threshold"><i class="fa fa-check"></i><b>1.5.4</b> Using <code>filter</code> to extract rows with values above a threshold</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#exploring-data-with-visualizations"><i class="fa fa-check"></i><b>1.6</b> Exploring data with visualizations</a><ul>
<li class="chapter" data-level="1.6.1" data-path="index.html"><a href="index.html#using-ggplot-to-create-a-scatter-plot"><i class="fa fa-check"></i><b>1.6.1</b> Using <code>ggplot</code> to create a scatter plot</a></li>
<li class="chapter" data-level="1.6.2" data-path="index.html"><a href="index.html#formatting-ggplot-objects"><i class="fa fa-check"></i><b>1.6.2</b> Formatting ggplot objects</a></li>
<li class="chapter" data-level="1.6.3" data-path="index.html"><a href="index.html#changing-the-units"><i class="fa fa-check"></i><b>1.6.3</b> Changing the units</a></li>
<li class="chapter" data-level="1.6.4" data-path="index.html"><a href="index.html#coloring-points-by-group"><i class="fa fa-check"></i><b>1.6.4</b> Coloring points by group</a></li>
<li class="chapter" data-level="1.6.5" data-path="index.html"><a href="index.html#putting-it-all-together"><i class="fa fa-check"></i><b>1.6.5</b> Putting it all together</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reading.html"><a href="reading.html"><i class="fa fa-check"></i><b>2</b> Reading in data locally and from the web</a><ul>
<li class="chapter" data-level="2.1" data-path="reading.html"><a href="reading.html#overview"><i class="fa fa-check"></i><b>2.1</b> Overview</a></li>
<li class="chapter" data-level="2.2" data-path="reading.html"><a href="reading.html#chapter-learning-objectives-1"><i class="fa fa-check"></i><b>2.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="2.3" data-path="reading.html"><a href="reading.html#absolute-and-relative-file-paths"><i class="fa fa-check"></i><b>2.3</b> Absolute and relative file paths</a></li>
<li class="chapter" data-level="2.4" data-path="reading.html"><a href="reading.html#reading-tabular-data-from-a-plain-text-file-into-r"><i class="fa fa-check"></i><b>2.4</b> Reading tabular data from a plain text file into R</a><ul>
<li class="chapter" data-level="2.4.1" data-path="reading.html"><a href="reading.html#skipping-rows-when-reading-in-data"><i class="fa fa-check"></i><b>2.4.1</b> Skipping rows when reading in data</a></li>
<li class="chapter" data-level="2.4.2" data-path="reading.html"><a href="reading.html#read_delim-as-a-more-flexible-method-to-get-tabular-data-into-r"><i class="fa fa-check"></i><b>2.4.2</b> <code>read_delim</code> as a more flexible method to get tabular data into R</a></li>
<li class="chapter" data-level="2.4.3" data-path="reading.html"><a href="reading.html#reading-tabular-data-directly-from-a-url"><i class="fa fa-check"></i><b>2.4.3</b> Reading tabular data directly from a URL</a></li>
<li class="chapter" data-level="2.4.4" data-path="reading.html"><a href="reading.html#previewing-a-data-file-before-reading-it-into-r"><i class="fa fa-check"></i><b>2.4.4</b> Previewing a data file before reading it into R</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="reading.html"><a href="reading.html#reading-data-from-an-microsoft-excel-file"><i class="fa fa-check"></i><b>2.5</b> Reading data from an Microsoft Excel file</a></li>
<li class="chapter" data-level="2.6" data-path="reading.html"><a href="reading.html#reading-data-from-a-database"><i class="fa fa-check"></i><b>2.6</b> Reading data from a database</a><ul>
<li class="chapter" data-level="2.6.1" data-path="reading.html"><a href="reading.html#connecting-to-a-database"><i class="fa fa-check"></i><b>2.6.1</b> Connecting to a database</a></li>
<li class="chapter" data-level="2.6.2" data-path="reading.html"><a href="reading.html#interacting-with-a-database"><i class="fa fa-check"></i><b>2.6.2</b> Interacting with a database</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="reading.html"><a href="reading.html#writing-data-from-r-to-a-.csv-file"><i class="fa fa-check"></i><b>2.7</b> Writing data from R to a <code>.csv</code> file</a></li>
<li class="chapter" data-level="2.8" data-path="reading.html"><a href="reading.html#scraping-data-off-the-web-using-r"><i class="fa fa-check"></i><b>2.8</b> Scraping data off the web using R</a><ul>
<li class="chapter" data-level="2.8.1" data-path="reading.html"><a href="reading.html#html-and-css-selectors"><i class="fa fa-check"></i><b>2.8.1</b> HTML and CSS selectors</a></li>
<li class="chapter" data-level="2.8.2" data-path="reading.html"><a href="reading.html#are-you-allowed-to-scrape-that-website"><i class="fa fa-check"></i><b>2.8.2</b> Are you allowed to scrape that website?</a></li>
<li class="chapter" data-level="2.8.3" data-path="reading.html"><a href="reading.html#using-rvest"><i class="fa fa-check"></i><b>2.8.3</b> Using <code>rvest</code></a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="reading.html"><a href="reading.html#additional-resources"><i class="fa fa-check"></i><b>2.9</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="wrangling.html"><a href="wrangling.html"><i class="fa fa-check"></i><b>3</b> Cleaning and wrangling data</a><ul>
<li class="chapter" data-level="3.1" data-path="wrangling.html"><a href="wrangling.html#overview-1"><i class="fa fa-check"></i><b>3.1</b> Overview</a></li>
<li class="chapter" data-level="3.2" data-path="wrangling.html"><a href="wrangling.html#chapter-learning-objectives-2"><i class="fa fa-check"></i><b>3.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="3.3" data-path="wrangling.html"><a href="wrangling.html#vectors-and-data-frames"><i class="fa fa-check"></i><b>3.3</b> Vectors and Data frames</a><ul>
<li class="chapter" data-level="3.3.1" data-path="wrangling.html"><a href="wrangling.html#what-is-a-data-frame"><i class="fa fa-check"></i><b>3.3.1</b> What is a data frame?</a></li>
<li class="chapter" data-level="3.3.2" data-path="wrangling.html"><a href="wrangling.html#what-is-a-vector"><i class="fa fa-check"></i><b>3.3.2</b> What is a vector?</a></li>
<li class="chapter" data-level="3.3.3" data-path="wrangling.html"><a href="wrangling.html#how-are-vectors-different-from-a-list"><i class="fa fa-check"></i><b>3.3.3</b> How are vectors different from a list?</a></li>
<li class="chapter" data-level="3.3.4" data-path="wrangling.html"><a href="wrangling.html#what-does-this-have-to-do-with-data-frames"><i class="fa fa-check"></i><b>3.3.4</b> What does this have to do with data frames?</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="wrangling.html"><a href="wrangling.html#tidy-data"><i class="fa fa-check"></i><b>3.4</b> Tidy Data</a><ul>
<li class="chapter" data-level="3.4.1" data-path="wrangling.html"><a href="wrangling.html#what-is-tidy-data"><i class="fa fa-check"></i><b>3.4.1</b> What is tidy data?</a></li>
<li class="chapter" data-level="3.4.2" data-path="wrangling.html"><a href="wrangling.html#why-is-tidy-data-important-in-r"><i class="fa fa-check"></i><b>3.4.2</b> Why is tidy data important in R?</a></li>
<li class="chapter" data-level="3.4.3" data-path="wrangling.html"><a href="wrangling.html#going-from-wide-to-long-or-tidy-using-pivot_longer"><i class="fa fa-check"></i><b>3.4.3</b> Going from wide to long (or tidy!) using <code>pivot_longer</code></a></li>
<li class="chapter" data-level="3.4.4" data-path="wrangling.html"><a href="wrangling.html#going-from-long-to-wide-using-pivot_wider"><i class="fa fa-check"></i><b>3.4.4</b> Going from long to wide using <code>pivot_wider</code></a></li>
<li class="chapter" data-level="3.4.5" data-path="wrangling.html"><a href="wrangling.html#using-separate-to-deal-with-multiple-delimiters"><i class="fa fa-check"></i><b>3.4.5</b> Using <code>separate</code> to deal with multiple delimiters</a></li>
<li class="chapter" data-level="3.4.6" data-path="wrangling.html"><a href="wrangling.html#notes-on-defining-tidy-data"><i class="fa fa-check"></i><b>3.4.6</b> Notes on defining tidy data</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="wrangling.html"><a href="wrangling.html#combining-functions-using-the-pipe-operator"><i class="fa fa-check"></i><b>3.5</b> Combining functions using the pipe operator, <code>%&gt;%</code>:</a><ul>
<li class="chapter" data-level="3.5.1" data-path="wrangling.html"><a href="wrangling.html#using-to-combine-filter-and-select"><i class="fa fa-check"></i><b>3.5.1</b> Using <code>%&gt;%</code> to combine <code>filter</code> and <code>select</code></a></li>
<li class="chapter" data-level="3.5.2" data-path="wrangling.html"><a href="wrangling.html#using-with-more-than-two-functions"><i class="fa fa-check"></i><b>3.5.2</b> Using <code>%&gt;%</code> with more than two functions</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="wrangling.html"><a href="wrangling.html#iterating-over-data-with-group_by-summarize"><i class="fa fa-check"></i><b>3.6</b> Iterating over data with <code>group_by</code> + <code>summarize</code></a><ul>
<li class="chapter" data-level="3.6.1" data-path="wrangling.html"><a href="wrangling.html#calculating-summary-statistics"><i class="fa fa-check"></i><b>3.6.1</b> Calculating summary statistics:</a></li>
<li class="chapter" data-level="3.6.2" data-path="wrangling.html"><a href="wrangling.html#calculating-group-summary-statistics"><i class="fa fa-check"></i><b>3.6.2</b> Calculating group summary statistics:</a></li>
<li class="chapter" data-level="3.6.3" data-path="wrangling.html"><a href="wrangling.html#additional-reading-on-the-dplyr-functions"><i class="fa fa-check"></i><b>3.6.3</b> Additional reading on the <code>dplyr</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="wrangling.html"><a href="wrangling.html#using-purrrs-map-functions-to-iterate"><i class="fa fa-check"></i><b>3.7</b> Using <code>purrr</code>’s <code>map*</code> functions to iterate</a></li>
<li class="chapter" data-level="3.8" data-path="wrangling.html"><a href="wrangling.html#additional-resources-1"><i class="fa fa-check"></i><b>3.8</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="viz.html"><a href="viz.html"><i class="fa fa-check"></i><b>4</b> Effective data visualization</a><ul>
<li class="chapter" data-level="4.1" data-path="viz.html"><a href="viz.html#overview-2"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="viz.html"><a href="viz.html#chapter-learning-objectives-3"><i class="fa fa-check"></i><b>4.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="4.3" data-path="viz.html"><a href="viz.html#choosing-the-visualization"><i class="fa fa-check"></i><b>4.3</b> Choosing the visualization</a></li>
<li class="chapter" data-level="4.4" data-path="viz.html"><a href="viz.html#refining-the-visualization"><i class="fa fa-check"></i><b>4.4</b> Refining the visualization</a></li>
<li class="chapter" data-level="4.5" data-path="viz.html"><a href="viz.html#creating-visualizations-with-ggplot2"><i class="fa fa-check"></i><b>4.5</b> Creating visualizations with <code>ggplot2</code></a><ul>
<li class="chapter" data-level="4.5.1" data-path="viz.html"><a href="viz.html#the-mauna-loa-co2-data-set"><i class="fa fa-check"></i><b>4.5.1</b> The Mauna Loa CO2 data set</a></li>
<li class="chapter" data-level="4.5.2" data-path="viz.html"><a href="viz.html#the-island-landmass-data-set"><i class="fa fa-check"></i><b>4.5.2</b> The island landmass data set</a></li>
<li class="chapter" data-level="4.5.3" data-path="viz.html"><a href="viz.html#the-old-faithful-eruption-waiting-time-data-set"><i class="fa fa-check"></i><b>4.5.3</b> The Old Faithful eruption / waiting time data set</a></li>
<li class="chapter" data-level="4.5.4" data-path="viz.html"><a href="viz.html#the-michelson-speed-of-light-data-set"><i class="fa fa-check"></i><b>4.5.4</b> The Michelson speed of light data set</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="viz.html"><a href="viz.html#explaining-the-visualization"><i class="fa fa-check"></i><b>4.6</b> Explaining the visualization</a></li>
<li class="chapter" data-level="4.7" data-path="viz.html"><a href="viz.html#saving-the-visualization"><i class="fa fa-check"></i><b>4.7</b> Saving the visualization</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="version-control.html"><a href="version-control.html"><i class="fa fa-check"></i><b>5</b> Collaboration with version control</a><ul>
<li class="chapter" data-level="5.1" data-path="version-control.html"><a href="version-control.html#overview-3"><i class="fa fa-check"></i><b>5.1</b> Overview</a></li>
<li class="chapter" data-level="5.2" data-path="version-control.html"><a href="version-control.html#chapter-learning-objectives-4"><i class="fa fa-check"></i><b>5.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="5.3" data-path="version-control.html"><a href="version-control.html#what-is-version-control-and-why-should-i-use-it"><i class="fa fa-check"></i><b>5.3</b> What is version control, and why should I use it?</a></li>
<li class="chapter" data-level="5.4" data-path="version-control.html"><a href="version-control.html#creating-a-space-for-your-project-online"><i class="fa fa-check"></i><b>5.4</b> Creating a space for your project online</a></li>
<li class="chapter" data-level="5.5" data-path="version-control.html"><a href="version-control.html#creating-and-editing-files-on-github"><i class="fa fa-check"></i><b>5.5</b> Creating and editing files on GitHub</a><ul>
<li class="chapter" data-level="5.5.1" data-path="version-control.html"><a href="version-control.html#the-pen-tool"><i class="fa fa-check"></i><b>5.5.1</b> The pen tool</a></li>
<li class="chapter" data-level="5.5.2" data-path="version-control.html"><a href="version-control.html#the-add-file-menu"><i class="fa fa-check"></i><b>5.5.2</b> The “Add file” menu</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="version-control.html"><a href="version-control.html#cloning-your-repository-on-jupyterhub"><i class="fa fa-check"></i><b>5.6</b> Cloning your repository on JupyterHub</a></li>
<li class="chapter" data-level="5.7" data-path="version-control.html"><a href="version-control.html#working-in-a-cloned-repository-on-jupyterhub"><i class="fa fa-check"></i><b>5.7</b> Working in a cloned repository on JupyterHub</a><ul>
<li class="chapter" data-level="5.7.1" data-path="version-control.html"><a href="version-control.html#specifying-files-to-commit"><i class="fa fa-check"></i><b>5.7.1</b> Specifying files to commit</a></li>
<li class="chapter" data-level="5.7.2" data-path="version-control.html"><a href="version-control.html#making-the-commit"><i class="fa fa-check"></i><b>5.7.2</b> Making the commit</a></li>
<li class="chapter" data-level="5.7.3" data-path="version-control.html"><a href="version-control.html#pushing-the-commits-to-github"><i class="fa fa-check"></i><b>5.7.3</b> Pushing the commits to GitHub</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="version-control.html"><a href="version-control.html#collaboration"><i class="fa fa-check"></i><b>5.8</b> Collaboration</a><ul>
<li class="chapter" data-level="5.8.1" data-path="version-control.html"><a href="version-control.html#giving-collaborators-access-to-your-project"><i class="fa fa-check"></i><b>5.8.1</b> Giving collaborators access to your project</a></li>
<li class="chapter" data-level="5.8.2" data-path="version-control.html"><a href="version-control.html#pulling-changes-from-github"><i class="fa fa-check"></i><b>5.8.2</b> Pulling changes from GitHub</a></li>
<li class="chapter" data-level="5.8.3" data-path="version-control.html"><a href="version-control.html#handling-merge-conflicts"><i class="fa fa-check"></i><b>5.8.3</b> Handling merge conflicts</a></li>
<li class="chapter" data-level="5.8.4" data-path="version-control.html"><a href="version-control.html#communicating-using-github-issues"><i class="fa fa-check"></i><b>5.8.4</b> Communicating using GitHub issues</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="version-control.html"><a href="version-control.html#additional-resources-2"><i class="fa fa-check"></i><b>5.9</b> Additional resources</a><ul>
<li class="chapter" data-level="5.9.1" data-path="version-control.html"><a href="version-control.html#best-practices-and-workflows"><i class="fa fa-check"></i><b>5.9.1</b> Best practices and workflows</a></li>
<li class="chapter" data-level="5.9.2" data-path="version-control.html"><a href="version-control.html#technical-references"><i class="fa fa-check"></i><b>5.9.2</b> Technical references</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>6</b> Classification I: training &amp; predicting</a><ul>
<li class="chapter" data-level="6.1" data-path="classification.html"><a href="classification.html#overview-4"><i class="fa fa-check"></i><b>6.1</b> Overview</a></li>
<li class="chapter" data-level="6.2" data-path="classification.html"><a href="classification.html#chapter-learning-objectives-5"><i class="fa fa-check"></i><b>6.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="6.3" data-path="classification.html"><a href="classification.html#the-classification-problem"><i class="fa fa-check"></i><b>6.3</b> The classification problem</a></li>
<li class="chapter" data-level="6.4" data-path="classification.html"><a href="classification.html#exploring-a-labelled-data-set"><i class="fa fa-check"></i><b>6.4</b> Exploring a labelled data set</a></li>
<li class="chapter" data-level="6.5" data-path="classification.html"><a href="classification.html#classification-with-k-nearest-neighbours"><i class="fa fa-check"></i><b>6.5</b> Classification with K-nearest neighbours</a></li>
<li class="chapter" data-level="6.6" data-path="classification.html"><a href="classification.html#k-nearest-neighbours-with-tidymodels"><i class="fa fa-check"></i><b>6.6</b> K-nearest neighbours with <code>tidymodels</code></a></li>
<li class="chapter" data-level="6.7" data-path="classification.html"><a href="classification.html#data-preprocessing-with-tidymodels"><i class="fa fa-check"></i><b>6.7</b> Data preprocessing with <code>tidymodels</code></a><ul>
<li class="chapter" data-level="6.7.1" data-path="classification.html"><a href="classification.html#centering-and-scaling"><i class="fa fa-check"></i><b>6.7.1</b> Centering and scaling</a></li>
<li class="chapter" data-level="6.7.2" data-path="classification.html"><a href="classification.html#balancing"><i class="fa fa-check"></i><b>6.7.2</b> Balancing</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="classification.html"><a href="classification.html#putting-it-together-in-a-workflow"><i class="fa fa-check"></i><b>6.8</b> Putting it together in a <code>workflow</code></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="classification-continued.html"><a href="classification-continued.html"><i class="fa fa-check"></i><b>7</b> Classification II: evaluation &amp; tuning</a><ul>
<li class="chapter" data-level="7.1" data-path="classification-continued.html"><a href="classification-continued.html#overview-5"><i class="fa fa-check"></i><b>7.1</b> Overview</a></li>
<li class="chapter" data-level="7.2" data-path="classification-continued.html"><a href="classification-continued.html#chapter-learning-objectives-6"><i class="fa fa-check"></i><b>7.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="7.3" data-path="classification-continued.html"><a href="classification-continued.html#evaluating-accuracy"><i class="fa fa-check"></i><b>7.3</b> Evaluating accuracy</a></li>
<li class="chapter" data-level="7.4" data-path="classification-continued.html"><a href="classification-continued.html#tuning-the-classifier"><i class="fa fa-check"></i><b>7.4</b> Tuning the classifier</a><ul>
<li class="chapter" data-level="7.4.1" data-path="classification-continued.html"><a href="classification-continued.html#cross-validation"><i class="fa fa-check"></i><b>7.4.1</b> Cross-validation</a></li>
<li class="chapter" data-level="7.4.2" data-path="classification-continued.html"><a href="classification-continued.html#parameter-value-selection"><i class="fa fa-check"></i><b>7.4.2</b> Parameter value selection</a></li>
<li class="chapter" data-level="7.4.3" data-path="classification-continued.html"><a href="classification-continued.html#underoverfitting"><i class="fa fa-check"></i><b>7.4.3</b> Under/overfitting</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="classification-continued.html"><a href="classification-continued.html#splitting-data"><i class="fa fa-check"></i><b>7.5</b> Splitting data</a></li>
<li class="chapter" data-level="7.6" data-path="classification-continued.html"><a href="classification-continued.html#summary"><i class="fa fa-check"></i><b>7.6</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="regression1.html"><a href="regression1.html"><i class="fa fa-check"></i><b>8</b> Regression I: K-nearest neighbours</a><ul>
<li class="chapter" data-level="8.1" data-path="regression1.html"><a href="regression1.html#overview-6"><i class="fa fa-check"></i><b>8.1</b> Overview</a></li>
<li class="chapter" data-level="8.2" data-path="regression1.html"><a href="regression1.html#chapter-learning-objectives-7"><i class="fa fa-check"></i><b>8.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="8.3" data-path="regression1.html"><a href="regression1.html#regression"><i class="fa fa-check"></i><b>8.3</b> Regression</a></li>
<li class="chapter" data-level="8.4" data-path="regression1.html"><a href="regression1.html#sacremento-real-estate-example"><i class="fa fa-check"></i><b>8.4</b> Sacremento real estate example</a></li>
<li class="chapter" data-level="8.5" data-path="regression1.html"><a href="regression1.html#k-nearest-neighbours-regression"><i class="fa fa-check"></i><b>8.5</b> K-nearest neighbours regression</a></li>
<li class="chapter" data-level="8.6" data-path="regression1.html"><a href="regression1.html#training-evaluating-and-tuning-the-model"><i class="fa fa-check"></i><b>8.6</b> Training, evaluating, and tuning the model</a></li>
<li class="chapter" data-level="8.7" data-path="regression1.html"><a href="regression1.html#underfitting-and-overfitting"><i class="fa fa-check"></i><b>8.7</b> Underfitting and overfitting</a></li>
<li class="chapter" data-level="8.8" data-path="regression1.html"><a href="regression1.html#evaluating-on-the-test-set"><i class="fa fa-check"></i><b>8.8</b> Evaluating on the test set</a></li>
<li class="chapter" data-level="8.9" data-path="regression1.html"><a href="regression1.html#strengths-and-limitations-of-k-nn-regression"><i class="fa fa-check"></i><b>8.9</b> Strengths and limitations of K-NN regression</a></li>
<li class="chapter" data-level="8.10" data-path="regression1.html"><a href="regression1.html#multivariate-k-nn-regression"><i class="fa fa-check"></i><b>8.10</b> Multivariate K-NN regression</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="regression2.html"><a href="regression2.html"><i class="fa fa-check"></i><b>9</b> Regression II: linear regression</a><ul>
<li class="chapter" data-level="9.1" data-path="regression2.html"><a href="regression2.html#overview-7"><i class="fa fa-check"></i><b>9.1</b> Overview</a></li>
<li class="chapter" data-level="9.2" data-path="regression2.html"><a href="regression2.html#chapter-learning-objectives-8"><i class="fa fa-check"></i><b>9.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="9.3" data-path="regression2.html"><a href="regression2.html#simple-linear-regression"><i class="fa fa-check"></i><b>9.3</b> Simple linear regression</a></li>
<li class="chapter" data-level="9.4" data-path="regression2.html"><a href="regression2.html#linear-regression-in-r"><i class="fa fa-check"></i><b>9.4</b> Linear regression in R</a></li>
<li class="chapter" data-level="9.5" data-path="regression2.html"><a href="regression2.html#comparing-simple-linear-and-k-nn-regression"><i class="fa fa-check"></i><b>9.5</b> Comparing simple linear and K-NN regression</a></li>
<li class="chapter" data-level="9.6" data-path="regression2.html"><a href="regression2.html#multivariate-linear-regression"><i class="fa fa-check"></i><b>9.6</b> Multivariate linear regression</a></li>
<li class="chapter" data-level="9.7" data-path="regression2.html"><a href="regression2.html#the-other-side-of-regression"><i class="fa fa-check"></i><b>9.7</b> The other side of regression</a></li>
<li class="chapter" data-level="9.8" data-path="regression2.html"><a href="regression2.html#additional-resources-3"><i class="fa fa-check"></i><b>9.8</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>10</b> Clustering</a><ul>
<li class="chapter" data-level="10.1" data-path="clustering.html"><a href="clustering.html#overview-8"><i class="fa fa-check"></i><b>10.1</b> Overview</a></li>
<li class="chapter" data-level="10.2" data-path="clustering.html"><a href="clustering.html#chapter-learning-objectives-9"><i class="fa fa-check"></i><b>10.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="10.3" data-path="clustering.html"><a href="clustering.html#clustering-1"><i class="fa fa-check"></i><b>10.3</b> Clustering</a></li>
<li class="chapter" data-level="10.4" data-path="clustering.html"><a href="clustering.html#k-means"><i class="fa fa-check"></i><b>10.4</b> K-means</a><ul>
<li class="chapter" data-level="10.4.1" data-path="clustering.html"><a href="clustering.html#measuring-cluster-quality"><i class="fa fa-check"></i><b>10.4.1</b> Measuring cluster quality</a></li>
<li class="chapter" data-level="10.4.2" data-path="clustering.html"><a href="clustering.html#the-clustering-algorithm"><i class="fa fa-check"></i><b>10.4.2</b> The clustering algorithm</a></li>
<li class="chapter" data-level="10.4.3" data-path="clustering.html"><a href="clustering.html#random-restarts"><i class="fa fa-check"></i><b>10.4.3</b> Random restarts</a></li>
<li class="chapter" data-level="10.4.4" data-path="clustering.html"><a href="clustering.html#choosing-k"><i class="fa fa-check"></i><b>10.4.4</b> Choosing K</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="clustering.html"><a href="clustering.html#data-pre-processing-for-k-means"><i class="fa fa-check"></i><b>10.5</b> Data pre-processing for K-means</a></li>
<li class="chapter" data-level="10.6" data-path="clustering.html"><a href="clustering.html#k-means-in-r"><i class="fa fa-check"></i><b>10.6</b> K-means in R</a></li>
<li class="chapter" data-level="10.7" data-path="clustering.html"><a href="clustering.html#additional-resources-4"><i class="fa fa-check"></i><b>10.7</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>11</b> Introduction to Statistical Inference</a><ul>
<li class="chapter" data-level="11.1" data-path="inference.html"><a href="inference.html#overview-9"><i class="fa fa-check"></i><b>11.1</b> Overview</a></li>
<li class="chapter" data-level="11.2" data-path="inference.html"><a href="inference.html#chapter-learning-objectives-10"><i class="fa fa-check"></i><b>11.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="11.3" data-path="inference.html"><a href="inference.html#why-do-we-need-sampling"><i class="fa fa-check"></i><b>11.3</b> Why do we need sampling?</a></li>
<li class="chapter" data-level="11.4" data-path="inference.html"><a href="inference.html#sampling-distributions"><i class="fa fa-check"></i><b>11.4</b> Sampling distributions</a><ul>
<li class="chapter" data-level="11.4.1" data-path="inference.html"><a href="inference.html#sampling-distributions-for-proportions"><i class="fa fa-check"></i><b>11.4.1</b> Sampling distributions for proportions</a></li>
<li class="chapter" data-level="11.4.2" data-path="inference.html"><a href="inference.html#sampling-distributions-for-means"><i class="fa fa-check"></i><b>11.4.2</b> Sampling distributions for means</a></li>
<li class="chapter" data-level="11.4.3" data-path="inference.html"><a href="inference.html#summary-1"><i class="fa fa-check"></i><b>11.4.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="inference.html"><a href="inference.html#bootstrapping"><i class="fa fa-check"></i><b>11.5</b> Bootstrapping</a><ul>
<li class="chapter" data-level="11.5.1" data-path="inference.html"><a href="inference.html#overview-10"><i class="fa fa-check"></i><b>11.5.1</b> Overview</a></li>
<li class="chapter" data-level="11.5.2" data-path="inference.html"><a href="inference.html#bootstrapping-in-r"><i class="fa fa-check"></i><b>11.5.2</b> Bootstrapping in R</a></li>
<li class="chapter" data-level="11.5.3" data-path="inference.html"><a href="inference.html#using-the-bootstrap-to-calculate-a-plausible-range"><i class="fa fa-check"></i><b>11.5.3</b> Using the bootstrap to calculate a plausible range</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="inference.html"><a href="inference.html#additional-resources-5"><i class="fa fa-check"></i><b>11.6</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="move-to-your-own-machine.html"><a href="move-to-your-own-machine.html"><i class="fa fa-check"></i><b>12</b> Moving to your own machine</a><ul>
<li class="chapter" data-level="12.1" data-path="move-to-your-own-machine.html"><a href="move-to-your-own-machine.html#overview-11"><i class="fa fa-check"></i><b>12.1</b> Overview</a></li>
<li class="chapter" data-level="12.2" data-path="move-to-your-own-machine.html"><a href="move-to-your-own-machine.html#chapter-learning-objectives-11"><i class="fa fa-check"></i><b>12.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="12.3" data-path="move-to-your-own-machine.html"><a href="move-to-your-own-machine.html#installing-software-on-your-own-computer"><i class="fa fa-check"></i><b>12.3</b> Installing software on your own computer</a><ul>
<li class="chapter" data-level="12.3.1" data-path="move-to-your-own-machine.html"><a href="move-to-your-own-machine.html#git"><i class="fa fa-check"></i><b>12.3.1</b> Git</a></li>
<li class="chapter" data-level="12.3.2" data-path="move-to-your-own-machine.html"><a href="move-to-your-own-machine.html#miniconda"><i class="fa fa-check"></i><b>12.3.2</b> Miniconda</a></li>
<li class="chapter" data-level="12.3.3" data-path="move-to-your-own-machine.html"><a href="move-to-your-own-machine.html#jupyterlab"><i class="fa fa-check"></i><b>12.3.3</b> JupyterLab</a></li>
<li class="chapter" data-level="12.3.4" data-path="move-to-your-own-machine.html"><a href="move-to-your-own-machine.html#r-and-the-irkernel"><i class="fa fa-check"></i><b>12.3.4</b> R and the IRkernel</a></li>
<li class="chapter" data-level="12.3.5" data-path="move-to-your-own-machine.html"><a href="move-to-your-own-machine.html#r-packages"><i class="fa fa-check"></i><b>12.3.5</b> R packages</a></li>
<li class="chapter" data-level="12.3.6" data-path="move-to-your-own-machine.html"><a href="move-to-your-own-machine.html#latex"><i class="fa fa-check"></i><b>12.3.6</b> LaTeX</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="move-to-your-own-machine.html"><a href="move-to-your-own-machine.html#moving-files-to-your-computer"><i class="fa fa-check"></i><b>12.4</b> Moving files to your computer</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Data Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regression2" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> Regression II: linear regression</h1>
<div id="overview-7" class="section level2">
<h2><span class="header-section-number">9.1</span> Overview</h2>
<p>This chapter provides an introduction to linear regression models
in a predictive context, focusing primarily on the case where
there is a single predictor and single response variable of interest,
as well as comparison to K-nearest neighbours methods. The
chapter concludes with a discussion of linear regression with
multiple predictors.</p>
</div>
<div id="chapter-learning-objectives-8" class="section level2">
<h2><span class="header-section-number">9.2</span> Chapter learning objectives</h2>
<p>By the end of the chapter, students will be able to:</p>
<ul>
<li>Perform linear regression in R using <code>tidymodels</code> and evaluate it on a test dataset.</li>
<li>Compare and contrast predictions obtained from K-nearest neighbour regression to those obtained using simple ordinary least squares regression from the same dataset.</li>
<li>In R, overlay regression lines from <code>geom_smooth</code> on a single plot.</li>
</ul>
</div>
<div id="simple-linear-regression" class="section level2">
<h2><span class="header-section-number">9.3</span> Simple linear regression</h2>
<p>K-NN is not the only type of regression; another
quite useful, and arguably the most common, type of regression is
called simple linear regression. Simple
linear regression is similar to K-NN regression in that the target/response
variable is quantitative. However, one way it varies quite
differently is how the training data is used to predict a value for a new
observation. Instead of looking at the <span class="math inline">\(K\)</span>-nearest neighbours and averaging
over their values for a prediction, in simple linear regression all the
training data points are used to create a straight line of best fit, and then
the line is used to “look up” the predicted value.</p>
<blockquote>
<p>Note: for simple linear
regression there is only one response variable and only one predictor. Later in
this chapter we introduce the more general linear regression case where more
than one predictor can be used.</p>
</blockquote>
<p>For example, let’s revisit the smaller version of the Sacramento housing data
set. Recall that we have come across a new 2,000-square foot house we are interested
in purchasing with an advertised list price of
$350,000. Should we offer the list price, or is that over/undervalued?</p>
<p>To answer this question using simple linear regression, we use the data we have
to draw the straight line of best fit through our existing data points:</p>
<p><img src="_main_files/figure-html/08-lin-reg1-1.png" width="480" /></p>
<p>The equation for the straight line is:</p>
<p><span class="math display">\[\text{house price} = \beta_0 + \beta_1 \cdot (\text{house size}),\]</span>
where</p>
<ul>
<li><span class="math inline">\(\beta_0\)</span> is the vertical intercept of the line (the value where the line cuts the vertical axis)</li>
<li><span class="math inline">\(\beta_1\)</span> is the slope of the line</li>
</ul>
<p>Therefore using the data to find the line of best fit is equivalent to finding coefficients
<span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> that <em>parametrize</em> (correspond to) the line of best fit.
Once we have the coefficients, we can use the equation above to evaluate the predicted price given the value we
have for the predictor/explanatory variable—here 2,000 square feet.</p>
<p><img src="_main_files/figure-html/08-lin-reg2-1.png" width="480" /></p>
<pre><code>## [1] 287961.9</code></pre>
<p>By using simple linear regression on this small data set to predict the sale price
for a 2,000 square foot house, we get a predicted value of
$287962. But wait a minute…how
exactly does simple linear regression choose the line of best fit? Many
different lines could be drawn through the data points. We show some examples
below:</p>
<p><img src="_main_files/figure-html/08-several-lines-1.png" width="480" /></p>
<p>Simple linear regression chooses the straight line of best fit by choosing
the line that minimzes the <strong>average</strong> vertical distance between itself and
each of the observed data points. From the lines shown above, that is the blue
line. What exactly do we mean by the vertical distance between the predicted
values (which fall along the line of best fit) and the observed data points?
We illustrate these distances in the plot below with a red line:</p>
<p><img src="_main_files/figure-html/08-verticalDistToMin-1.png" width="480" /></p>
<p>To assess the predictive accuracy of a simple linear regression model,
we use RMSPE—the same measure of predictive performance we used with K-NN regression.</p>
</div>
<div id="linear-regression-in-r" class="section level2">
<h2><span class="header-section-number">9.4</span> Linear regression in R</h2>
<p>We can perform simple linear regression in R using <code>tidymodels</code> in a
very similar manner to how we performed K-NN regression.
To do this, instead of creating a <code>nearest_neighbor</code> model specification with
the <code>kknn</code> engine, we use a <code>linear_reg</code> model specification
with the <code>lm</code> engine. Another difference is that we do not need to choose <span class="math inline">\(K\)</span> in the
context of linear regression, and so we do not need to perform cross validation.
Below we illustrate how we can use the usual <code>tidymodels</code> workflow to predict house sale
price given house size using a simple linear regression approach using the full
Sacramento real estate data set.</p>
<blockquote>
<p>An additional difference that you will notice below is that we do not standardize
(i.e., scale and center) our predictors. In K-nearest neighbours models, recall that
the model fit changes depending on whether we standardize first or not. In linear regression,
standardization does not affect the fit (it <em>does</em> affect the coefficients in the equation, though!).
So you can standardize if you want—it won’t hurt anything—but if you leave the
predictors in their original form, the best fit coefficients are usually easier to interpret afterward.</p>
</blockquote>
<p>As usual, we start by putting some test data away in a lock box that we
can come back to after we choose our final model. Let’s take care of that now.</p>
<p>Now that we have our training data, we will create the model specification
and recipe, and fit our simple linear regression model:</p>
<pre><code>## ══ Workflow [trained] ══════════════════════════════════════════════════════════
## Preprocessor: Recipe
## Model: linear_reg()
## 
## ── Preprocessor ────────────────────────────────────────────────────────────────
## 0 Recipe Steps
## 
## ── Model ───────────────────────────────────────────────────────────────────────
## 
## Call:
## stats::lm(formula = formula, data = data)
## 
## Coefficients:
## (Intercept)         sqft  
##       15059          138</code></pre>
<p>Our coefficients are
(intercept) <span class="math inline">\(\beta_0=\)</span> 15059
and (slope) <span class="math inline">\(\beta_1=\)</span> 138.
This means that the equation of the line of best fit is
<span class="math display">\[\text{house price} = 15059 + 138\cdot (\text{house size}),\]</span>
and that the model predicts that houses
start at $15059 for 0 square feet, and that
every extra square foot increases the cost of the house by $138. Finally, we predict on the test data set to assess how well our model does:</p>
<pre><code>## # A tibble: 3 x 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 rmse    standard   85161.   
## 2 rsq     standard       0.572
## 3 mae     standard   62608.</code></pre>
<p>Our final model’s test error as assessed by RMSPE
is 85161.
Remember that this is in units of the target/response variable, and here that
is US Dollars (USD). Does this mean our model is “good” at predicting house
sale price based off of the predictor of home size? Again answering this is
tricky to answer and requires to use domain knowledge and think about the
application you are using the prediction for.</p>
<p>To visualize the simple linear regression model, we can plot the predicted house
price across all possible house sizes we might encounter superimposed on a scatter
plot of the original housing price data. There is a plotting function in
the <code>tidyverse</code>, <code>geom_smooth</code>, that
allows us to do this easily by adding a layer on our plot with the simple
linear regression predicted line of best fit. The default for this adds a
plausible range to this line that we are not interested in at this point, so to
avoid plotting it, we provide the argument <code>se = FALSE</code> in our call to
<code>geom_smooth</code>.</p>
<p><img src="_main_files/figure-html/08-lm-predict-all-1.png" width="480" /></p>
<p>We can extract the coefficients from our model by accessing the
fit object that is output by the <code>fit</code> function; we first have to extract
it from the workflow using the <code>pull_workflow_fit</code> function, and then apply
the <code>tidy</code> function to convert the result into a data frame:</p>
<pre><code>## # A tibble: 2 x 5
##   term        estimate std.error statistic   p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)   15059.   8745.        1.72 8.56e-  2
## 2 sqft            138.      4.77     28.9  3.13e-113</code></pre>
</div>
<div id="comparing-simple-linear-and-k-nn-regression" class="section level2">
<h2><span class="header-section-number">9.5</span> Comparing simple linear and K-NN regression</h2>
<p>Now that we have a general understanding of both simple linear and K-NN
regression, we can start to compare and contrast these methods as well as the
predictions made by them. To start, let’s look at the visualization of the
simple linear regression model predictions for the Sacramento real estate data
(predicting price from house size) and the “best” K-NN regression model
obtained from the same problem:</p>
<p><img src="_main_files/figure-html/08-compareRegression-1.png" width="960" /></p>
<p>What differences do we observe from the visualization above? One obvious
difference is the shape of the blue lines. In simple linear regression we are
restricted to a straight line, whereas in K-NN regression our line is much more
flexible and can be quite wiggly. But there is a major interpretability advantage in limiting the
model to a straight line. A
straight line can be defined by two numbers, the
vertical intercept and the slope. The intercept tells us what the prediction is when
all of the predictors are equal to 0; and the slope tells us what unit increase in the target/response
variable we predict given a unit increase in the predictor/explanatory
variable. K-NN regression, as simple as it is to implement and understand, has no such
interpretability from its wiggly line.</p>
<p>There can however also be a disadvantage to using a simple linear regression
model in some cases, particularly when the relationship between the target and
the predictor is not linear, but instead some other shape (e.g. curved or oscillating). In
these cases the prediction model from a simple linear regression
will underfit (have high bias), meaning that model/predicted values does not
match the actual observed values very well. Such a model would probably have a
quite high RMSE when assessing model goodness of fit on the training data and
a quite high RMPSE when assessing model prediction quality on a test data
set. On such a data set, K-NN regression may fare better. Additionally, there
are other types of regression you can learn about in future courses that may do
even better at predicting with such data.</p>
<p>How do these two models compare on the Sacramento house prices data set? On
the visualizations above we also printed the RMPSE as calculated from
predicting on the test data set that was not used to train/fit the models. The RMPSE for the simple linear
regression model is slightly lower than the RMPSE for the K-NN regression model.
Considering that the simple linear regression model is also more interpretable,
if we were comparing these in practice we would likely choose to use the simple
linear regression model.</p>
<p>Finally, note that the K-NN regression model becomes “flat”
at the left and right boundaries of the data, while the linear model
predicts a constant slope. Predicting outside the range of the observed
data is known as <em>extrapolation</em>; K-NN and linear models behave quite differently
when extrapolating. Depending on the application, the flat
or constant slope trend may make more sense. For example, if our housing
data were slightly different, the linear model may have actually predicted
a <em>negative</em> price for a small houses (if the intercept <span class="math inline">\(\beta_0\)</span> was negative),
which obviously does not match reality. On the other hand, the trend of increasing
house size corresponding to increasing house price probably continues for large houses,
so the “flat” extrapolation of K-NN likely does not match reality.</p>
</div>
<div id="multivariate-linear-regression" class="section level2">
<h2><span class="header-section-number">9.6</span> Multivariate linear regression</h2>
<p>As in K-NN classification and K-NN regression, we can move beyond the simple
case of one response variable and only one predictor and perform multivariate
linear regression where we can have multiple predictors. In this case we fit a
plane to the data, as opposed to a straight line.</p>
<p>To do this, we follow a very similar approach to what we did for
K-NN regression; but recall that we do not need to use cross-validation to choose any parameters,
nor do we need to standardize (i.e., center and scale) the data for linear regression.
We demonstrate how to do this below using the Sacramento real estate data with both house size
(measured in square feet) as well as number of bedrooms as our predictors, and
continue to use house sale price as our outcome/target variable that we are
trying to predict. We will start by changing the formula in the recipe to
include both the <code>sqft</code> and <code>beds</code> variables as predictors:</p>
<p>Now we can build our workflow and fit the model:</p>
<pre><code>## ══ Workflow [trained] ══════════════════════════════════════════════════════════
## Preprocessor: Recipe
## Model: linear_reg()
## 
## ── Preprocessor ────────────────────────────────────────────────────────────────
## 0 Recipe Steps
## 
## ── Model ───────────────────────────────────────────────────────────────────────
## 
## Call:
## stats::lm(formula = formula, data = data)
## 
## Coefficients:
## (Intercept)         sqft         beds  
##     52690.1        154.8     -20209.4</code></pre>
<p>And finally, we predict on the test data set to assess how well our model does:</p>
<pre><code>## # A tibble: 3 x 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 rmse    standard   82835.   
## 2 rsq     standard       0.596
## 3 mae     standard   61008.</code></pre>
<p>In the case of two predictors, our linear regression creates a <em>plane</em> of best fit, shown below:</p>
<p><div id="htmlwidget-d7ce09b600e0e15f993d" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-d7ce09b600e0e15f993d">{"x":{"visdat":{"2826bd86fe6":["function () ","plotlyVisDat"],"28238ab4ac1":["function () ","data"]},"cur_data":"28238ab4ac1","attrs":{"28238ab4ac1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"z":{},"type":"scatter3d","mode":"markers","marker":{"size":5,"opacity":0.4,"color":"red"},"inherit":true},"28238ab4ac1.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"z":{},"type":"surface","x":{},"y":{},"colorbar":{"title":"Price (USD)"},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"House size (square feet)"},"zaxis":{"title":"Price (USD)"},"yaxis":{"title":"Number of bedrooms"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[836,796,797,1122,1104,941,909,1289,871,1022,1134,844,795,1118,1240,1601,901,963,1380,1248,1039,1152,1380,1116,1082,1472,1146,1056,1043,1587,1120,1580,1477,1185,1406,1943,1172,1851,1130,1420,1280,2162,1665,1511,1590,1596,2136,1478,1287,1277,1448,2235,1193,2163,1269,1473,2508,1305,1591,1326,1921,1541,1672,1380,975,1284,3009,1126,1843,1520,2309,2367,3516,1914,1690,2725,2354,1842,1801,1961,3164,2054,1830,1627,3440,2846,2359,2052,3433,3615,2687,2724,3508,2462,2900,3705,3527,4878,1099,840,800,746,1337,924,610,1516,1220,722,1080,1050,1110,1120,1080,957,1080,1266,994,1202,1039,722,1183,1320,1364,1310,810,1123,904,1156,1439,1671,1740,1265,1007,1716,1685,1555,1137,1174,1393,1415,2126,1289,1799,1308,1953,723,948,1578,1317,1360,1522,1751,1465,1605,1475,1216,1315,1567,1291,1453,1503,1456,1574,1595,1567,2943,1768,2030,1531,2056,2494,1450,2169,1440,1527,1401,1411,2990,1533,1910,1981,3072,2205,1449,1258,539,1108,1595,1900,1718,3389,2190,3260,2016,2724,3192,2829,3928,3577,1247,2068,3992,3881,2272,2791,3117,3984,2222,2484,1624,484,970,932,796,834,795,1250,795,918,1082,964,888,1331,1014,1448,1100,1207,1995,1366,901,1104,972,1390,1209,1245,1416,1300,1120,1590,1407,1646,1676,1370,1351,1152,990,1162,1280,1039,1159,1520,1353,1505,1009,1144,930,1940,1258,1758,2142,950,1739,1516,988,1212,1871,1302,756,1058,1427,1798,2652,1816,3076,1176,1160,1424,1255,1718,1904,1808,2711,1713,2724,1468,2550,1922,1343,960,2109,1876,2218,1394,1410,2346,1659,2590,1673,1810,2789,1606,3499,1119,1871,1800,1625,2752,1179,2724,3281,1993,1939,1788,1691,4303,4246,2274,2962,3056,2503,3198,1905,1320,3741,3357,2025,3788,3670,1000,838,1032,904,1080,990,900,861,1011,1089,832,800,1292,1064,1320,1410,1115,1164,1219,1127,1272,1120,1260,1132,1466,1092,1628,960,1075,1428,2475,1711,1483,1140,1549,1410,1240,1712,1580,1669,1650,1200,1170,1695,1157,1410,1593,1093,1770,1124,1139,1638,1328,1273,1082,1578,1386,1513,1232,1473,1127,1144,972,2306,1479,1040,1800,1120,1232,1462,2329,1351,1284,1376,1032,1419,1637,1776,1338,1257,2254,1991,1094,2111,1915,1962,1406,1789,1876,1899,1636,1438,1451,1520,1506,2605,1811,1540,1910,1846,2494,2214,2280,1443,1582,1857,1720,2160,1382,1282,1919,1982,1144,1623,2592,2048,1327,1800,2457,2264,2004,3134,1951,1276,1888,1548,2109,2484,2258,2212,3163,2960,2172,1924,2577,1655,3179,2049,3042,2875,2199,2242,2334,1944,3913,2787,2824,3261,2053,1704,2418,3282,2806,3173,3380,4090,2356,3220,3579,3885,4400,864,1158,1139,1058,1040,1354,682,1161,1229,1249,1161,1010,1188,1093,1127,1309,970,1144,1065,1206,884,1019,924,1217,1670,1373,1381,1917,1608,1344,1057,1177,1582,1204,1497,1194,1428,1039,1529,1294,1638,1175,1416,936,1358,1609,1968,1089,1189,795,1371,1310,1262,1416,1302,1418,1462,1627,1665,1040,1197,1456,1450,1358,1329,1715,1262,2280,1477,1216,1685,1362],"y":[2,2,2,3,3,2,3,3,1,2,2,2,2,3,4,3,3,3,4,3,2,3,3,3,3,4,4,3,2,4,4,4,3,3,3,4,3,4,3,3,3,4,2,3,4,4,5,3,3,4,4,4,3,3,3,3,5,3,4,2,4,3,3,3,3,2,4,2,3,2,4,5,5,4,2,3,4,3,4,3,5,4,4,3,4,3,4,3,5,5,5,4,5,4,5,4,4,6,4,2,2,2,3,3,2,3,2,1,3,3,3,3,3,3,3,3,2,3,2,2,4,3,3,4,2,2,2,3,3,3,3,3,2,3,4,3,3,3,3,3,4,3,4,3,4,2,2,4,3,3,3,4,3,4,4,3,2,3,3,3,3,4,3,4,3,4,4,4,3,4,4,3,4,3,3,3,3,4,2,4,3,5,4,2,3,2,3,4,4,4,5,4,5,3,4,4,3,5,5,2,3,4,5,4,3,5,5,4,5,4,1,3,2,2,2,2,3,2,2,3,2,2,3,3,4,2,3,4,3,2,3,2,4,3,3,3,3,3,4,3,3,3,3,4,3,2,2,4,3,3,3,3,3,3,3,2,4,3,3,3,2,4,3,3,3,4,3,2,3,3,4,4,4,5,4,3,3,2,3,4,4,4,3,4,3,4,3,3,2,4,4,4,3,3,5,4,4,3,3,4,4,5,2,4,3,3,4,3,5,5,3,4,2,3,4,5,3,4,4,3,3,3,3,5,4,3,5,5,1,2,2,2,2,2,2,2,2,3,2,2,4,4,3,3,3,3,3,4,3,3,3,2,3,3,4,3,3,3,6,3,4,3,4,3,3,5,4,3,3,3,3,4,3,3,3,3,3,3,4,3,3,3,3,4,3,3,3,3,3,3,3,4,3,2,4,3,3,3,4,3,3,4,2,4,2,4,3,2,5,4,3,4,4,3,2,3,4,4,3,4,3,3,3,4,3,3,3,4,5,4,5,3,4,3,3,4,4,3,3,4,2,2,5,4,3,4,5,3,4,5,4,3,4,3,4,4,4,3,5,3,3,3,4,3,5,3,4,5,4,4,3,3,5,5,5,4,4,3,3,4,4,3,4,4,4,4,5,3,4,2,4,2,3,3,3,1,3,3,3,3,3,2,3,3,4,2,3,1,3,2,3,2,3,3,3,4,4,4,3,2,2,3,3,4,1,3,3,3,3,3,3,3,1,3,4,4,2,2,2,3,3,3,3,3,3,3,4,3,3,3,3,3,3,4,4,3,4,3,3,4,3],"z":[59222,68880,81900,89921,90895,94905,100309,106250,106852,108750,110700,113263,116250,122000,123000,124100,125000,127281,131200,132000,133000,134555,136500,138750,147308,148750,149593,156896,161250,161500,164000,165000,168000,178480,178760,179580,181000,182587,182750,189000,192067,195000,206000,208000,212864,221000,223058,231477,234697,235000,236000,236685,240122,242638,244000,244500,245918,250000,250000,250134,254200,260000,265000,265000,271742,280908,280987,292024,298000,299000,311000,315537,320000,328360,334150,335750,335750,339500,346210,347029,375000,381942,387731,391000,394470,395000,400186,415000,425000,430000,460000,461000,510000,539000,585000,600000,606238,830000,70000,71000,78000,78400,90000,92000,93675,97750,98000,98000,106716,123225,123750,125000,126000,129000,140000,140000,142500,143500,145000,145000,146000,148500,150000,150000,156000,156000,157788,161653,168000,175000,176250,179000,180000,180400,182000,185000,194000,195000,200000,201000,202500,205000,205000,205000,205000,207000,211500,215000,215000,215500,225000,225000,225000,228000,229665,230000,230000,230000,236250,242000,245000,250000,255000,260000,261000,261800,265000,270000,270000,275000,280000,286013,292000,292000,293993,294000,296769,297500,300000,300500,305000,315000,319789,330000,330000,334000,339000,339000,361745,361948,370000,380000,385000,399000,406026,425000,433500,436746,438700,445000,460000,460000,471750,500500,504000,541000,572500,582000,699000,839000,48000,61500,65000,65000,68000,82732,84000,90000,91000,95000,97500,101000,112500,113000,114000,115000,119250,120000,120108,121500,123000,125000,125573,130000,139500,140000,140800,145000,147000,149600,150000,155000,155435,158000,158000,160000,164000,167293,168000,170000,170000,192000,197654,198000,200345,203000,208000,212000,217500,218000,220000,221000,222900,223139,228327,230000,230000,230522,233641,236073,238861,239700,240000,240000,247234,249862,251000,260000,261000,261000,262500,266000,266000,274425,275336,277980,284686,284893,285000,296000,299940,311328,313138,316630,320000,328578,331500,344755,345746,351000,353767,355000,360000,360552,362305,367554,368500,378000,383000,395100,400000,423000,427500,430922,450000,452000,470000,471000,475000,484500,487500,500000,506688,579093,668365,677048,691659,760000,30000,55422,65000,65000,65000,66500,71000,75000,85000,95625,96140,104250,105000,109000,115500,115620,116000,122500,124000,124000,124413,130000,137760,145000,150000,150000,151000,155000,155800,156142,159900,161500,161600,162000,165000,165000,167293,168000,168000,168750,173000,176095,176250,179000,180000,180000,181000,182000,182587,185833,186785,187000,188335,190000,190000,190000,191250,193500,194818,195000,199900,200000,201000,204918,205000,205000,207000,209000,210000,212500,213750,215000,215000,215000,220000,220000,220702,221250,222000,222500,222750,225000,229000,233500,240000,240971,242000,243450,243500,249000,250000,252000,255000,255000,255000,257200,263500,266510,271000,272700,276000,278000,279000,280000,280000,285000,290000,290000,293996,294000,298000,298000,299000,300000,303000,306000,310000,310000,312000,313000,315000,315000,315000,320000,325000,328370,330000,331200,332000,334000,347225,350000,350000,356200,367463,386222,389000,395500,396000,397000,400000,412500,415000,425000,433500,441000,445000,446000,450000,475000,490000,493000,511000,525000,533000,560000,600000,600000,610000,680000,884790,68566,80000,93600,95000,97750,104000,107666,109000,110000,112500,114800,116000,123675,127059,130000,131750,132000,134000,138000,142000,147000,148750,150454,151087,157296,160000,161250,165000,165750,166000,170000,171750,172000,174250,179500,188000,188700,189000,189000,191250,191675,200000,200000,200100,201528,204750,205000,205000,207000,207973,208250,208318,209347,216000,219794,220000,220000,223000,224000,224000,224500,225000,228000,229027,229500,230000,230000,232425,234000,235000,235301,235738],"type":"scatter3d","mode":"markers","marker":{"color":"red","size":5,"opacity":0.4,"line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"colorbar":{"title":"Price (USD)","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"z":[[107423.478837049,121308.56350542,135193.648173792,149078.732842163,162963.817510535,176848.902178906,190733.986847278,204619.071515649,218504.156184021,232389.240852392,246274.325520764,260159.410189135,274044.494857507,287929.579525878,301814.66419425,315699.748862621,329584.833530993,343469.918199364,357355.002867736,371240.087536107,385125.172204479,399010.25687285,412895.341541222,426780.426209593,440665.510877965,454550.595546337,468435.680214708,482320.76488308,496205.849551451,510090.934219823,523976.018888194,537861.103556566,551746.188224937,565631.272893309,579516.35756168,593401.442230052,607286.526898423,621171.611566795,635056.696235166,648941.780903538,662826.865571909,676711.950240281,690597.034908652,704482.119577024,718367.204245395,732252.288913767,746137.373582138,760022.45825051,773907.542918881,787792.627587253],[105361.290778623,119246.375446995,133131.460115366,147016.544783738,160901.629452109,174786.714120481,188671.798788853,202556.883457224,216441.968125596,230327.052793967,244212.137462339,258097.22213071,271982.306799082,285867.391467453,299752.476135825,313637.560804196,327522.645472568,341407.730140939,355292.814809311,369177.899477682,383062.984146054,396948.068814425,410833.153482797,424718.238151168,438603.32281954,452488.407487911,466373.492156283,480258.576824654,494143.661493026,508028.746161397,521913.830829769,535798.915498141,549684.000166512,563569.084834884,577454.169503255,591339.254171627,605224.338839998,619109.42350837,632994.508176741,646879.592845113,660764.677513484,674649.762181856,688534.846850227,702419.931518599,716305.01618697,730190.100855342,744075.185523713,757960.270192085,771845.354860456,785730.439528828],[103299.102720198,117184.18738857,131069.272056941,144954.356725313,158839.441393684,172724.526062056,186609.610730427,200494.695398799,214379.78006717,228264.864735542,242149.949403913,256035.034072285,269920.118740656,283805.203409028,297690.288077399,311575.372745771,325460.457414142,339345.542082514,353230.626750885,367115.711419257,381000.796087628,394885.880756,408770.965424371,422656.050092743,436541.134761114,450426.219429486,464311.304097858,478196.388766229,492081.473434601,505966.558102972,519851.642771344,533736.727439715,547621.812108087,561506.896776458,575391.98144483,589277.066113201,603162.150781573,617047.235449944,630932.320118316,644817.404786687,658702.489455059,672587.57412343,686472.658791802,700357.743460173,714242.828128545,728127.912796916,742012.997465288,755898.082133659,769783.166802031,783668.251470402],[101236.914661773,115121.999330144,129007.083998516,142892.168666887,156777.253335259,170662.33800363,184547.422672002,198432.507340374,212317.592008745,226202.676677117,240087.761345488,253972.84601386,267857.930682231,281743.015350603,295628.100018974,309513.184687346,323398.269355717,337283.354024089,351168.43869246,365053.523360832,378938.608029203,392823.692697575,406708.777365946,420593.862034318,434478.946702689,448364.031371061,462249.116039432,476134.200707804,490019.285376175,503904.370044547,517789.454712918,531674.53938129,545559.624049661,559444.708718033,573329.793386405,587214.878054776,601099.962723147,614985.047391519,628870.132059891,642755.216728262,656640.301396634,670525.386065005,684410.470733377,698295.555401748,712180.64007012,726065.724738491,739950.809406863,753835.894075234,767720.978743606,781606.063411977],[99174.7266033476,113059.811271719,126944.895940091,140829.980608462,154715.065276834,168600.149945205,182485.234613577,196370.319281948,210255.40395032,224140.488618691,238025.573287063,251910.657955434,265795.742623806,279680.827292177,293565.911960549,307450.99662892,321336.081297292,335221.165965663,349106.250634035,362991.335302406,376876.419970778,390761.504639149,404646.589307521,418531.673975892,432416.758644264,446301.843312636,460186.927981007,474072.012649379,487957.09731775,501842.181986122,515727.266654493,529612.351322865,543497.435991236,557382.520659608,571267.605327979,585152.689996351,599037.774664722,612922.859333094,626807.944001465,640693.028669837,654578.113338208,668463.19800658,682348.282674951,696233.367343323,710118.452011694,724003.536680066,737888.621348437,751773.706016809,765658.79068518,779543.875353552],[97112.5385449224,110997.623213294,124882.707881665,138767.792550037,152652.877218408,166537.96188678,180423.046555151,194308.131223523,208193.215891895,222078.300560266,235963.385228638,249848.469897009,263733.554565381,277618.639233752,291503.723902124,305388.808570495,319273.893238867,333158.977907238,347044.06257561,360929.147243981,374814.231912353,388699.316580724,402584.401249096,416469.485917467,430354.570585839,444239.65525421,458124.739922582,472009.824590953,485894.909259325,499779.993927696,513665.078596068,527550.163264439,541435.247932811,555320.332601183,569205.417269554,583090.501937925,596975.586606297,610860.671274669,624745.75594304,638630.840611412,652515.925279783,666401.009948155,680286.094616526,694171.179284898,708056.263953269,721941.348621641,735826.433290012,749711.517958384,763596.602626755,777481.687295127],[95050.3504864971,108935.435154869,122820.51982324,136705.604491612,150590.689159983,164475.773828355,178360.858496726,192245.943165098,206131.027833469,220016.112501841,233901.197170212,247786.281838584,261671.366506955,275556.451175327,289441.535843698,303326.62051207,317211.705180441,331096.789848813,344981.874517184,358866.959185556,372752.043853927,386637.128522299,400522.21319067,414407.297859042,428292.382527413,442177.467195785,456062.551864157,469947.636532528,483832.7212009,497717.805869271,511602.890537643,525487.975206014,539373.059874386,553258.144542757,567143.229211129,581028.3138795,594913.398547872,608798.483216243,622683.567884615,636568.652552986,650453.737221358,664338.821889729,678223.906558101,692108.991226472,705994.075894844,719879.160563215,733764.245231587,747649.329899958,761534.41456833,775419.499236701],[92988.1624280718,106873.247096443,120758.331764815,134643.416433186,148528.501101558,162413.585769929,176298.670438301,190183.755106672,204068.839775044,217953.924443416,231839.009111787,245724.093780158,259609.17844853,273494.263116902,287379.347785273,301264.432453645,315149.517122016,329034.601790388,342919.686458759,356804.771127131,370689.855795502,384574.940463874,398460.025132245,412345.109800617,426230.194468988,440115.27913736,454000.363805731,467885.448474103,481770.533142474,495655.617810846,509540.702479217,523425.787147589,537310.87181596,551195.956484332,565081.041152703,578966.125821075,592851.210489446,606736.295157818,620621.379826189,634506.464494561,648391.549162933,662276.633831304,676161.718499676,690046.803168047,703931.887836419,717816.97250479,731702.057173162,745587.141841533,759472.226509905,773357.311178276],[90925.9743696466,104811.059038018,118696.14370639,132581.228374761,146466.313043133,160351.397711504,174236.482379876,188121.567048247,202006.651716619,215891.73638499,229776.821053362,243661.905721733,257546.990390105,271432.075058476,285317.159726848,299202.244395219,313087.329063591,326972.413731962,340857.498400334,354742.583068705,368627.667737077,382512.752405448,396397.83707382,410282.921742191,424168.006410563,438053.091078934,451938.175747306,465823.260415678,479708.345084049,493593.429752421,507478.514420792,521363.599089164,535248.683757535,549133.768425907,563018.853094278,576903.93776265,590789.022431021,604674.107099393,618559.191767764,632444.276436136,646329.361104507,660214.445772879,674099.53044125,687984.615109622,701869.699777993,715754.784446365,729639.869114736,743524.953783108,757410.038451479,771295.123119851],[88863.7863112213,102748.870979593,116633.955647964,130519.040316336,144404.124984707,158289.209653079,172174.29432145,186059.378989822,199944.463658194,213829.548326565,227714.632994937,241599.717663308,255484.80233168,269369.887000051,283254.971668423,297140.056336794,311025.141005166,324910.225673537,338795.310341909,352680.39501028,366565.479678652,380450.564347023,394335.649015395,408220.733683766,422105.818352138,435990.903020509,449875.987688881,463761.072357252,477646.157025624,491531.241693995,505416.326362367,519301.411030738,533186.49569911,547071.580367481,560956.665035853,574841.749704224,588726.834372596,602611.919040967,616497.003709339,630382.088377711,644267.173046082,658152.257714454,672037.342382825,685922.427051196,699807.511719568,713692.59638794,727577.681056311,741462.765724683,755347.850393054,769232.935061426],[86801.5982527961,100686.682921168,114571.767589539,128456.852257911,142341.936926282,156227.021594654,170112.106263025,183997.190931397,197882.275599768,211767.36026814,225652.444936511,239537.529604883,253422.614273254,267307.698941626,281192.783609997,295077.868278369,308962.95294674,322848.037615112,336733.122283483,350618.206951855,364503.291620226,378388.376288598,392273.460956969,406158.545625341,420043.630293712,433928.714962084,447813.799630456,461698.884298827,475583.968967199,489469.05363557,503354.138303942,517239.222972313,531124.307640685,545009.392309056,558894.476977428,572779.561645799,586664.646314171,600549.730982542,614434.815650914,628319.900319285,642204.984987657,656090.069656028,669975.1543244,683860.238992771,697745.323661143,711630.408329514,725515.492997886,739400.577666257,753285.662334629,767170.747003],[84739.4101943708,98624.4948627423,112509.579531114,126394.664199485,140279.748867857,154164.833536228,168049.9182046,181935.002872971,195820.087541343,209705.172209714,223590.256878086,237475.341546457,251360.426214829,265245.510883201,279130.595551572,293015.680219944,306900.764888315,320785.849556687,334670.934225058,348556.01889343,362441.103561801,376326.188230173,390211.272898544,404096.357566916,417981.442235287,431866.526903659,445751.61157203,459636.696240402,473521.780908773,487406.865577145,501291.950245516,515177.034913888,529062.119582259,542947.204250631,556832.288919002,570717.373587374,584602.458255745,598487.542924117,612372.627592488,626257.71226086,640142.796929231,654027.881597603,667912.966265974,681798.050934346,695683.135602718,709568.220271089,723453.30493946,737338.389607832,751223.474276204,765108.558944575],[82677.2221359456,96562.3068043171,110447.391472689,124332.47614106,138217.560809432,152102.645477803,165987.730146175,179872.814814546,193757.899482918,207642.984151289,221528.068819661,235413.153488032,249298.238156404,263183.322824775,277068.407493147,290953.492161518,304838.57682989,318723.661498261,332608.746166633,346493.830835004,360378.915503376,374264.000171747,388149.084840119,402034.16950849,415919.254176862,429804.338845233,443689.423513605,457574.508181977,471459.592850348,485344.67751872,499229.762187091,513114.846855463,526999.931523834,540885.016192206,554770.100860577,568655.185528949,582540.27019732,596425.354865692,610310.439534063,624195.524202435,638080.608870806,651965.693539178,665850.778207549,679735.862875921,693620.947544292,707506.032212664,721391.116881035,735276.201549407,749161.286217778,763046.37088615],[80615.0340775203,94500.1187458918,108385.203414263,122270.288082635,136155.372751006,150040.457419378,163925.542087749,177810.626756121,191695.711424492,205580.796092864,219465.880761235,233350.965429607,247236.050097978,261121.13476635,275006.219434722,288891.304103093,302776.388771465,316661.473439836,330546.558108208,344431.642776579,358316.727444951,372201.812113322,386086.896781694,399971.981450065,413857.066118437,427742.150786808,441627.23545518,455512.320123551,469397.404791923,483282.489460294,497167.574128666,511052.658797037,524937.743465409,538822.828133781,552707.912802152,566592.997470523,580478.082138895,594363.166807266,608248.251475638,622133.33614401,636018.420812381,649903.505480753,663788.590149124,677673.674817496,691558.759485867,705443.844154238,719328.92882261,733214.013490982,747099.098159353,760984.182827725],[78552.846019095,92437.9306874666,106323.015355838,120208.10002421,134093.184692581,147978.269360953,161863.354029324,175748.438697696,189633.523366067,203518.608034439,217403.69270281,231288.777371182,245173.862039553,259058.946707925,272944.031376296,286829.116044668,300714.200713039,314599.285381411,328484.370049782,342369.454718154,356254.539386525,370139.624054897,384024.708723268,397909.79339164,411794.878060011,425679.962728383,439565.047396754,453450.132065126,467335.216733498,481220.301401869,495105.386070241,508990.470738612,522875.555406984,536760.640075355,550645.724743727,564530.809412098,578415.89408047,592300.978748841,606186.063417213,620071.148085584,633956.232753956,647841.317422327,661726.402090699,675611.48675907,689496.571427442,703381.656095813,717266.740764185,731151.825432556,745036.910100928,758921.994769299],[76490.6579606698,90375.7426290413,104260.827297413,118145.911965784,132030.996634156,145916.081302527,159801.165970899,173686.25063927,187571.335307642,201456.419976013,215341.504644385,229226.589312756,243111.673981128,256996.7586495,270881.843317871,284766.927986243,298652.012654614,312537.097322986,326422.181991357,340307.266659729,354192.3513281,368077.435996472,381962.520664843,395847.605333215,409732.690001586,423617.774669958,437502.859338329,451387.944006701,465273.028675072,479158.113343444,493043.198011815,506928.282680187,520813.367348558,534698.45201693,548583.536685301,562468.621353673,576353.706022044,590238.790690416,604123.875358787,618008.960027159,631894.044695531,645779.129363902,659664.214032274,673549.298700645,687434.383369017,701319.468037388,715204.55270576,729089.637374131,742974.722042503,756859.806710874],[74428.4699022445,88313.5545706161,102198.639238988,116083.723907359,129968.808575731,143853.893244102,157738.977912474,171624.062580845,185509.147249217,199394.231917588,213279.31658596,227164.401254331,241049.485922703,254934.570591074,268819.655259446,282704.739927817,296589.824596189,310474.90926456,324359.993932932,338245.078601303,352130.163269675,366015.247938046,379900.332606418,393785.417274789,407670.501943161,421555.586611532,435440.671279904,449325.755948276,463210.840616647,477095.925285019,490981.00995339,504866.094621762,518751.179290133,532636.263958505,546521.348626876,560406.433295248,574291.517963619,588176.602631991,602061.687300362,615946.771968734,629831.856637105,643716.941305477,657602.025973848,671487.11064222,685372.195310591,699257.279978963,713142.364647334,727027.449315706,740912.533984077,754797.618652449],[72366.2818438193,86251.3665121908,100136.451180562,114021.535848934,127906.620517305,141791.705185677,155676.789854048,169561.87452242,183446.959190791,197332.043859163,211217.128527534,225102.213195906,238987.297864277,252872.382532649,266757.467201021,280642.551869392,294527.636537764,308412.721206135,322297.805874507,336182.890542878,350067.97521125,363953.059879621,377838.144547993,391723.229216364,405608.313884736,419493.398553107,433378.483221479,447263.56788985,461148.652558222,475033.737226593,488918.821894965,502803.906563336,516688.991231708,530574.075900079,544459.160568451,558344.245236822,572229.329905194,586114.414573565,599999.499241937,613884.583910309,627769.66857868,641654.753247051,655539.837915423,669424.922583794,683310.007252166,697195.091920538,711080.176588909,724965.261257281,738850.345925652,752735.430594024],[70304.093785394,84189.1784537656,98074.2631221371,111959.347790509,125844.43245888,139729.517127252,153614.601795623,167499.686463995,181384.771132366,195269.855800738,209154.940469109,223040.025137481,236925.109805852,250810.194474224,264695.279142595,278580.363810967,292465.448479338,306350.53314771,320235.617816081,334120.702484453,348005.787152824,361890.871821196,375775.956489567,389661.041157939,403546.12582631,417431.210494682,431316.295163053,445201.379831425,459086.464499797,472971.549168168,486856.63383654,500741.718504911,514626.803173283,528511.887841654,542396.972510026,556282.057178397,570167.141846769,584052.22651514,597937.311183512,611822.395851883,625707.480520255,639592.565188626,653477.649856998,667362.734525369,681247.819193741,695132.903862112,709017.988530484,722903.073198855,736788.157867227,750673.242535598],[68241.9057269688,82126.9903953403,96012.0750637118,109897.159732083,123782.244400455,137667.329068826,151552.413737198,165437.498405569,179322.583073941,193207.667742312,207092.752410684,220977.837079055,234862.921747427,248748.006415799,262633.09108417,276518.175752542,290403.260420913,304288.345089285,318173.429757656,332058.514426028,345943.599094399,359828.683762771,373713.768431142,387598.853099514,401483.937767885,415369.022436257,429254.107104628,443139.191773,457024.276441371,470909.361109743,484794.445778114,498679.530446486,512564.615114857,526449.699783229,540334.7844516,554219.869119972,568104.953788343,581990.038456715,595875.123125086,609760.207793458,623645.292461829,637530.377130201,651415.461798572,665300.546466944,679185.631135316,693070.715803687,706955.800472058,720840.88514043,734725.969808802,748611.054477173],[66179.7176685435,80064.802336915,93949.8870052866,107834.971673658,121720.05634203,135605.141010401,149490.225678773,163375.310347144,177260.395015516,191145.479683887,205030.564352259,218915.64902063,232800.733689002,246685.818357373,260570.903025745,274455.987694116,288341.072362488,302226.157030859,316111.241699231,329996.326367602,343881.411035974,357766.495704345,371651.580372717,385536.665041088,399421.74970946,413306.834377831,427191.919046203,441077.003714575,454962.088382946,468847.173051318,482732.257719689,496617.342388061,510502.427056432,524387.511724804,538272.596393175,552157.681061547,566042.765729918,579927.85039829,593812.935066661,607698.019735033,621583.104403404,635468.189071776,649353.273740147,663238.358408519,677123.44307689,691008.527745262,704893.612413633,718778.697082005,732663.781750376,746548.866418748],[64117.5296101183,78002.6142784898,91887.6989468613,105772.783615233,119657.868283604,133542.952951976,147428.037620347,161313.122288719,175198.20695709,189083.291625462,202968.376293833,216853.460962205,230738.545630576,244623.630298948,258508.71496732,272393.799635691,286278.884304063,300163.968972434,314049.053640806,327934.138309177,341819.222977549,355704.30764592,369589.392314292,383474.476982663,397359.561651035,411244.646319406,425129.730987778,439014.815656149,452899.900324521,466784.984992892,480670.069661264,494555.154329635,508440.238998007,522325.323666378,536210.40833475,550095.493003121,563980.577671493,577865.662339864,591750.747008236,605635.831676607,619520.916344979,633406.00101335,647291.085681722,661176.170350093,675061.255018465,688946.339686836,702831.424355208,716716.50902358,730601.593691951,744486.678360323],[62055.341551693,75940.4262200645,89825.510888436,103710.595556808,117595.680225179,131480.764893551,145365.849561922,159250.934230294,173136.018898665,187021.103567037,200906.188235408,214791.27290378,228676.357572151,242561.442240523,256446.526908894,270331.611577266,284216.696245637,298101.780914009,311986.86558238,325871.950250752,339757.034919123,353642.119587495,367527.204255866,381412.288924238,395297.373592609,409182.458260981,423067.542929352,436952.627597724,450837.712266096,464722.796934467,478607.881602838,492492.96627121,506378.050939582,520263.135607953,534148.220276325,548033.304944696,561918.389613068,575803.474281439,589688.558949811,603573.643618182,617458.728286554,631343.812954925,645228.897623297,659113.982291668,672999.06696004,686884.151628411,700769.236296783,714654.320965154,728539.405633526,742424.490301897],[59993.1534932677,73878.2381616393,87763.3228300108,101648.407498382,115533.492166754,129418.576835125,143303.661503497,157188.746171868,171073.83084024,184958.915508611,198844.000176983,212729.084845354,226614.169513726,240499.254182097,254384.338850469,268269.42351884,282154.508187212,296039.592855584,309924.677523955,323809.762192327,337694.846860698,351579.93152907,365465.016197441,379350.100865813,393235.185534184,407120.270202556,421005.354870927,434890.439539299,448775.52420767,462660.608876042,476545.693544413,490430.778212785,504315.862881156,518200.947549528,532086.032217899,545971.116886271,559856.201554642,573741.286223014,587626.370891385,601511.455559757,615396.540228128,629281.6248965,643166.709564871,657051.794233243,670936.878901614,684821.963569986,698707.048238357,712592.132906729,726477.2175751,740362.302243472],[57930.9654348425,71816.050103214,85701.1347715855,99586.2194399571,113471.304108329,127356.3887767,141241.473445072,155126.558113443,169011.642781815,182896.727450186,196781.812118558,210666.896786929,224551.981455301,238437.066123672,252322.150792044,266207.235460415,280092.320128787,293977.404797158,307862.48946553,321747.574133901,335632.658802273,349517.743470644,363402.828139016,377287.912807387,391172.997475759,405058.08214413,418943.166812502,432828.251480873,446713.336149245,460598.420817617,474483.505485988,488368.59015436,502253.674822731,516138.759491103,530023.844159474,543908.928827846,557794.013496217,571679.098164589,585564.18283296,599449.267501332,613334.352169703,627219.436838075,641104.521506446,654989.606174818,668874.690843189,682759.775511561,696644.860179932,710529.944848304,724415.029516675,738300.114185047],[55868.7773764172,69753.8620447888,83638.9467131603,97524.0313815318,111409.116049903,125294.200718275,139179.285386646,153064.370055018,166949.454723389,180834.539391761,194719.624060132,208604.708728504,222489.793396875,236374.878065247,250259.962733619,264145.04740199,278030.132070362,291915.216738733,305800.301407105,319685.386075476,333570.470743848,347455.555412219,361340.640080591,375225.724748962,389110.809417334,402995.894085705,416880.978754077,430766.063422448,444651.14809082,458536.232759191,472421.317427563,486306.402095934,500191.486764306,514076.571432677,527961.656101049,541846.74076942,555731.825437792,569616.910106163,583501.994774535,597387.079442906,611272.164111278,625157.248779649,639042.333448021,652927.418116392,666812.502784764,680697.587453135,694582.672121507,708467.756789878,722352.84145825,736237.926126622],[53806.589317992,67691.6739863635,81576.758654735,95461.8433231066,109346.927991478,123232.01265985,137117.097328221,151002.181996593,164887.266664964,178772.351333336,192657.436001707,206542.520670079,220427.60533845,234312.690006822,248197.774675193,262082.859343565,275967.944011936,289853.028680308,303738.113348679,317623.198017051,331508.282685422,345393.367353794,359278.452022165,373163.536690537,387048.621358908,400933.70602728,414818.790695651,428703.875364023,442588.960032395,456474.044700766,470359.129369137,484244.214037509,498129.298705881,512014.383374252,525899.468042624,539784.552710995,553669.637379367,567554.722047738,581439.80671611,595324.891384481,609209.976052853,623095.060721224,636980.145389596,650865.230057967,664750.314726339,678635.39939471,692520.484063082,706405.568731453,720290.653399825,734175.738068196],[51744.4012595667,65629.4859279383,79514.5705963098,93399.6552646813,107284.739933053,121169.824601424,135054.909269796,148939.993938167,162825.078606539,176710.16327491,190595.247943282,204480.332611653,218365.417280025,232250.501948396,246135.586616768,260020.671285139,273905.755953511,287790.840621883,301675.925290254,315561.009958626,329446.094626997,343331.179295369,357216.26396374,371101.348632112,384986.433300483,398871.517968855,412756.602637226,426641.687305598,440526.771973969,454411.856642341,468296.941310712,482182.025979084,496067.110647455,509952.195315827,523837.279984198,537722.36465257,551607.449320941,565492.533989313,579377.618657684,593262.703326056,607147.787994427,621032.872662799,634917.95733117,648803.041999542,662688.126667914,676573.211336285,690458.296004656,704343.380673028,718228.465341399,732113.550009771],[49682.2132011415,63567.297869513,77452.3825378845,91337.467206256,105222.551874628,119107.636542999,132992.721211371,146877.805879742,160762.890548114,174647.975216485,188533.059884857,202418.144553228,216303.2292216,230188.313889971,244073.398558343,257958.483226714,271843.567895086,285728.652563457,299613.737231829,313498.8219002,327383.906568572,341268.991236943,355154.075905315,369039.160573686,382924.245242058,396809.329910429,410694.414578801,424579.499247172,438464.583915544,452349.668583915,466234.753252287,480119.837920659,494004.92258903,507890.007257402,521775.091925773,535660.176594145,549545.261262516,563430.345930888,577315.430599259,591200.515267631,605085.599936002,618970.684604374,632855.769272745,646740.853941117,660625.938609488,674511.02327786,688396.107946231,702281.192614603,716166.277282974,730051.361951346],[47620.0251427162,61505.1098110878,75390.1944794593,89275.2791478308,103160.363816202,117045.448484574,130930.533152945,144815.617821317,158700.702489688,172585.78715806,186470.871826431,200355.956494803,214241.041163174,228126.125831546,242011.210499917,255896.295168289,269781.37983666,283666.464505032,297551.549173404,311436.633841775,325321.718510147,339206.803178518,353091.88784689,366976.972515261,380862.057183633,394747.141852004,408632.226520376,422517.311188747,436402.395857119,450287.48052549,464172.565193862,478057.649862233,491942.734530605,505827.819198976,519712.903867348,533597.988535719,547483.073204091,561368.157872462,575253.242540834,589138.327209205,603023.411877577,616908.496545948,630793.58121432,644678.665882691,658563.750551063,672448.835219434,686333.919887806,700219.004556178,714104.089224549,727989.173892921],[45557.8370842909,59442.9217526625,73328.006421034,87213.0910894055,101098.175757777,114983.260426149,128868.34509452,142753.429762892,156638.514431263,170523.599099635,184408.683768006,198293.768436378,212178.853104749,226063.937773121,239949.022441492,253834.107109864,267719.191778235,281604.276446607,295489.361114978,309374.44578335,323259.530451721,337144.615120093,351029.699788464,364914.784456836,378799.869125207,392684.953793579,406570.03846195,420455.123130322,434340.207798693,448225.292467065,462110.377135436,475995.461803808,489880.546472179,503765.631140551,517650.715808923,531535.800477294,545420.885145665,559305.969814037,573191.054482409,587076.13915078,600961.223819152,614846.308487523,628731.393155895,642616.477824266,656501.562492638,670386.647161009,684271.731829381,698156.816497752,712041.901166124,725926.985834495],[43495.6490258657,57380.7336942372,71265.8183626087,85150.9030309803,99035.9876993518,112921.072367723,126806.157036095,140691.241704466,154576.326372838,168461.411041209,182346.495709581,196231.580377952,210116.665046324,224001.749714695,237886.834383067,251771.919051438,265657.00371981,279542.088388182,293427.173056553,307312.257724925,321197.342393296,335082.427061668,348967.511730039,362852.596398411,376737.681066782,390622.765735154,404507.850403525,418392.935071897,432278.019740268,446163.10440864,460048.189077011,473933.273745383,487818.358413754,501703.443082126,515588.527750497,529473.612418869,543358.69708724,557243.781755612,571128.866423983,585013.951092355,598899.035760726,612784.120429098,626669.205097469,640554.289765841,654439.374434212,668324.459102584,682209.543770955,696094.628439327,709979.713107698,723864.79777607],[41433.4609674404,55318.545635812,69203.6303041835,83088.714972555,96973.7996409265,110858.884309298,124743.96897767,138629.053646041,152514.138314413,166399.222982784,180284.307651156,194169.392319527,208054.476987899,221939.56165627,235824.646324642,249709.730993013,263594.815661385,277479.900329756,291364.984998128,305250.069666499,319135.154334871,333020.239003242,346905.323671614,360790.408339985,374675.493008357,388560.577676728,402445.6623451,416330.747013471,430215.831681843,444100.916350214,457986.001018586,471871.085686958,485756.170355329,499641.255023701,513526.339692072,527411.424360443,541296.509028815,555181.593697187,569066.678365558,582951.76303393,596836.847702301,610721.932370673,624607.017039044,638492.101707416,652377.186375787,666262.271044159,680147.35571253,694032.440380902,707917.525049273,721802.609717645],[39371.2729090152,53256.3575773867,67141.4422457582,81026.5269141298,94911.6115825013,108796.696250873,122681.780919244,136566.865587616,150451.950255987,164337.034924359,178222.11959273,192107.204261102,205992.288929473,219877.373597845,233762.458266216,247647.542934588,261532.627602959,275417.712271331,289302.796939702,303187.881608074,317072.966276446,330958.050944817,344843.135613189,358728.22028156,372613.304949932,386498.389618303,400383.474286675,414268.558955046,428153.643623418,442038.728291789,455923.812960161,469808.897628532,483693.982296904,497579.066965275,511464.151633647,525349.236302018,539234.32097039,553119.405638761,567004.490307133,580889.574975504,594774.659643876,608659.744312247,622544.828980619,636429.91364899,650314.998317362,664200.082985733,678085.167654105,691970.252322476,705855.336990848,719740.42165922],[37309.0848505899,51194.1695189615,65079.254187333,78964.3388557045,92849.423524076,106734.508192448,120619.592860819,134504.677529191,148389.762197562,162274.846865934,176159.931534305,190045.016202677,203930.100871048,217815.18553942,231700.270207791,245585.354876163,259470.439544534,273355.524212906,287240.608881277,301125.693549649,315010.77821802,328895.862886392,342780.947554763,356666.032223135,370551.116891506,384436.201559878,398321.286228249,412206.370896621,426091.455564992,439976.540233364,453861.624901735,467746.709570107,481631.794238478,495516.87890685,509401.963575222,523287.048243593,537172.132911965,551057.217580336,564942.302248708,578827.386917079,592712.471585451,606597.556253822,620482.640922194,634367.725590565,648252.810258937,662137.894927308,676022.97959568,689908.064264051,703793.148932423,717678.233600794],[35246.8967921647,49131.9814605362,63017.0661289077,76902.1507972792,90787.2354656508,104672.320134022,118557.404802394,132442.489470765,146327.574139137,160212.658807508,174097.74347588,187982.828144251,201867.912812623,215752.997480994,229638.082149366,243523.166817737,257408.251486109,271293.33615448,285178.420822852,299063.505491223,312948.590159595,326833.674827966,340718.759496338,354603.84416471,368488.928833081,382374.013501453,396259.098169824,410144.182838196,424029.267506567,437914.352174939,451799.43684331,465684.521511682,479569.606180053,493454.690848425,507339.775516796,521224.860185168,535109.944853539,548995.029521911,562880.114190282,576765.198858654,590650.283527025,604535.368195397,618420.452863768,632305.53753214,646190.622200511,660075.706868883,673960.791537254,687845.876205626,701730.960873997,715616.045542369],[33184.7087337394,47069.793402111,60954.8780704825,74839.962738854,88725.0474072255,102610.132075597,116495.216743969,130380.30141234,144265.386080712,158150.470749083,172035.555417455,185920.640085826,199805.724754198,213690.809422569,227575.894090941,241460.978759312,255346.063427684,269231.148096055,283116.232764427,297001.317432798,310886.40210117,324771.486769541,338656.571437913,352541.656106284,366426.740774656,380311.825443027,394196.910111399,408081.99477977,421967.079448142,435852.164116513,449737.248784885,463622.333453257,477507.418121628,491392.50279,505277.587458371,519162.672126743,533047.756795114,546932.841463486,560817.926131857,574703.010800229,588588.0954686,602473.180136972,616358.264805343,630243.349473715,644128.434142086,658013.518810458,671898.603478829,685783.688147201,699668.772815572,713553.857483944],[31122.5206753142,45007.6053436857,58892.6900120572,72777.7746804287,86662.8593488003,100547.944017172,114433.028685543,128318.113353915,142203.198022286,156088.282690658,169973.367359029,183858.452027401,197743.536695772,211628.621364144,225513.706032515,239398.790700887,253283.875369258,267168.96003763,281054.044706001,294939.129374373,308824.214042745,322709.298711116,336594.383379488,350479.468047859,364364.552716231,378249.637384602,392134.722052974,406019.806721345,419904.891389717,433789.976058088,447675.06072646,461560.145394831,475445.230063203,489330.314731574,503215.399399946,517100.484068317,530985.568736689,544870.65340506,558755.738073432,572640.822741803,586525.907410175,600410.992078546,614296.076746918,628181.161415289,642066.246083661,655951.330752032,669836.415420404,683721.500088775,697606.584757147,711491.669425518],[29060.3326168889,42945.4172852604,56830.5019536319,70715.5866220035,84600.671290375,98485.7559587465,112370.840627118,126255.92529549,140141.009963861,154026.094632233,167911.179300604,181796.263968976,195681.348637347,209566.433305719,223451.51797409,237336.602642462,251221.687310833,265106.771979205,278991.856647576,292876.941315948,306762.025984319,320647.110652691,334532.195321062,348417.279989434,362302.364657805,376187.449326177,390072.533994548,403957.61866292,417842.703331291,431727.787999663,445612.872668034,459497.957336406,473383.042004777,487268.126673149,501153.211341521,515038.296009892,528923.380678263,542808.465346635,556693.550015007,570578.634683378,584463.71935175,598348.804020121,612233.888688493,626118.973356864,640004.058025236,653889.142693607,667774.227361979,681659.31203035,695544.396698722,709429.481367093],[26998.1445584636,40883.2292268352,54768.3138952067,68653.3985635782,82538.4832319497,96423.5679003213,110308.652568693,124193.737237064,138078.821905436,151963.906573807,165848.991242179,179734.07591055,193619.160578922,207504.245247293,221389.329915665,235274.414584036,249159.499252408,263044.583920779,276929.668589151,290814.753257522,304699.837925894,318584.922594265,332470.007262637,346355.091931009,360240.17659938,374125.261267752,388010.345936123,401895.430604495,415780.515272866,429665.599941238,443550.684609609,457435.769277981,471320.853946352,485205.938614724,499091.023283095,512976.107951467,526861.192619838,540746.27728821,554631.361956581,568516.446624953,582401.531293324,596286.615961696,610171.700630067,624056.785298439,637941.86996681,651826.954635182,665712.039303553,679597.123971925,693482.208640296,707367.293308668],[24935.9565000384,38821.0411684099,52706.1258367814,66591.210505153,80476.2951735245,94361.379841896,108246.464510268,122131.549178639,136016.633847011,149901.718515382,163786.803183754,177671.887852125,191556.972520497,205442.057188868,219327.14185724,233212.226525611,247097.311193983,260982.395862354,274867.480530726,288752.565199097,302637.649867469,316522.73453584,330407.819204212,344292.903872583,358177.988540955,372063.073209326,385948.157877698,399833.242546069,413718.327214441,427603.411882812,441488.496551184,455373.581219555,469258.665887927,483143.750556299,497028.83522467,510913.919893041,524799.004561413,538684.089229785,552569.173898156,566454.258566528,580339.343234899,594224.427903271,608109.512571642,621994.597240014,635879.681908385,649764.766576757,663649.851245128,677534.9359135,691420.020581871,705305.105250243],[22873.7684416131,36758.8531099847,50643.9377783562,64529.0224467277,78414.1071150992,92299.1917834708,106184.276451842,120069.361120214,133954.445788585,147839.530456957,161724.615125328,175609.6997937,189494.784462071,203379.869130443,217264.953798814,231150.038467186,245035.123135557,258920.207803929,272805.2924723,286690.377140672,300575.461809043,314460.546477415,328345.631145786,342230.715814158,356115.80048253,370000.885150901,383885.969819273,397771.054487644,411656.139156016,425541.223824387,439426.308492759,453311.39316113,467196.477829502,481081.562497873,494966.647166245,508851.731834616,522736.816502988,536621.901171359,550506.985839731,564392.070508102,578277.155176474,592162.239844845,606047.324513217,619932.409181588,633817.49384996,647702.578518331,661587.663186703,675472.747855074,689357.832523446,703242.917191818],[20811.5803831879,34696.6650515594,48581.7497199309,62466.8343883024,76351.919056674,90237.0037250455,104122.088393417,118007.173061789,131892.25773016,145777.342398532,159662.427066903,173547.511735275,187432.596403646,201317.681072018,215202.765740389,229087.850408761,242972.935077132,256858.019745504,270743.104413875,284628.189082247,298513.273750618,312398.35841899,326283.443087361,340168.527755733,354053.612424104,367938.697092476,381823.781760847,395708.866429219,409593.95109759,423479.035765962,437364.120434333,451249.205102705,465134.289771076,479019.374439448,492904.459107819,506789.543776191,520674.628444562,534559.713112934,548444.797781306,562329.882449677,576214.967118049,590100.05178642,603985.136454792,617870.221123163,631755.305791535,645640.390459906,659525.475128278,673410.559796649,687295.644465021,701180.729133392],[18749.3923247626,32634.4769931342,46519.5616615057,60404.6463298772,74289.7309982487,88174.8156666202,102059.900334992,115944.985003363,129830.069671735,143715.154340106,157600.239008478,171485.323676849,185370.408345221,199255.493013592,213140.577681964,227025.662350335,240910.747018707,254795.831687078,268680.91635545,282566.001023821,296451.085692193,310336.170360564,324221.255028936,338106.339697307,351991.424365679,365876.509034051,379761.593702422,393646.678370794,407531.763039165,421416.847707537,435301.932375908,449187.01704428,463072.101712651,476957.186381023,490842.271049394,504727.355717766,518612.440386137,532497.525054509,546382.60972288,560267.694391252,574152.779059623,588037.863727995,601922.948396366,615808.033064738,629693.117733109,643578.202401481,657463.287069852,671348.371738224,685233.456406595,699118.541074967],[16687.2042663374,30572.2889347089,44457.3736030804,58342.4582714519,72227.5429398234,86112.627608195,99997.7122765665,113882.796944938,127767.88161331,141652.966281681,155538.050950053,169423.135618424,183308.220286796,197193.304955167,211078.389623539,224963.47429191,238848.558960282,252733.643628653,266618.728297025,280503.812965396,294388.897633768,308273.982302139,322159.066970511,336044.151638882,349929.236307254,363814.320975625,377699.405643997,391584.490312368,405469.57498074,419354.659649111,433239.744317483,447124.828985854,461009.913654226,474894.998322597,488780.082990969,502665.16765934,516550.252327712,530435.336996083,544320.421664455,558205.506332827,572090.591001198,585975.67566957,599860.760337941,613745.845006312,627630.929674684,641516.014343056,655401.099011427,669286.183679799,683171.26834817,697056.353016542],[14625.0162079121,28510.1008762836,42395.1855446551,56280.2702130267,70165.3548813982,84050.4395497697,97935.5242181412,111820.608886513,125705.693554884,139590.778223256,153475.862891627,167360.947559999,181246.03222837,195131.116896742,209016.201565113,222901.286233485,236786.370901856,250671.455570228,264556.540238599,278441.624906971,292326.709575342,306211.794243714,320096.878912085,333981.963580457,347867.048248829,361752.1329172,375637.217585572,389522.302253943,403407.386922315,417292.471590686,431177.556259058,445062.640927429,458947.725595801,472832.810264172,486717.894932544,500602.979600915,514488.064269287,528373.148937658,542258.23360603,556143.318274401,570028.402942773,583913.487611144,597798.572279516,611683.656947887,625568.741616259,639453.82628463,653338.910953002,667223.995621373,681109.080289745,694994.164958116],[12562.8281494868,26447.9128178584,40332.9974862299,54218.0821546014,68103.1668229729,81988.2514913445,95873.336159716,109758.420828088,123643.505496459,137528.590164831,151413.674833202,165298.759501574,179183.844169945,193068.928838317,206954.013506688,220839.09817506,234724.182843431,248609.267511803,262494.352180174,276379.436848546,290264.521516917,304149.606185289,318034.69085366,331919.775522032,345804.860190403,359689.944858775,373575.029527146,387460.114195518,401345.198863889,415230.283532261,429115.368200632,443000.452869004,456885.537537375,470770.622205747,484655.706874118,498540.79154249,512425.876210861,526310.960879233,540196.045547604,554081.130215976,567966.214884348,581851.299552719,595736.38422109,609621.468889462,623506.553557834,637391.638226205,651276.722894576,665161.807562948,679046.89223132,692931.976899691],[10500.6400910616,24385.7247594331,38270.8094278046,52155.8940961762,66040.9787645477,79926.0634329192,93811.1481012907,107696.232769662,121581.317438034,135466.402106405,149351.486774777,163236.571443148,177121.65611152,191006.740779891,204891.825448263,218776.910116634,232661.994785006,246547.079453377,260432.164121749,274317.24879012,288202.333458492,302087.418126863,315972.502795235,329857.587463606,343742.672131978,357627.75680035,371512.841468721,385397.926137093,399283.010805464,413168.095473836,427053.180142207,440938.264810579,454823.34947895,468708.434147322,482593.518815693,496478.603484065,510363.688152436,524248.772820808,538133.857489179,552018.942157551,565904.026825922,579789.111494294,593674.196162665,607559.280831037,621444.365499408,635329.45016778,649214.534836151,663099.619504523,676984.704172894,690869.788841266],[8438.45203263634,22323.5367010079,36208.6213693794,50093.7060377509,63978.7907061224,77863.875374494,91748.9600428655,105634.044711237,119519.129379609,133404.21404798,147289.298716352,161174.383384723,175059.468053095,188944.552721466,202829.637389838,216714.722058209,230599.806726581,244484.891394952,258369.976063324,272255.060731695,286140.145400067,300025.230068438,313910.31473681,327795.399405181,341680.484073553,355565.568741924,369450.653410296,383335.738078667,397220.822747039,411105.90741541,424990.992083782,438876.076752153,452761.161420525,466646.246088896,480531.330757268,494416.415425639,508301.500094011,522186.584762382,536071.669430754,549956.754099126,563841.838767497,577726.923435869,591612.00810424,605497.092772612,619382.177440983,633267.262109355,647152.346777726,661037.431446098,674922.516114469,688807.600782841],[6376.26397421109,20261.3486425826,34146.4333109541,48031.5179793257,61916.6026476972,75801.6873160687,89686.7719844402,103571.856652812,117456.941321183,131342.025989555,145227.110657926,159112.195326298,172997.279994669,186882.364663041,200767.449331412,214652.533999784,228537.618668155,242422.703336527,256307.788004898,270192.87267327,284077.957341641,297963.042010013,311848.126678384,325733.211346756,339618.296015127,353503.380683499,367388.465351871,381273.550020242,395158.634688614,409043.719356985,422928.804025357,436813.888693728,450698.9733621,464584.058030471,478469.142698843,492354.227367214,506239.312035586,520124.396703957,534009.481372329,547894.5660407,561779.650709072,575664.735377443,589549.820045815,603434.904714186,617319.989382558,631205.074050929,645090.158719301,658975.243387672,672860.328056044,686745.412724415]],"type":"surface","x":[484,573.673469387755,663.34693877551,753.020408163265,842.69387755102,932.367346938776,1022.04081632653,1111.71428571429,1201.38775510204,1291.0612244898,1380.73469387755,1470.40816326531,1560.08163265306,1649.75510204082,1739.42857142857,1829.10204081633,1918.77551020408,2008.44897959184,2098.12244897959,2187.79591836735,2277.4693877551,2367.14285714286,2456.81632653061,2546.48979591837,2636.16326530612,2725.83673469388,2815.51020408163,2905.18367346939,2994.85714285714,3084.5306122449,3174.20408163265,3263.87755102041,3353.55102040816,3443.22448979592,3532.89795918367,3622.57142857143,3712.24489795918,3801.91836734694,3891.59183673469,3981.26530612245,4070.9387755102,4160.61224489796,4250.28571428571,4339.95918367347,4429.63265306122,4519.30612244898,4608.97959183673,4698.65306122449,4788.32653061224,4878],"y":[1,1.10204081632653,1.20408163265306,1.30612244897959,1.40816326530612,1.51020408163265,1.61224489795918,1.71428571428571,1.81632653061224,1.91836734693878,2.02040816326531,2.12244897959184,2.22448979591837,2.3265306122449,2.42857142857143,2.53061224489796,2.63265306122449,2.73469387755102,2.83673469387755,2.93877551020408,3.04081632653061,3.14285714285714,3.24489795918367,3.3469387755102,3.44897959183673,3.55102040816327,3.6530612244898,3.75510204081633,3.85714285714286,3.95918367346939,4.06122448979592,4.16326530612245,4.26530612244898,4.36734693877551,4.46938775510204,4.57142857142857,4.6734693877551,4.77551020408163,4.87755102040816,4.97959183673469,5.08163265306122,5.18367346938776,5.28571428571429,5.38775510204082,5.48979591836735,5.59183673469388,5.69387755102041,5.79591836734694,5.89795918367347,6],"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
We see that the predictions from linear regression with two predictors form a
flat plane. This is the hallmark of linear regression, and differs from the
wiggly, flexible surface we get from other methods such as K-NN regression.
As discussed this can be advantageous in one aspect, which is that for each
predictor, we can get slopes/intercept from linear regression, and thus describe the
plane mathematically. We can extract those slope values from our model object
as shown below:</p>
<pre><code>## # A tibble: 3 x 5
##   term        estimate std.error statistic  p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)   52690.  13745.        3.83 1.41e- 4
## 2 sqft            155.      6.72     23.0  4.46e-83
## 3 beds         -20209.   5734.       -3.52 4.59e- 4</code></pre>
<p>And then use those slopes to write a mathematical equation to describe the prediction plane:</p>
<p><span class="math display">\[\text{house price} = \beta_0 + \beta_1\cdot(\text{house size}) + \beta_2\cdot(\text{number of bedrooms}),\]</span>
where:</p>
<ul>
<li><span class="math inline">\(\beta_0\)</span> is the vertical intercept of the hyperplane (the value where it cuts the vertical axis)</li>
<li><span class="math inline">\(\beta_1\)</span> is the slope for the first predictor (house size)</li>
<li><span class="math inline">\(\beta_2\)</span> is the slope for the second predictor (number of bedrooms)</li>
</ul>
<p>Finally, we can fill in the values for <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span> from the model output above
to create the equation of the plane of best fit to the data:</p>
<p><span class="math display">\[\text{house price} = 52690 + 155\cdot (\text{house size})  -20209 \cdot (\text{number of bedrooms})\]</span></p>
<p>This model is more interpretable than the multivariate K-NN
regression model; we can write a mathematical equation that explains how
each predictor is affecting the predictions. But as always, we should look at
the test error and ask whether linear regression is doing a better job of
predicting compared to K-NN regression in this multivariate regression case. To
do that we can use this linear regression model to predict on the test data to
get our test error.</p>
<pre><code>## # A tibble: 3 x 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 rmse    standard   82835.   
## 2 rsq     standard       0.596
## 3 mae     standard   61008.</code></pre>
<p>We get that the RMSPE for the multivariate linear regression model
of 82835.42. This prediction error
is less than the prediction error for the multivariate K-NN regression model,
indicating that we should likely choose linear regression for predictions of
house price on this data set. But we should also ask if this more complex
model is doing a better job of predicting compared to our simple linear
regression model with only a single predictor (house size). Revisiting last
section, we see that our RMSPE for our simple linear regression model with
only a single predictor was
85160.85,
which is slightly more than that of our more complex model. Our model with two predictors
provided a slightly better fit on test data than our model with just one.</p>
<p>But should we always end up choosing a model with more predictors than fewer?
The answer is no; you never know what model will be the best until you go through the
process of comparing their performance on held-out test data. Exploratory
data analysis can give you some hints, but until you look
at the prediction errors to compare the models you don’t really know.
Additionally, here we compare test errors purely for the purposes of teaching.
In practice, when you want to compare several regression models with
differing numbers of predictor variables, you should use
cross-validation on the training set only; in this case choosing the model is part
of tuning, so you cannot use the test data. There are several well known and more advanced
methods to do this that are beyond the scope of this course, and they include
backward or forward selection, and L1 or L2 regularization (also known as Lasso
and ridge regression, respectively).</p>
</div>
<div id="the-other-side-of-regression" class="section level2">
<h2><span class="header-section-number">9.7</span> The other side of regression</h2>
<p>So far in this textbook we have used regression only in the context of
prediction. However, regression is also a powerful method to understand and/or
describe the relationship between a quantitative response variable and
one or more explanatory variables. Extending the case we have been working with
in this chapter (where we are interested in house price as the outcome/response
variable), we might also be interested in describing the
individual effects of house size and the number of bedrooms on house price,
quantifying how big each of these effects are, and assessing how accurately we
can estimate each of these effects. This side of regression is the topic of
many follow-on statistics courses and beyond the scope of this course.</p>
</div>
<div id="additional-resources-3" class="section level2">
<h2><span class="header-section-number">9.8</span> Additional resources</h2>
<ul>
<li>Pages 59-71 of <a href="http://www-bcf.usc.edu/~gareth/ISL/ISLR%20Seventh%20Printing.pdf">Introduction to Statistical Learning</a> with Applications in R by Gareth James, Daniela Witten, Trevor Hastie and Robert Tibshirani</li>
<li>Pages 104 - 109 of <a href="https://www-bcf.usc.edu/~gareth/ISL/ISLR%20Seventh%20Printing.pdf">An Introduction to Statistical Learning with Applications in R</a> by Gareth James, Daniela Witten, Trevor Hastie and Robert Tibshirani</li>
<li><a href="https://topepo.github.io/caret/index.html">The <code>caret</code> Package</a></li>
<li>Chapters 6 - 11 of <a href="https://moderndive.com/">Modern Dive</a> Statistical Inference via Data Science by Chester Ismay and Albert Y. Kim</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="regression1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="clustering.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/08-regression2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
