<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Cleaning and wrangling data |  Data Science</title>
  <meta name="description" content="This is a textbook for teaching a first introduction to data science." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Cleaning and wrangling data |  Data Science" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a textbook for teaching a first introduction to data science." />
  <meta name="github-repo" content="UBC-DSCI/introduction-to-datascience" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Cleaning and wrangling data |  Data Science" />
  
  <meta name="twitter:description" content="This is a textbook for teaching a first introduction to data science." />
  

<meta name="author" content="Tiffany Timbers, Trevor Campbell, and Melissa Lee" />


<meta name="date" content="2025-03-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="reading.html"/>
<link rel="next" href="viz.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.2/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-JJ9MD0LBF5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-JJ9MD0LBF5');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="source/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://datasciencebook.ca">Data Science: A First Introduction</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a></li>
<li class="chapter" data-level="" data-path="foreword.html"><a href="foreword.html"><i class="fa fa-check"></i>Foreword</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="acknowledgments.html"><a href="acknowledgments.html"><i class="fa fa-check"></i>Acknowledgments</a></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html"><i class="fa fa-check"></i>About the authors</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> R and the Tidyverse</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#overview"><i class="fa fa-check"></i><b>1.1</b> Overview</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#chapter-learning-objectives"><i class="fa fa-check"></i><b>1.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#canadian-languages-data-set"><i class="fa fa-check"></i><b>1.3</b> Canadian languages data set</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#asking-a-question"><i class="fa fa-check"></i><b>1.4</b> Asking a question</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#loading-a-tabular-data-set"><i class="fa fa-check"></i><b>1.5</b> Loading a tabular data set</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#naming-things-in-r"><i class="fa fa-check"></i><b>1.6</b> Naming things in R</a></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#creating-subsets-of-data-frames-with-filter-select"><i class="fa fa-check"></i><b>1.7</b> Creating subsets of data frames with <code>filter</code> &amp; <code>select</code></a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="intro.html"><a href="intro.html#using-filter-to-extract-rows"><i class="fa fa-check"></i><b>1.7.1</b> Using <code>filter</code> to extract rows</a></li>
<li class="chapter" data-level="1.7.2" data-path="intro.html"><a href="intro.html#using-select-to-extract-columns"><i class="fa fa-check"></i><b>1.7.2</b> Using <code>select</code> to extract columns</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="intro.html"><a href="intro.html#arrangesliceintro"><i class="fa fa-check"></i><b>1.8</b> Using <code>arrange</code> to order and <code>slice</code> to select rows by index number</a></li>
<li class="chapter" data-level="1.9" data-path="intro.html"><a href="intro.html#adding-and-modifying-columns-using-mutate"><i class="fa fa-check"></i><b>1.9</b> Adding and modifying columns using <code>mutate</code></a></li>
<li class="chapter" data-level="1.10" data-path="intro.html"><a href="intro.html#exploring-data-with-visualizations"><i class="fa fa-check"></i><b>1.10</b> Exploring data with visualizations</a>
<ul>
<li class="chapter" data-level="1.10.1" data-path="intro.html"><a href="intro.html#using-ggplot-to-create-a-bar-plot"><i class="fa fa-check"></i><b>1.10.1</b> Using <code>ggplot</code> to create a bar plot</a></li>
<li class="chapter" data-level="1.10.2" data-path="intro.html"><a href="intro.html#formatting-ggplot-objects"><i class="fa fa-check"></i><b>1.10.2</b> Formatting ggplot objects</a></li>
<li class="chapter" data-level="1.10.3" data-path="intro.html"><a href="intro.html#putting-it-all-together"><i class="fa fa-check"></i><b>1.10.3</b> Putting it all together</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="intro.html"><a href="intro.html#accessing-documentation"><i class="fa fa-check"></i><b>1.11</b> Accessing documentation</a></li>
<li class="chapter" data-level="1.12" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>1.12</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reading.html"><a href="reading.html"><i class="fa fa-check"></i><b>2</b> Reading in data locally and from the web</a>
<ul>
<li class="chapter" data-level="2.1" data-path="reading.html"><a href="reading.html#overview-1"><i class="fa fa-check"></i><b>2.1</b> Overview</a></li>
<li class="chapter" data-level="2.2" data-path="reading.html"><a href="reading.html#chapter-learning-objectives-1"><i class="fa fa-check"></i><b>2.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="2.3" data-path="reading.html"><a href="reading.html#absolute-and-relative-file-paths"><i class="fa fa-check"></i><b>2.3</b> Absolute and relative file paths</a></li>
<li class="chapter" data-level="2.4" data-path="reading.html"><a href="reading.html#reading-tabular-data-from-a-plain-text-file-into-r"><i class="fa fa-check"></i><b>2.4</b> Reading tabular data from a plain text file into R</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="reading.html"><a href="reading.html#readcsv"><i class="fa fa-check"></i><b>2.4.1</b> <code>read_csv</code> to read in comma-separated values files</a></li>
<li class="chapter" data-level="2.4.2" data-path="reading.html"><a href="reading.html#skipping-rows-when-reading-in-data"><i class="fa fa-check"></i><b>2.4.2</b> Skipping rows when reading in data</a></li>
<li class="chapter" data-level="2.4.3" data-path="reading.html"><a href="reading.html#read_tsv-to-read-in-tab-separated-values-files"><i class="fa fa-check"></i><b>2.4.3</b> <code>read_tsv</code> to read in tab-separated values files</a></li>
<li class="chapter" data-level="2.4.4" data-path="reading.html"><a href="reading.html#read_delim-as-a-more-flexible-method-to-get-tabular-data-into-r"><i class="fa fa-check"></i><b>2.4.4</b> <code>read_delim</code> as a more flexible method to get tabular data into R</a></li>
<li class="chapter" data-level="2.4.5" data-path="reading.html"><a href="reading.html#reading-tabular-data-directly-from-a-url"><i class="fa fa-check"></i><b>2.4.5</b> Reading tabular data directly from a URL</a></li>
<li class="chapter" data-level="2.4.6" data-path="reading.html"><a href="reading.html#downloading-data-from-a-url"><i class="fa fa-check"></i><b>2.4.6</b> Downloading data from a URL</a></li>
<li class="chapter" data-level="2.4.7" data-path="reading.html"><a href="reading.html#previewing-a-data-file-before-reading-it-into-r"><i class="fa fa-check"></i><b>2.4.7</b> Previewing a data file before reading it into R</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="reading.html"><a href="reading.html#reading-tabular-data-from-a-microsoft-excel-file"><i class="fa fa-check"></i><b>2.5</b> Reading tabular data from a Microsoft Excel file</a></li>
<li class="chapter" data-level="2.6" data-path="reading.html"><a href="reading.html#reading-data-from-a-database"><i class="fa fa-check"></i><b>2.6</b> Reading data from a database</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="reading.html"><a href="reading.html#reading-data-from-a-sqlite-database"><i class="fa fa-check"></i><b>2.6.1</b> Reading data from a SQLite database</a></li>
<li class="chapter" data-level="2.6.2" data-path="reading.html"><a href="reading.html#reading-data-from-a-postgresql-database"><i class="fa fa-check"></i><b>2.6.2</b> Reading data from a PostgreSQL database</a></li>
<li class="chapter" data-level="2.6.3" data-path="reading.html"><a href="reading.html#why-should-we-bother-with-databases-at-all"><i class="fa fa-check"></i><b>2.6.3</b> Why should we bother with databases at all?</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="reading.html"><a href="reading.html#writing-data-from-r-to-a-.csv-file"><i class="fa fa-check"></i><b>2.7</b> Writing data from R to a <code>.csv</code> file</a></li>
<li class="chapter" data-level="2.8" data-path="reading.html"><a href="reading.html#obtaining-data-from-the-web"><i class="fa fa-check"></i><b>2.8</b> Obtaining data from the web</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="reading.html"><a href="reading.html#web-scraping"><i class="fa fa-check"></i><b>2.8.1</b> Web scraping</a></li>
<li class="chapter" data-level="2.8.2" data-path="reading.html"><a href="reading.html#using-an-api"><i class="fa fa-check"></i><b>2.8.2</b> Using an API</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="reading.html"><a href="reading.html#exercises-1"><i class="fa fa-check"></i><b>2.9</b> Exercises</a></li>
<li class="chapter" data-level="2.10" data-path="reading.html"><a href="reading.html#additional-resources"><i class="fa fa-check"></i><b>2.10</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="wrangling.html"><a href="wrangling.html"><i class="fa fa-check"></i><b>3</b> Cleaning and wrangling data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="wrangling.html"><a href="wrangling.html#overview-2"><i class="fa fa-check"></i><b>3.1</b> Overview</a></li>
<li class="chapter" data-level="3.2" data-path="wrangling.html"><a href="wrangling.html#chapter-learning-objectives-2"><i class="fa fa-check"></i><b>3.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="3.3" data-path="wrangling.html"><a href="wrangling.html#data-frames-vectors-and-lists"><i class="fa fa-check"></i><b>3.3</b> Data frames, vectors, and lists</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="wrangling.html"><a href="wrangling.html#what-is-a-data-frame"><i class="fa fa-check"></i><b>3.3.1</b> What is a data frame?</a></li>
<li class="chapter" data-level="3.3.2" data-path="wrangling.html"><a href="wrangling.html#what-is-a-vector"><i class="fa fa-check"></i><b>3.3.2</b> What is a vector?</a></li>
<li class="chapter" data-level="3.3.3" data-path="wrangling.html"><a href="wrangling.html#what-is-a-list"><i class="fa fa-check"></i><b>3.3.3</b> What is a list?</a></li>
<li class="chapter" data-level="3.3.4" data-path="wrangling.html"><a href="wrangling.html#what-does-this-have-to-do-with-data-frames"><i class="fa fa-check"></i><b>3.3.4</b> What does this have to do with data frames?</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="wrangling.html"><a href="wrangling.html#tidy-data"><i class="fa fa-check"></i><b>3.4</b> Tidy data</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="wrangling.html"><a href="wrangling.html#tidying-up-going-from-wide-to-long-using-pivot_longer"><i class="fa fa-check"></i><b>3.4.1</b> Tidying up: going from wide to long using <code>pivot_longer</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="wrangling.html"><a href="wrangling.html#pivot-wider"><i class="fa fa-check"></i><b>3.4.2</b> Tidying up: going from long to wide using <code>pivot_wider</code></a></li>
<li class="chapter" data-level="3.4.3" data-path="wrangling.html"><a href="wrangling.html#separate"><i class="fa fa-check"></i><b>3.4.3</b> Tidying up: using <code>separate</code> to deal with multiple delimiters</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="wrangling.html"><a href="wrangling.html#using-select-to-extract-a-range-of-columns"><i class="fa fa-check"></i><b>3.5</b> Using <code>select</code> to extract a range of columns</a></li>
<li class="chapter" data-level="3.6" data-path="wrangling.html"><a href="wrangling.html#using-filter-to-extract-rows-1"><i class="fa fa-check"></i><b>3.6</b> Using <code>filter</code> to extract rows</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="wrangling.html"><a href="wrangling.html#extracting-rows-that-have-a-certain-value-with"><i class="fa fa-check"></i><b>3.6.1</b> Extracting rows that have a certain value with <code>==</code></a></li>
<li class="chapter" data-level="3.6.2" data-path="wrangling.html"><a href="wrangling.html#extracting-rows-that-do-not-have-a-certain-value-with"><i class="fa fa-check"></i><b>3.6.2</b> Extracting rows that do not have a certain value with <code>!=</code></a></li>
<li class="chapter" data-level="3.6.3" data-path="wrangling.html"><a href="wrangling.html#filter-and"><i class="fa fa-check"></i><b>3.6.3</b> Extracting rows satisfying multiple conditions using <code>,</code> or <code>&amp;</code></a></li>
<li class="chapter" data-level="3.6.4" data-path="wrangling.html"><a href="wrangling.html#extracting-rows-satisfying-at-least-one-condition-using"><i class="fa fa-check"></i><b>3.6.4</b> Extracting rows satisfying at least one condition using <code>|</code></a></li>
<li class="chapter" data-level="3.6.5" data-path="wrangling.html"><a href="wrangling.html#extracting-rows-with-values-in-a-vector-using-in"><i class="fa fa-check"></i><b>3.6.5</b> Extracting rows with values in a vector using <code>%in%</code></a></li>
<li class="chapter" data-level="3.6.6" data-path="wrangling.html"><a href="wrangling.html#extracting-rows-above-or-below-a-threshold-using-and"><i class="fa fa-check"></i><b>3.6.6</b> Extracting rows above or below a threshold using <code>&gt;</code> and <code>&lt;</code></a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="wrangling.html"><a href="wrangling.html#using-mutate-to-modify-or-add-columns"><i class="fa fa-check"></i><b>3.7</b> Using <code>mutate</code> to modify or add columns</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="wrangling.html"><a href="wrangling.html#using-mutate-to-modify-columns"><i class="fa fa-check"></i><b>3.7.1</b> Using <code>mutate</code> to modify columns</a></li>
<li class="chapter" data-level="3.7.2" data-path="wrangling.html"><a href="wrangling.html#using-mutate-to-create-new-columns"><i class="fa fa-check"></i><b>3.7.2</b> Using <code>mutate</code> to create new columns</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="wrangling.html"><a href="wrangling.html#combining-functions-using-the-pipe-operator"><i class="fa fa-check"></i><b>3.8</b> Combining functions using the pipe operator, <code>|&gt;</code></a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="wrangling.html"><a href="wrangling.html#using-to-combine-filter-and-select"><i class="fa fa-check"></i><b>3.8.1</b> Using <code>|&gt;</code> to combine <code>filter</code> and <code>select</code></a></li>
<li class="chapter" data-level="3.8.2" data-path="wrangling.html"><a href="wrangling.html#using-with-more-than-two-functions"><i class="fa fa-check"></i><b>3.8.2</b> Using <code>|&gt;</code> with more than two functions</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="wrangling.html"><a href="wrangling.html#aggregating-data-with-summarize-and-map"><i class="fa fa-check"></i><b>3.9</b> Aggregating data with <code>summarize</code> and <code>map</code></a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="wrangling.html"><a href="wrangling.html#calculating-summary-statistics-on-whole-columns"><i class="fa fa-check"></i><b>3.9.1</b> Calculating summary statistics on whole columns</a></li>
<li class="chapter" data-level="3.9.2" data-path="wrangling.html"><a href="wrangling.html#calculating-summary-statistics-when-there-are-nas"><i class="fa fa-check"></i><b>3.9.2</b> Calculating summary statistics when there are <code>NA</code>s</a></li>
<li class="chapter" data-level="3.9.3" data-path="wrangling.html"><a href="wrangling.html#calculating-summary-statistics-for-groups-of-rows"><i class="fa fa-check"></i><b>3.9.3</b> Calculating summary statistics for groups of rows</a></li>
<li class="chapter" data-level="3.9.4" data-path="wrangling.html"><a href="wrangling.html#calculating-summary-statistics-on-many-columns"><i class="fa fa-check"></i><b>3.9.4</b> Calculating summary statistics on many columns</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="wrangling.html"><a href="wrangling.html#apply-functions-across-many-columns-with-mutate-and-across"><i class="fa fa-check"></i><b>3.10</b> Apply functions across many columns with <code>mutate</code> and <code>across</code></a></li>
<li class="chapter" data-level="3.11" data-path="wrangling.html"><a href="wrangling.html#apply-functions-across-columns-within-one-row-with-rowwise-and-mutate"><i class="fa fa-check"></i><b>3.11</b> Apply functions across columns within one row with <code>rowwise</code> and <code>mutate</code></a></li>
<li class="chapter" data-level="3.12" data-path="wrangling.html"><a href="wrangling.html#summary"><i class="fa fa-check"></i><b>3.12</b> Summary</a></li>
<li class="chapter" data-level="3.13" data-path="wrangling.html"><a href="wrangling.html#exercises-2"><i class="fa fa-check"></i><b>3.13</b> Exercises</a></li>
<li class="chapter" data-level="3.14" data-path="wrangling.html"><a href="wrangling.html#additional-resources-1"><i class="fa fa-check"></i><b>3.14</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="viz.html"><a href="viz.html"><i class="fa fa-check"></i><b>4</b> Effective data visualization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="viz.html"><a href="viz.html#overview-3"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="viz.html"><a href="viz.html#chapter-learning-objectives-3"><i class="fa fa-check"></i><b>4.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="4.3" data-path="viz.html"><a href="viz.html#choosing-the-visualization"><i class="fa fa-check"></i><b>4.3</b> Choosing the visualization</a></li>
<li class="chapter" data-level="4.4" data-path="viz.html"><a href="viz.html#refining-the-visualization"><i class="fa fa-check"></i><b>4.4</b> Refining the visualization</a></li>
<li class="chapter" data-level="4.5" data-path="viz.html"><a href="viz.html#creating-visualizations-with-ggplot2"><i class="fa fa-check"></i><b>4.5</b> Creating visualizations with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="viz.html"><a href="viz.html#scatter-plots-and-line-plots-the-mauna-loa-co_text2-data-set"><i class="fa fa-check"></i><b>4.5.1</b> Scatter plots and line plots: the Mauna Loa CO<span class="math inline">\(_{\text{2}}\)</span> data set</a></li>
<li class="chapter" data-level="4.5.2" data-path="viz.html"><a href="viz.html#scatter-plots-the-old-faithful-eruption-time-data-set"><i class="fa fa-check"></i><b>4.5.2</b> Scatter plots: the Old Faithful eruption time data set</a></li>
<li class="chapter" data-level="4.5.3" data-path="viz.html"><a href="viz.html#axis-transformation-and-colored-scatter-plots-the-canadian-languages-data-set"><i class="fa fa-check"></i><b>4.5.3</b> Axis transformation and colored scatter plots: the Canadian languages data set</a></li>
<li class="chapter" data-level="4.5.4" data-path="viz.html"><a href="viz.html#bar-plots-the-island-landmass-data-set"><i class="fa fa-check"></i><b>4.5.4</b> Bar plots: the island landmass data set</a></li>
<li class="chapter" data-level="4.5.5" data-path="viz.html"><a href="viz.html#histogramsviz"><i class="fa fa-check"></i><b>4.5.5</b> Histograms: the Michelson speed of light data set</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="viz.html"><a href="viz.html#explaining-the-visualization"><i class="fa fa-check"></i><b>4.6</b> Explaining the visualization</a></li>
<li class="chapter" data-level="4.7" data-path="viz.html"><a href="viz.html#saving-the-visualization"><i class="fa fa-check"></i><b>4.7</b> Saving the visualization</a></li>
<li class="chapter" data-level="4.8" data-path="viz.html"><a href="viz.html#exercises-3"><i class="fa fa-check"></i><b>4.8</b> Exercises</a></li>
<li class="chapter" data-level="4.9" data-path="viz.html"><a href="viz.html#additional-resources-2"><i class="fa fa-check"></i><b>4.9</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="classification1.html"><a href="classification1.html"><i class="fa fa-check"></i><b>5</b> Classification I: training &amp; predicting</a>
<ul>
<li class="chapter" data-level="5.1" data-path="classification1.html"><a href="classification1.html#overview-4"><i class="fa fa-check"></i><b>5.1</b> Overview</a></li>
<li class="chapter" data-level="5.2" data-path="classification1.html"><a href="classification1.html#chapter-learning-objectives-4"><i class="fa fa-check"></i><b>5.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="5.3" data-path="classification1.html"><a href="classification1.html#the-classification-problem"><i class="fa fa-check"></i><b>5.3</b> The classification problem</a></li>
<li class="chapter" data-level="5.4" data-path="classification1.html"><a href="classification1.html#exploring-a-data-set"><i class="fa fa-check"></i><b>5.4</b> Exploring a data set</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="classification1.html"><a href="classification1.html#loading-the-cancer-data"><i class="fa fa-check"></i><b>5.4.1</b> Loading the cancer data</a></li>
<li class="chapter" data-level="5.4.2" data-path="classification1.html"><a href="classification1.html#describing-the-variables-in-the-cancer-data-set"><i class="fa fa-check"></i><b>5.4.2</b> Describing the variables in the cancer data set</a></li>
<li class="chapter" data-level="5.4.3" data-path="classification1.html"><a href="classification1.html#exploring-the-cancer-data"><i class="fa fa-check"></i><b>5.4.3</b> Exploring the cancer data</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="classification1.html"><a href="classification1.html#classification-with-k-nearest-neighbors"><i class="fa fa-check"></i><b>5.5</b> Classification with K-nearest neighbors</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="classification1.html"><a href="classification1.html#distance-between-points"><i class="fa fa-check"></i><b>5.5.1</b> Distance between points</a></li>
<li class="chapter" data-level="5.5.2" data-path="classification1.html"><a href="classification1.html#more-than-two-explanatory-variables"><i class="fa fa-check"></i><b>5.5.2</b> More than two explanatory variables</a></li>
<li class="chapter" data-level="5.5.3" data-path="classification1.html"><a href="classification1.html#summary-of-k-nearest-neighbors-algorithm"><i class="fa fa-check"></i><b>5.5.3</b> Summary of K-nearest neighbors algorithm</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="classification1.html"><a href="classification1.html#k-nearest-neighbors-with-tidymodels"><i class="fa fa-check"></i><b>5.6</b> K-nearest neighbors with <code>tidymodels</code></a></li>
<li class="chapter" data-level="5.7" data-path="classification1.html"><a href="classification1.html#data-preprocessing-with-tidymodels"><i class="fa fa-check"></i><b>5.7</b> Data preprocessing with <code>tidymodels</code></a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="classification1.html"><a href="classification1.html#centering-and-scaling"><i class="fa fa-check"></i><b>5.7.1</b> Centering and scaling</a></li>
<li class="chapter" data-level="5.7.2" data-path="classification1.html"><a href="classification1.html#balancing"><i class="fa fa-check"></i><b>5.7.2</b> Balancing</a></li>
<li class="chapter" data-level="5.7.3" data-path="classification1.html"><a href="classification1.html#missing-data"><i class="fa fa-check"></i><b>5.7.3</b> Missing data</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="classification1.html"><a href="classification1.html#puttingittogetherworkflow"><i class="fa fa-check"></i><b>5.8</b> Putting it together in a <code>workflow</code></a></li>
<li class="chapter" data-level="5.9" data-path="classification1.html"><a href="classification1.html#exercises-4"><i class="fa fa-check"></i><b>5.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="classification2.html"><a href="classification2.html"><i class="fa fa-check"></i><b>6</b> Classification II: evaluation &amp; tuning</a>
<ul>
<li class="chapter" data-level="6.1" data-path="classification2.html"><a href="classification2.html#overview-5"><i class="fa fa-check"></i><b>6.1</b> Overview</a></li>
<li class="chapter" data-level="6.2" data-path="classification2.html"><a href="classification2.html#chapter-learning-objectives-5"><i class="fa fa-check"></i><b>6.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="6.3" data-path="classification2.html"><a href="classification2.html#evaluating-performance"><i class="fa fa-check"></i><b>6.3</b> Evaluating performance</a></li>
<li class="chapter" data-level="6.4" data-path="classification2.html"><a href="classification2.html#randomseeds"><i class="fa fa-check"></i><b>6.4</b> Randomness and seeds</a></li>
<li class="chapter" data-level="6.5" data-path="classification2.html"><a href="classification2.html#evaluating-performance-with-tidymodels"><i class="fa fa-check"></i><b>6.5</b> Evaluating performance with <code>tidymodels</code></a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="classification2.html"><a href="classification2.html#create-the-train-test-split"><i class="fa fa-check"></i><b>6.5.1</b> Create the train / test split</a></li>
<li class="chapter" data-level="6.5.2" data-path="classification2.html"><a href="classification2.html#preprocess-the-data"><i class="fa fa-check"></i><b>6.5.2</b> Preprocess the data</a></li>
<li class="chapter" data-level="6.5.3" data-path="classification2.html"><a href="classification2.html#train-the-classifier"><i class="fa fa-check"></i><b>6.5.3</b> Train the classifier</a></li>
<li class="chapter" data-level="6.5.4" data-path="classification2.html"><a href="classification2.html#predict-the-labels-in-the-test-set"><i class="fa fa-check"></i><b>6.5.4</b> Predict the labels in the test set</a></li>
<li class="chapter" data-level="6.5.5" data-path="classification2.html"><a href="classification2.html#eval-performance-cls2"><i class="fa fa-check"></i><b>6.5.5</b> Evaluate performance</a></li>
<li class="chapter" data-level="6.5.6" data-path="classification2.html"><a href="classification2.html#critically-analyze-performance"><i class="fa fa-check"></i><b>6.5.6</b> Critically analyze performance</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="classification2.html"><a href="classification2.html#tuning-the-classifier"><i class="fa fa-check"></i><b>6.6</b> Tuning the classifier</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="classification2.html"><a href="classification2.html#cross-validation"><i class="fa fa-check"></i><b>6.6.1</b> Cross-validation</a></li>
<li class="chapter" data-level="6.6.2" data-path="classification2.html"><a href="classification2.html#parameter-value-selection"><i class="fa fa-check"></i><b>6.6.2</b> Parameter value selection</a></li>
<li class="chapter" data-level="6.6.3" data-path="classification2.html"><a href="classification2.html#underoverfitting"><i class="fa fa-check"></i><b>6.6.3</b> Under/Overfitting</a></li>
<li class="chapter" data-level="6.6.4" data-path="classification2.html"><a href="classification2.html#evaluating-on-the-test-set"><i class="fa fa-check"></i><b>6.6.4</b> Evaluating on the test set</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="classification2.html"><a href="classification2.html#summary-1"><i class="fa fa-check"></i><b>6.7</b> Summary</a></li>
<li class="chapter" data-level="6.8" data-path="classification2.html"><a href="classification2.html#predictor-variable-selection"><i class="fa fa-check"></i><b>6.8</b> Predictor variable selection</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="classification2.html"><a href="classification2.html#the-effect-of-irrelevant-predictors"><i class="fa fa-check"></i><b>6.8.1</b> The effect of irrelevant predictors</a></li>
<li class="chapter" data-level="6.8.2" data-path="classification2.html"><a href="classification2.html#finding-a-good-subset-of-predictors"><i class="fa fa-check"></i><b>6.8.2</b> Finding a good subset of predictors</a></li>
<li class="chapter" data-level="6.8.3" data-path="classification2.html"><a href="classification2.html#forward-selection-in-r"><i class="fa fa-check"></i><b>6.8.3</b> Forward selection in R</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="classification2.html"><a href="classification2.html#exercises-5"><i class="fa fa-check"></i><b>6.9</b> Exercises</a></li>
<li class="chapter" data-level="6.10" data-path="classification2.html"><a href="classification2.html#additional-resources-3"><i class="fa fa-check"></i><b>6.10</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="regression1.html"><a href="regression1.html"><i class="fa fa-check"></i><b>7</b> Regression I: K-nearest neighbors</a>
<ul>
<li class="chapter" data-level="7.1" data-path="regression1.html"><a href="regression1.html#overview-6"><i class="fa fa-check"></i><b>7.1</b> Overview</a></li>
<li class="chapter" data-level="7.2" data-path="regression1.html"><a href="regression1.html#chapter-learning-objectives-6"><i class="fa fa-check"></i><b>7.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="7.3" data-path="regression1.html"><a href="regression1.html#the-regression-problem"><i class="fa fa-check"></i><b>7.3</b> The regression problem</a></li>
<li class="chapter" data-level="7.4" data-path="regression1.html"><a href="regression1.html#exploring-a-data-set-1"><i class="fa fa-check"></i><b>7.4</b> Exploring a data set</a></li>
<li class="chapter" data-level="7.5" data-path="regression1.html"><a href="regression1.html#k-nearest-neighbors-regression"><i class="fa fa-check"></i><b>7.5</b> K-nearest neighbors regression</a></li>
<li class="chapter" data-level="7.6" data-path="regression1.html"><a href="regression1.html#training-evaluating-and-tuning-the-model"><i class="fa fa-check"></i><b>7.6</b> Training, evaluating, and tuning the model</a></li>
<li class="chapter" data-level="7.7" data-path="regression1.html"><a href="regression1.html#underfitting-and-overfitting"><i class="fa fa-check"></i><b>7.7</b> Underfitting and overfitting</a></li>
<li class="chapter" data-level="7.8" data-path="regression1.html"><a href="regression1.html#evaluating-on-the-test-set-1"><i class="fa fa-check"></i><b>7.8</b> Evaluating on the test set</a></li>
<li class="chapter" data-level="7.9" data-path="regression1.html"><a href="regression1.html#multivariable-k-nn-regression"><i class="fa fa-check"></i><b>7.9</b> Multivariable K-NN regression</a></li>
<li class="chapter" data-level="7.10" data-path="regression1.html"><a href="regression1.html#strengths-and-limitations-of-k-nn-regression"><i class="fa fa-check"></i><b>7.10</b> Strengths and limitations of K-NN regression</a></li>
<li class="chapter" data-level="7.11" data-path="regression1.html"><a href="regression1.html#exercises-6"><i class="fa fa-check"></i><b>7.11</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="regression2.html"><a href="regression2.html"><i class="fa fa-check"></i><b>8</b> Regression II: linear regression</a>
<ul>
<li class="chapter" data-level="8.1" data-path="regression2.html"><a href="regression2.html#overview-7"><i class="fa fa-check"></i><b>8.1</b> Overview</a></li>
<li class="chapter" data-level="8.2" data-path="regression2.html"><a href="regression2.html#chapter-learning-objectives-7"><i class="fa fa-check"></i><b>8.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="8.3" data-path="regression2.html"><a href="regression2.html#simple-linear-regression"><i class="fa fa-check"></i><b>8.3</b> Simple linear regression</a></li>
<li class="chapter" data-level="8.4" data-path="regression2.html"><a href="regression2.html#linear-regression-in-r"><i class="fa fa-check"></i><b>8.4</b> Linear regression in R</a></li>
<li class="chapter" data-level="8.5" data-path="regression2.html"><a href="regression2.html#comparing-simple-linear-and-k-nn-regression"><i class="fa fa-check"></i><b>8.5</b> Comparing simple linear and K-NN regression</a></li>
<li class="chapter" data-level="8.6" data-path="regression2.html"><a href="regression2.html#multivariable-linear-regression"><i class="fa fa-check"></i><b>8.6</b> Multivariable linear regression</a></li>
<li class="chapter" data-level="8.7" data-path="regression2.html"><a href="regression2.html#multicollinearity-and-outliers"><i class="fa fa-check"></i><b>8.7</b> Multicollinearity and outliers</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="regression2.html"><a href="regression2.html#outliers"><i class="fa fa-check"></i><b>8.7.1</b> Outliers</a></li>
<li class="chapter" data-level="8.7.2" data-path="regression2.html"><a href="regression2.html#multicollinearity"><i class="fa fa-check"></i><b>8.7.2</b> Multicollinearity</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="regression2.html"><a href="regression2.html#designing-new-predictors"><i class="fa fa-check"></i><b>8.8</b> Designing new predictors</a></li>
<li class="chapter" data-level="8.9" data-path="regression2.html"><a href="regression2.html#the-other-sides-of-regression"><i class="fa fa-check"></i><b>8.9</b> The other sides of regression</a></li>
<li class="chapter" data-level="8.10" data-path="regression2.html"><a href="regression2.html#exercises-7"><i class="fa fa-check"></i><b>8.10</b> Exercises</a></li>
<li class="chapter" data-level="8.11" data-path="regression2.html"><a href="regression2.html#additional-resources-4"><i class="fa fa-check"></i><b>8.11</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>9</b> Clustering</a>
<ul>
<li class="chapter" data-level="9.1" data-path="clustering.html"><a href="clustering.html#overview-8"><i class="fa fa-check"></i><b>9.1</b> Overview</a></li>
<li class="chapter" data-level="9.2" data-path="clustering.html"><a href="clustering.html#chapter-learning-objectives-8"><i class="fa fa-check"></i><b>9.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="9.3" data-path="clustering.html"><a href="clustering.html#clustering-1"><i class="fa fa-check"></i><b>9.3</b> Clustering</a></li>
<li class="chapter" data-level="9.4" data-path="clustering.html"><a href="clustering.html#an-illustrative-example"><i class="fa fa-check"></i><b>9.4</b> An illustrative example</a></li>
<li class="chapter" data-level="9.5" data-path="clustering.html"><a href="clustering.html#k-means"><i class="fa fa-check"></i><b>9.5</b> K-means</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="clustering.html"><a href="clustering.html#measuring-cluster-quality"><i class="fa fa-check"></i><b>9.5.1</b> Measuring cluster quality</a></li>
<li class="chapter" data-level="9.5.2" data-path="clustering.html"><a href="clustering.html#the-clustering-algorithm"><i class="fa fa-check"></i><b>9.5.2</b> The clustering algorithm</a></li>
<li class="chapter" data-level="9.5.3" data-path="clustering.html"><a href="clustering.html#random-restarts"><i class="fa fa-check"></i><b>9.5.3</b> Random restarts</a></li>
<li class="chapter" data-level="9.5.4" data-path="clustering.html"><a href="clustering.html#choosing-k"><i class="fa fa-check"></i><b>9.5.4</b> Choosing K</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="clustering.html"><a href="clustering.html#k-means-in-r"><i class="fa fa-check"></i><b>9.6</b> K-means in R</a></li>
<li class="chapter" data-level="9.7" data-path="clustering.html"><a href="clustering.html#exercises-8"><i class="fa fa-check"></i><b>9.7</b> Exercises</a></li>
<li class="chapter" data-level="9.8" data-path="clustering.html"><a href="clustering.html#additional-resources-5"><i class="fa fa-check"></i><b>9.8</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>10</b> Statistical inference</a>
<ul>
<li class="chapter" data-level="10.1" data-path="inference.html"><a href="inference.html#overview-9"><i class="fa fa-check"></i><b>10.1</b> Overview</a></li>
<li class="chapter" data-level="10.2" data-path="inference.html"><a href="inference.html#chapter-learning-objectives-9"><i class="fa fa-check"></i><b>10.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="10.3" data-path="inference.html"><a href="inference.html#why-do-we-need-sampling"><i class="fa fa-check"></i><b>10.3</b> Why do we need sampling?</a></li>
<li class="chapter" data-level="10.4" data-path="inference.html"><a href="inference.html#sampling-distributions"><i class="fa fa-check"></i><b>10.4</b> Sampling distributions</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="inference.html"><a href="inference.html#sampling-distributions-for-proportions"><i class="fa fa-check"></i><b>10.4.1</b> Sampling distributions for proportions</a></li>
<li class="chapter" data-level="10.4.2" data-path="inference.html"><a href="inference.html#sampling-distributions-for-means"><i class="fa fa-check"></i><b>10.4.2</b> Sampling distributions for means</a></li>
<li class="chapter" data-level="10.4.3" data-path="inference.html"><a href="inference.html#summary-2"><i class="fa fa-check"></i><b>10.4.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="inference.html"><a href="inference.html#bootstrapping"><i class="fa fa-check"></i><b>10.5</b> Bootstrapping</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="inference.html"><a href="inference.html#overview-10"><i class="fa fa-check"></i><b>10.5.1</b> Overview</a></li>
<li class="chapter" data-level="10.5.2" data-path="inference.html"><a href="inference.html#bootstrapping-in-r"><i class="fa fa-check"></i><b>10.5.2</b> Bootstrapping in R</a></li>
<li class="chapter" data-level="10.5.3" data-path="inference.html"><a href="inference.html#using-the-bootstrap-to-calculate-a-plausible-range"><i class="fa fa-check"></i><b>10.5.3</b> Using the bootstrap to calculate a plausible range</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="inference.html"><a href="inference.html#exercises-9"><i class="fa fa-check"></i><b>10.6</b> Exercises</a></li>
<li class="chapter" data-level="10.7" data-path="inference.html"><a href="inference.html#additional-resources-6"><i class="fa fa-check"></i><b>10.7</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="jupyter.html"><a href="jupyter.html"><i class="fa fa-check"></i><b>11</b> Combining code and text with Jupyter</a>
<ul>
<li class="chapter" data-level="11.1" data-path="jupyter.html"><a href="jupyter.html#overview-11"><i class="fa fa-check"></i><b>11.1</b> Overview</a></li>
<li class="chapter" data-level="11.2" data-path="jupyter.html"><a href="jupyter.html#chapter-learning-objectives-10"><i class="fa fa-check"></i><b>11.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="11.3" data-path="jupyter.html"><a href="jupyter.html#jupyter-1"><i class="fa fa-check"></i><b>11.3</b> Jupyter</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="jupyter.html"><a href="jupyter.html#accessing-jupyter"><i class="fa fa-check"></i><b>11.3.1</b> Accessing Jupyter</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="jupyter.html"><a href="jupyter.html#code-cells"><i class="fa fa-check"></i><b>11.4</b> Code cells</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="jupyter.html"><a href="jupyter.html#executing-code-cells"><i class="fa fa-check"></i><b>11.4.1</b> Executing code cells</a></li>
<li class="chapter" data-level="11.4.2" data-path="jupyter.html"><a href="jupyter.html#the-kernel"><i class="fa fa-check"></i><b>11.4.2</b> The Kernel</a></li>
<li class="chapter" data-level="11.4.3" data-path="jupyter.html"><a href="jupyter.html#creating-new-code-cells"><i class="fa fa-check"></i><b>11.4.3</b> Creating new code cells</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="jupyter.html"><a href="jupyter.html#markdown-cells"><i class="fa fa-check"></i><b>11.5</b> Markdown cells</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="jupyter.html"><a href="jupyter.html#editing-markdown-cells"><i class="fa fa-check"></i><b>11.5.1</b> Editing Markdown cells</a></li>
<li class="chapter" data-level="11.5.2" data-path="jupyter.html"><a href="jupyter.html#creating-new-markdown-cells"><i class="fa fa-check"></i><b>11.5.2</b> Creating new Markdown cells</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="jupyter.html"><a href="jupyter.html#saving-your-work"><i class="fa fa-check"></i><b>11.6</b> Saving your work</a></li>
<li class="chapter" data-level="11.7" data-path="jupyter.html"><a href="jupyter.html#best-practices-for-running-a-notebook"><i class="fa fa-check"></i><b>11.7</b> Best practices for running a notebook</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="jupyter.html"><a href="jupyter.html#best-practices-for-executing-code-cells"><i class="fa fa-check"></i><b>11.7.1</b> Best practices for executing code cells</a></li>
<li class="chapter" data-level="11.7.2" data-path="jupyter.html"><a href="jupyter.html#best-practices-for-including-r-packages-in-notebooks"><i class="fa fa-check"></i><b>11.7.2</b> Best practices for including R packages in notebooks</a></li>
<li class="chapter" data-level="11.7.3" data-path="jupyter.html"><a href="jupyter.html#summary-of-best-practices-for-running-a-notebook"><i class="fa fa-check"></i><b>11.7.3</b> Summary of best practices for running a notebook</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="jupyter.html"><a href="jupyter.html#exploring-data-files"><i class="fa fa-check"></i><b>11.8</b> Exploring data files</a></li>
<li class="chapter" data-level="11.9" data-path="jupyter.html"><a href="jupyter.html#exporting-to-a-different-file-format"><i class="fa fa-check"></i><b>11.9</b> Exporting to a different file format</a>
<ul>
<li class="chapter" data-level="11.9.1" data-path="jupyter.html"><a href="jupyter.html#exporting-to-html"><i class="fa fa-check"></i><b>11.9.1</b> Exporting to HTML</a></li>
<li class="chapter" data-level="11.9.2" data-path="jupyter.html"><a href="jupyter.html#exporting-to-pdf"><i class="fa fa-check"></i><b>11.9.2</b> Exporting to PDF</a></li>
</ul></li>
<li class="chapter" data-level="11.10" data-path="jupyter.html"><a href="jupyter.html#creating-a-new-jupyter-notebook"><i class="fa fa-check"></i><b>11.10</b> Creating a new Jupyter notebook</a></li>
<li class="chapter" data-level="11.11" data-path="jupyter.html"><a href="jupyter.html#additional-resources-7"><i class="fa fa-check"></i><b>11.11</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="version-control.html"><a href="version-control.html"><i class="fa fa-check"></i><b>12</b> Collaboration with version control</a>
<ul>
<li class="chapter" data-level="12.1" data-path="version-control.html"><a href="version-control.html#overview-12"><i class="fa fa-check"></i><b>12.1</b> Overview</a></li>
<li class="chapter" data-level="12.2" data-path="version-control.html"><a href="version-control.html#chapter-learning-objectives-11"><i class="fa fa-check"></i><b>12.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="12.3" data-path="version-control.html"><a href="version-control.html#what-is-version-control-and-why-should-i-use-it"><i class="fa fa-check"></i><b>12.3</b> What is version control, and why should I use it?</a></li>
<li class="chapter" data-level="12.4" data-path="version-control.html"><a href="version-control.html#version-control-repositories"><i class="fa fa-check"></i><b>12.4</b> Version control repositories</a></li>
<li class="chapter" data-level="12.5" data-path="version-control.html"><a href="version-control.html#version-control-workflows"><i class="fa fa-check"></i><b>12.5</b> Version control workflows</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="version-control.html"><a href="version-control.html#commit-changes"><i class="fa fa-check"></i><b>12.5.1</b> Committing changes to a local repository</a></li>
<li class="chapter" data-level="12.5.2" data-path="version-control.html"><a href="version-control.html#pushing-changes-to-a-remote-repository"><i class="fa fa-check"></i><b>12.5.2</b> Pushing changes to a remote repository</a></li>
<li class="chapter" data-level="12.5.3" data-path="version-control.html"><a href="version-control.html#pulling-changes-from-a-remote-repository"><i class="fa fa-check"></i><b>12.5.3</b> Pulling changes from a remote repository</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="version-control.html"><a href="version-control.html#working-with-remote-repositories-using-github"><i class="fa fa-check"></i><b>12.6</b> Working with remote repositories using GitHub</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="version-control.html"><a href="version-control.html#creating-a-remote-repository-on-github"><i class="fa fa-check"></i><b>12.6.1</b> Creating a remote repository on GitHub</a></li>
<li class="chapter" data-level="12.6.2" data-path="version-control.html"><a href="version-control.html#editing-files-on-github-with-the-pen-tool"><i class="fa fa-check"></i><b>12.6.2</b> Editing files on GitHub with the pen tool</a></li>
<li class="chapter" data-level="12.6.3" data-path="version-control.html"><a href="version-control.html#creating-files-on-github-with-the-add-file-menu"><i class="fa fa-check"></i><b>12.6.3</b> Creating files on GitHub with the “Add file” menu</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="version-control.html"><a href="version-control.html#local-repo-jupyter"><i class="fa fa-check"></i><b>12.7</b> Working with local repositories using Jupyter</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="version-control.html"><a href="version-control.html#generating-a-github-personal-access-token"><i class="fa fa-check"></i><b>12.7.1</b> Generating a GitHub personal access token</a></li>
<li class="chapter" data-level="12.7.2" data-path="version-control.html"><a href="version-control.html#cloning-a-repository-using-jupyter"><i class="fa fa-check"></i><b>12.7.2</b> Cloning a repository using Jupyter</a></li>
<li class="chapter" data-level="12.7.3" data-path="version-control.html"><a href="version-control.html#specifying-files-to-commit"><i class="fa fa-check"></i><b>12.7.3</b> Specifying files to commit</a></li>
<li class="chapter" data-level="12.7.4" data-path="version-control.html"><a href="version-control.html#making-the-commit"><i class="fa fa-check"></i><b>12.7.4</b> Making the commit</a></li>
<li class="chapter" data-level="12.7.5" data-path="version-control.html"><a href="version-control.html#pushing-the-commits-to-github"><i class="fa fa-check"></i><b>12.7.5</b> Pushing the commits to GitHub</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="version-control.html"><a href="version-control.html#collaboration"><i class="fa fa-check"></i><b>12.8</b> Collaboration</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="version-control.html"><a href="version-control.html#giving-collaborators-access-to-your-project"><i class="fa fa-check"></i><b>12.8.1</b> Giving collaborators access to your project</a></li>
<li class="chapter" data-level="12.8.2" data-path="version-control.html"><a href="version-control.html#pulling-changes-from-github-using-jupyter"><i class="fa fa-check"></i><b>12.8.2</b> Pulling changes from GitHub using Jupyter</a></li>
<li class="chapter" data-level="12.8.3" data-path="version-control.html"><a href="version-control.html#handling-merge-conflicts"><i class="fa fa-check"></i><b>12.8.3</b> Handling merge conflicts</a></li>
<li class="chapter" data-level="12.8.4" data-path="version-control.html"><a href="version-control.html#communicating-using-github-issues"><i class="fa fa-check"></i><b>12.8.4</b> Communicating using GitHub issues</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="version-control.html"><a href="version-control.html#exercises-10"><i class="fa fa-check"></i><b>12.9</b> Exercises</a></li>
<li class="chapter" data-level="12.10" data-path="version-control.html"><a href="version-control.html#vc-add-res"><i class="fa fa-check"></i><b>12.10</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="setup.html"><a href="setup.html"><i class="fa fa-check"></i><b>13</b> Setting up your computer</a>
<ul>
<li class="chapter" data-level="13.1" data-path="setup.html"><a href="setup.html#overview-13"><i class="fa fa-check"></i><b>13.1</b> Overview</a></li>
<li class="chapter" data-level="13.2" data-path="setup.html"><a href="setup.html#chapter-learning-objectives-12"><i class="fa fa-check"></i><b>13.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="13.3" data-path="setup.html"><a href="setup.html#obtaining-the-worksheets-for-this-book"><i class="fa fa-check"></i><b>13.3</b> Obtaining the worksheets for this book</a></li>
<li class="chapter" data-level="13.4" data-path="setup.html"><a href="setup.html#working-with-docker"><i class="fa fa-check"></i><b>13.4</b> Working with Docker</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="setup.html"><a href="setup.html#windows"><i class="fa fa-check"></i><b>13.4.1</b> Windows</a></li>
<li class="chapter" data-level="13.4.2" data-path="setup.html"><a href="setup.html#macos"><i class="fa fa-check"></i><b>13.4.2</b> MacOS</a></li>
<li class="chapter" data-level="13.4.3" data-path="setup.html"><a href="setup.html#ubuntu"><i class="fa fa-check"></i><b>13.4.3</b> Ubuntu</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="setup.html"><a href="setup.html#working-with-jupyterlab-desktop"><i class="fa fa-check"></i><b>13.5</b> Working with JupyterLab Desktop</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="setup.html"><a href="setup.html#windows-1"><i class="fa fa-check"></i><b>13.5.1</b> Windows</a></li>
<li class="chapter" data-level="13.5.2" data-path="setup.html"><a href="setup.html#macos-1"><i class="fa fa-check"></i><b>13.5.2</b> MacOS</a></li>
<li class="chapter" data-level="13.5.3" data-path="setup.html"><a href="setup.html#ubuntu-1"><i class="fa fa-check"></i><b>13.5.3</b> Ubuntu</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><p><img src="img/frontmatter/ds-a-first-intro-graphic.jpg" />
Data Science</p></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="wrangling" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Cleaning and wrangling data<a href="wrangling.html#wrangling" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="overview-2" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Overview<a href="wrangling.html#overview-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This chapter is centered around defining tidy data—a data format that is
suitable for analysis—and the tools needed to transform raw data into this
format. This will be presented in the context of a real-world data science
application, providing more practice working through a whole case study.</p>
</div>
<div id="chapter-learning-objectives-2" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Chapter learning objectives<a href="wrangling.html#chapter-learning-objectives-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>By the end of the chapter, readers will be able to do the following:</p>
<ul>
<li>Define the term “tidy data”.</li>
<li>Discuss the advantages of storing data in a tidy data format.</li>
<li>Define what vectors, lists, and data frames are in R, and describe how they relate to
each other.</li>
<li>Describe the common types of data in R and their uses.</li>
<li>Use the following functions for their intended data wrangling tasks:
<ul>
<li><code>c</code></li>
<li><code>pivot_longer</code></li>
<li><code>pivot_wider</code></li>
<li><code>separate</code></li>
<li><code>select</code></li>
<li><code>filter</code></li>
<li><code>mutate</code></li>
<li><code>summarize</code></li>
<li><code>map</code></li>
<li><code>group_by</code></li>
<li><code>across</code></li>
<li><code>rowwise</code></li>
</ul></li>
<li>Use the following operators for their intended data wrangling tasks:
<ul>
<li><code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, and <code>&gt;=</code></li>
<li><code>%in%</code></li>
<li><code>!</code>, <code>&amp;</code>, and <code>|</code></li>
<li><code>|&gt;</code> and <code>%&gt;%</code></li>
</ul></li>
</ul>
</div>
<div id="data-frames-vectors-and-lists" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Data frames, vectors, and lists<a href="wrangling.html#data-frames-vectors-and-lists" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In Chapters <a href="intro.html#intro">1</a> and <a href="reading.html#reading">2</a>, <em>data frames</em> were the focus:
we learned how to import data into R as a data frame, and perform basic operations on data frames in R.
In the remainder of this book, this pattern continues. The vast majority of tools we use will require
that data are represented as a data frame in R. Therefore, in this section,
we will dig more deeply into what data frames are and how they are represented in R.
This knowledge will be helpful in effectively utilizing these objects in our data analyses.</p>
<div id="what-is-a-data-frame" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> What is a data frame?<a href="wrangling.html#what-is-a-data-frame" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A data frame is a table-like structure for storing data in R. Data frames are
important to learn about because most data that you will encounter in practice
can be naturally stored as a table. In order to define data frames precisely,
we need to introduce a few technical terms:</p>
<ul>
<li><strong>variable:</strong> a characteristic, number, or quantity that can be measured.</li>
<li><strong>observation:</strong> all of the measurements for a given entity.</li>
<li><strong>value:</strong> a single measurement of a single variable for a given entity.</li>
</ul>
<p>Given these definitions, a <strong>data frame</strong> is a tabular data structure in R
that is designed to store observations, variables, and their values.
Most commonly, each column in a data frame corresponds to a variable,
and each row corresponds to an observation. For example, Figure
<a href="wrangling.html#fig:02-obs">3.1</a> displays a data set of city populations. Here, the variables
are “region, year, population”; each of these are properties that can be
collected or measured. The first observation is “Toronto, 2016, 2235145”;
these are the values that the three variables take for the first entity in the
data set. There are 13 entities in the data set in total, corresponding to the
13 rows in Figure <a href="wrangling.html#fig:02-obs">3.1</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:02-obs"></span>
<img src="_main_files/figure-html/02-obs-1.png" alt="A data frame storing data regarding the population of various regions in Canada. In this example data frame, the row that corresponds to the observation for the city of Vancouver is colored yellow, and the column that corresponds to the population variable is colored blue." width="100%"  />
<p class="caption">
Figure 3.1: A data frame storing data regarding the population of various regions in Canada. In this example data frame, the row that corresponds to the observation for the city of Vancouver is colored yellow, and the column that corresponds to the population variable is colored blue.
</p>
</div>
<p>R stores the columns of a data frame as either
<em>lists</em> or <em>vectors</em>. For example, the data frame in Figure
<a href="wrangling.html#fig:02-vectors">3.2</a> has three vectors whose names are <code>region</code>, <code>year</code> and
<code>population</code>. The next two sections will explain what lists and vectors are.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:02-vectors"></span>
<img src="_main_files/figure-html/02-vectors-1.png" alt="Data frame with three vectors." width="100%" />
<p class="caption">
Figure 3.2: Data frame with three vectors.
</p>
</div>
</div>
<div id="what-is-a-vector" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> What is a vector?<a href="wrangling.html#what-is-a-vector" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In R, <strong>vectors</strong> are objects that can contain one or more elements. The vector
elements are ordered, and they must all be of the same <strong>data type</strong>;
R has several different basic data types, as shown in Table <a href="wrangling.html#tab:datatype-table">3.1</a>.
Figure <a href="wrangling.html#fig:02-vector">3.3</a> provides an example of a vector where all of the elements are
of character type.
You can create vectors in R using the <code>c</code> function (<code>c</code> stands for “concatenate”). For
example, to create the vector <code>region</code> as shown in Figure
<a href="wrangling.html#fig:02-vector">3.3</a>, you would write:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="wrangling.html#cb109-1" tabindex="-1"></a>region <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Toronto&quot;</span>, <span class="st">&quot;Montreal&quot;</span>, <span class="st">&quot;Vancouver&quot;</span>, <span class="st">&quot;Calgary&quot;</span>, <span class="st">&quot;Ottawa&quot;</span>)</span>
<span id="cb109-2"><a href="wrangling.html#cb109-2" tabindex="-1"></a>region</span></code></pre></div>
<pre><code>## [1] &quot;Toronto&quot;   &quot;Montreal&quot;  &quot;Vancouver&quot; &quot;Calgary&quot;   &quot;Ottawa&quot;</code></pre>
<blockquote>
<p><strong>Note:</strong> Technically, these objects are called “atomic vectors.” In this book
we have chosen to call them “vectors,” which is how they are most commonly
referred to in the R community. To be totally precise, “vector” is an umbrella term that
encompasses both atomic vector and list objects in R. But this creates a
confusing situation where the term “vector” could
mean “atomic vector” <em>or</em> “the umbrella term for atomic vector and list,”
depending on context. Very confusing indeed! So to keep things simple, in
this book we <em>always</em> use the term “vector” to refer to “atomic vector.”
We encourage readers who are enthusiastic to learn more to read the
Vectors chapter of <em>Advanced R</em> <span class="citation">(<a href="#ref-wickham2019advanced">Wickham 2019</a>)</span>.</p>
</blockquote>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:02-vector"></span>
<img src="_main_files/figure-html/02-vector-1.png" alt="Example of a vector whose type is character." width="100%" />
<p class="caption">
Figure 3.3: Example of a vector whose type is character.
</p>
</div>
<div style="page-break-after: always;"></div>
<table>
<caption><span id="tab:datatype-table">Table 3.1: </span> Basic data types in R</caption>
<colgroup>
<col width="16%" />
<col width="19%" />
<col width="38%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th>Data type</th>
<th>Abbreviation</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>character</td>
<td>chr</td>
<td>letters or numbers surrounded by quotes</td>
<td>“1” , “Hello world!”</td>
</tr>
<tr class="even">
<td>double</td>
<td>dbl</td>
<td>numbers with decimals values</td>
<td>1.2333</td>
</tr>
<tr class="odd">
<td>integer</td>
<td>int</td>
<td>numbers that do not contain decimals</td>
<td>1L, 20L (where “L” tells R to store as an integer)</td>
</tr>
<tr class="even">
<td>logical</td>
<td>lgl</td>
<td>either true or false</td>
<td><code>TRUE</code>, <code>FALSE</code></td>
</tr>
<tr class="odd">
<td>factor</td>
<td>fct</td>
<td>used to represent data with a limited number of values (usually categories)</td>
<td>a <code>color</code> variable with levels <code>red</code>, <code>green</code> and <code>orange</code></td>
</tr>
</tbody>
</table>
<p>
It is important in R to make sure you represent your data with the correct type.
Many of the <code>tidyverse</code> functions we use in this book treat
the various data types differently. You should use integers and double types
(which both fall under the “numeric” umbrella type) to represent numbers and perform
arithmetic. Doubles are more common than integers in R, though; for instance, a double data type is the
default when you create a vector of numbers using <code>c()</code>, and when you read in
whole numbers via <code>read_csv</code>. Characters are used to represent data that should
be thought of as “text”, such as words, names, paths, URLs, and more. Factors help us
encode variables that represent <em>categories</em>; a factor variable takes one of a discrete
set of values known as <em>levels</em> (one for each category). The levels can be ordered or unordered. Even though
factors can sometimes <em>look</em> like characters, they are not used to represent
text, words, names, and paths in the way that characters are; in fact, R
internally stores factors using integers! There are other basic data types in R, such as <em>raw</em>
and <em>complex</em>, but we do not use these in this textbook.</p>
</div>
<div id="what-is-a-list" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> What is a list?<a href="wrangling.html#what-is-a-list" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Lists are also objects in R that have multiple, ordered elements.
Vectors and lists differ by the requirement of element type
consistency. All elements within a single vector must be of the same type (e.g.,
all elements are characters), whereas elements within a single list can be of
different types (e.g., characters, integers, logicals, and even other lists). See Figure <a href="wrangling.html#fig:02-vec-vs-list">3.4</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:02-vec-vs-list"></span>
<img src="_main_files/figure-html/02-vec-vs-list-1.png" alt="A vector versus a list." width="100%" />
<p class="caption">
Figure 3.4: A vector versus a list.
</p>
</div>
</div>
<div id="what-does-this-have-to-do-with-data-frames" class="section level3 hasAnchor" number="3.3.4">
<h3><span class="header-section-number">3.3.4</span> What does this have to do with data frames?<a href="wrangling.html#what-does-this-have-to-do-with-data-frames" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A data frame is really a special kind of list that follows two rules:</p>
<ol style="list-style-type: decimal">
<li>Each element itself must either be a vector or a list.</li>
<li>Each element (vector or list) must have the same length.</li>
</ol>
<p>Not all columns in a data frame need to be of the same type.
Figure <a href="wrangling.html#fig:02-dataframe">3.5</a> shows a data frame where
the columns are vectors of different types.
But remember: because the columns in this example are <em>vectors</em>,
the elements must be the same data type <em>within each column.</em>
On the other hand, if our data frame had <em>list</em> columns, there would be no such requirement.
It is generally much more common to use <em>vector</em> columns, though,
as the values for a single variable are usually all of the same type.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:02-dataframe"></span>
<img src="_main_files/figure-html/02-dataframe-1.png" alt="Data frame and vector types." width="100%" />
<p class="caption">
Figure 3.5: Data frame and vector types.
</p>
</div>
<p>Data frames are actually included in R itself, without the need for any additional packages. However, the
<code>tidyverse</code> functions that we use
throughout this book all work with a special kind of data frame called a <em>tibble</em>. Tibbles have some additional
features and benefits over built-in data frames in R. These include the
ability to add useful attributes (such as grouping, which we will discuss later)
and more predictable type preservation when subsetting.
Because a tibble is just a data frame with some added features,
we will collectively refer to both built-in R data frames and
tibbles as <em>data frames</em> in this book.</p>
<blockquote>
<p><strong>Note:</strong> You can use the function <code>class</code> on a data object to assess whether a data
frame is a built-in R data frame or a tibble. If the data object is a data
frame, <code>class</code> will return <code>"data.frame"</code>. If the data object is a
tibble it will return <code>"tbl_df"  "tbl"  "data.frame"</code>. You can easily convert
built-in R data frames to tibbles using the <code>tidyverse</code> <code>as_tibble</code> function.
For example we can check the class of the Canadian languages data set,
<code>can_lang</code>, we worked with in the previous chapters and we see it is a tibble.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="wrangling.html#cb111-1" tabindex="-1"></a><span class="fu">class</span>(can_lang)</span></code></pre></div>
<pre><code>## [1] &quot;spec_tbl_df&quot; &quot;tbl_df&quot;      &quot;tbl&quot;         &quot;data.frame&quot;</code></pre>
</blockquote>
<p>Vectors, data frames and lists are basic types of <em>data structure</em> in R, which
are core to most data analyses. We summarize them in Table
<a href="wrangling.html#tab:datastructure-table">3.2</a>. There are several other data structures in the R programming
language (<em>e.g.,</em> matrices), but these are beyond the scope of this book.
</p>
<table>
<caption><span id="tab:datastructure-table">Table 3.2: </span> Basic data structures in R</caption>
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead>
<tr class="header">
<th>Data Structure</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>vector</td>
<td>An ordered collection of one, or more, values of the <em>same data type</em>.</td>
</tr>
<tr class="even">
<td>list</td>
<td>An ordered collection of one, or more, values of <em>possibly different data types</em>.</td>
</tr>
<tr class="odd">
<td>data frame</td>
<td>A list of either vectors or lists of the <em>same length</em>, with column names. We typically use a data frame to represent a data set.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="tidy-data" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Tidy data<a href="wrangling.html#tidy-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are many ways a tabular data set can be organized. This chapter will focus
on introducing the <strong>tidy data</strong> format of organization and how to make your raw
(and likely messy) data tidy. A tidy data frame satisfies
the following three criteria <span class="citation">(<a href="#ref-wickham2014tidy">Wickham 2014</a>)</span>:</p>
<ul>
<li>each row is a single observation,</li>
<li>each column is a single variable, and</li>
<li>each value is a single cell (i.e., its entry in the data
frame is not shared with another value).</li>
</ul>
<p>Figure <a href="wrangling.html#fig:02-tidy-image">3.6</a> demonstrates a tidy data set that satisfies these
three criteria.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:02-tidy-image"></span>
<img src="_main_files/figure-html/02-tidy-image-1.png" alt="Tidy data satisfies three criteria." width="80%" />
<p class="caption">
Figure 3.6: Tidy data satisfies three criteria.
</p>
</div>
<p>There are many good reasons for making sure your data are tidy as a first step in your analysis.
The most important is that it is a single, consistent format that nearly every function
in the <code>tidyverse</code> recognizes. No matter what the variables and observations
in your data represent, as long as the data frame
is tidy, you can manipulate it, plot it, and analyze it using the same tools.
If your data is <em>not</em> tidy, you will have to write special bespoke code
in your analysis that will not only be error-prone, but hard for others to understand.
Beyond making your analysis more accessible to others and less error-prone, tidy data
is also typically easy for humans to interpret. Given these benefits,
it is well worth spending the time to get your data into a tidy format
upfront. Fortunately, there are many well-designed <code>tidyverse</code> data
cleaning/wrangling tools to help you easily tidy your data. Let’s explore them
below!</p>
<blockquote>
<p><strong>Note:</strong> Is there only one shape for tidy data for a given data set? Not
necessarily! It depends on the statistical question you are asking and what
the variables are for that question. For tidy data, each variable should be
its own column. So, just as it’s essential to match your statistical question
with the appropriate data analysis tool, it’s important to match your
statistical question with the appropriate variables and ensure they are
represented as individual columns to make the data tidy.</p>
</blockquote>
<div id="tidying-up-going-from-wide-to-long-using-pivot_longer" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Tidying up: going from wide to long using <code>pivot_longer</code><a href="wrangling.html#tidying-up-going-from-wide-to-long-using-pivot_longer" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One task that is commonly performed to get data into a tidy format
is to combine values that are stored in separate columns,
but are really part of the same variable, into one.
Data is often stored this way
because this format is sometimes more intuitive for human readability
and understanding, and humans create data sets.
In Figure <a href="wrangling.html#fig:02-wide-to-long">3.7</a>,
the table on the left is in an untidy, “wide” format because the year values
(2006, 2011, 2016) are stored as column names.
And as a consequence,
the values for population for the various cities
over these years are also split across several columns.</p>
<p>For humans, this table is easy to read, which is why you will often find data
stored in this wide format. However, this format is difficult to work with
when performing data visualization or statistical analysis using R. For
example, if we wanted to find the latest year it would be challenging because
the year values are stored as column names instead of as values in a single
column. So before we could apply a function to find the latest year (for
example, by using <code>max</code>), we would have to first extract the column names
to get them as a vector and then apply a function to extract the latest year.
The problem only gets worse if you would like to find the value for the
population for a given region for the latest year. Both of these tasks are
greatly simplified once the data is tidied.</p>
<p>Another problem with data in this format is that we don’t know what the
numbers under each year actually represent. Do those numbers represent
population size? Land area? It’s not clear.
To solve both of these problems,
we can reshape this data set to a tidy data format
by creating a column called “year” and a column called
“population.” This transformation—which makes the data
“longer”—is shown as the right table in
Figure <a href="wrangling.html#fig:02-wide-to-long">3.7</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:02-wide-to-long"></span>
<img src="img/wrangling/pivot_functions.001.png" alt="Pivoting data from a wide to long data format." width="100%" />
<p class="caption">
Figure 3.7: Pivoting data from a wide to long data format.
</p>
</div>
<p>We can achieve this effect in R using the <code>pivot_longer</code> function from the <code>tidyverse</code> package.
The <code>pivot_longer</code> function combines columns,
and is usually used during tidying data
when we need to make the data frame longer and narrower.
To learn how to use <code>pivot_longer</code>, we will work through an example with the
<code>region_lang_top5_cities_wide.csv</code> data set. This data set contains the
counts of how many Canadians cited each language as their mother tongue for five
major Canadian cities (Toronto, Montréal, Vancouver, Calgary, and Edmonton) from
the 2016 Canadian census.
To get started,
we will load the <code>tidyverse</code> package and use <code>read_csv</code> to load the (untidy) data.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="wrangling.html#cb113-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb113-2"><a href="wrangling.html#cb113-2" tabindex="-1"></a></span>
<span id="cb113-3"><a href="wrangling.html#cb113-3" tabindex="-1"></a>lang_wide <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/region_lang_top5_cities_wide.csv&quot;</span>)</span>
<span id="cb113-4"><a href="wrangling.html#cb113-4" tabindex="-1"></a>lang_wide</span></code></pre></div>
<pre><code>## # A tibble: 214 × 7
##    category                 language Toronto Montréal Vancouver Calgary Edmonton
##    &lt;chr&gt;                    &lt;chr&gt;      &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
##  1 Aboriginal languages     Aborigi…      80       30        70      20       25
##  2 Non-Official &amp; Non-Abor… Afrikaa…     985       90      1435     960      575
##  3 Non-Official &amp; Non-Abor… Afro-As…     360      240        45      45       65
##  4 Non-Official &amp; Non-Abor… Akan (T…    8485     1015       400     705      885
##  5 Non-Official &amp; Non-Abor… Albanian   13260     2450      1090    1365      770
##  6 Aboriginal languages     Algonqu…       5        5         0       0        0
##  7 Aboriginal languages     Algonqu…       5       30         5       5        0
##  8 Non-Official &amp; Non-Abor… America…     470       50       265     100      180
##  9 Non-Official &amp; Non-Abor… Amharic     7460      665      1140    4075     2515
## 10 Non-Official &amp; Non-Abor… Arabic     85175   151955     14320   18965    17525
## # ℹ 204 more rows</code></pre>
<p>What is wrong with the untidy format above?
The table on the left in Figure <a href="wrangling.html#fig:img-pivot-longer-with-table">3.8</a>
represents the data in the “wide” (messy) format.
From a data analysis perspective, this format is not ideal because the values of
the variable <em>region</em> (Toronto, Montréal, Vancouver, Calgary, and Edmonton)
are stored as column names. Thus they
are not easily accessible to the data analysis functions we will apply
to our data set. Additionally, the <em>mother tongue</em> variable values are
spread across multiple columns, which will prevent us from doing any desired
visualization or statistical tasks until we combine them into one column. For
instance, suppose we want to know the languages with the highest number of
Canadians reporting it as their mother tongue among all five regions. This
question would be tough to answer with the data in its current format.
We <em>could</em> find the answer with the data in this format,
though it would be much easier to answer if we tidy our
data first. If mother tongue were instead stored as one column,
as shown in the tidy data on the right in
Figure <a href="wrangling.html#fig:img-pivot-longer-with-table">3.8</a>,
we could simply use the <code>max</code> function in one line of code
to get the maximum value.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:img-pivot-longer-with-table"></span>
<img src="img/wrangling/pivot_functions.003.png" alt="Going from wide to long with the pivot_longer function." width="100%" />
<p class="caption">
Figure 3.8: Going from wide to long with the <code>pivot_longer</code> function.
</p>
</div>
<p>Figure <a href="wrangling.html#fig:img-pivot-longer">3.9</a> details the arguments that we need to specify
in the <code>pivot_longer</code> function to accomplish this data transformation.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:img-pivot-longer"></span>
<img src="_main_files/figure-html/img-pivot-longer-1.png" alt="Syntax for the pivot_longer function." width="100%" />
<p class="caption">
Figure 3.9: Syntax for the <code>pivot_longer</code> function.
</p>
</div>
<p>We use <code>pivot_longer</code> to combine the Toronto, Montréal,
Vancouver, Calgary, and Edmonton columns into a single column called <code>region</code>,
and create a column called <code>mother_tongue</code> that contains the count of how many
Canadians report each language as their mother tongue for each metropolitan
area. We use a colon <code>:</code> between Toronto and Edmonton to tell R to select all
the columns between Toronto and Edmonton: </p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="wrangling.html#cb115-1" tabindex="-1"></a>lang_mother_tidy <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(lang_wide,</span>
<span id="cb115-2"><a href="wrangling.html#cb115-2" tabindex="-1"></a>  <span class="at">cols =</span> Toronto<span class="sc">:</span>Edmonton,</span>
<span id="cb115-3"><a href="wrangling.html#cb115-3" tabindex="-1"></a>  <span class="at">names_to =</span> <span class="st">&quot;region&quot;</span>,</span>
<span id="cb115-4"><a href="wrangling.html#cb115-4" tabindex="-1"></a>  <span class="at">values_to =</span> <span class="st">&quot;mother_tongue&quot;</span></span>
<span id="cb115-5"><a href="wrangling.html#cb115-5" tabindex="-1"></a>)</span>
<span id="cb115-6"><a href="wrangling.html#cb115-6" tabindex="-1"></a></span>
<span id="cb115-7"><a href="wrangling.html#cb115-7" tabindex="-1"></a>lang_mother_tidy</span></code></pre></div>
<pre><code>## # A tibble: 1,070 × 4
##    category                                language         region mother_tongue
##    &lt;chr&gt;                                   &lt;chr&gt;            &lt;chr&gt;          &lt;dbl&gt;
##  1 Aboriginal languages                    Aboriginal lang… Toron…            80
##  2 Aboriginal languages                    Aboriginal lang… Montr…            30
##  3 Aboriginal languages                    Aboriginal lang… Vanco…            70
##  4 Aboriginal languages                    Aboriginal lang… Calga…            20
##  5 Aboriginal languages                    Aboriginal lang… Edmon…            25
##  6 Non-Official &amp; Non-Aboriginal languages Afrikaans        Toron…           985
##  7 Non-Official &amp; Non-Aboriginal languages Afrikaans        Montr…            90
##  8 Non-Official &amp; Non-Aboriginal languages Afrikaans        Vanco…          1435
##  9 Non-Official &amp; Non-Aboriginal languages Afrikaans        Calga…           960
## 10 Non-Official &amp; Non-Aboriginal languages Afrikaans        Edmon…           575
## # ℹ 1,060 more rows</code></pre>
<blockquote>
<p><strong>Note</strong>: In the code above, the call to the
<code>pivot_longer</code> function is split across several lines. This is allowed in
certain cases; for example, when calling a function as above, as long as the
line ends with a comma <code>,</code> R knows to keep reading on the next line.
Splitting long lines like this across multiple lines is encouraged
as it helps significantly with code readability. Generally speaking, you should
limit each line of code to about 80 characters.</p>
</blockquote>
<p>The data above is now tidy because all three criteria for tidy data have now
been met:</p>
<ol style="list-style-type: decimal">
<li>All the variables (<code>category</code>, <code>language</code>, <code>region</code> and <code>mother_tongue</code>) are
now their own columns in the data frame.</li>
<li>Each observation, (i.e., each language in a region) is in a single row.</li>
<li>Each value is a single cell, i.e., its row, column position in the data
frame is not shared with another value.</li>
</ol>
</div>
<div id="pivot-wider" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Tidying up: going from long to wide using <code>pivot_wider</code><a href="wrangling.html#pivot-wider" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose we have observations spread across multiple rows rather than in a single
row. For example, in Figure <a href="wrangling.html#fig:long-to-wide">3.10</a>, the table on the left is in an
untidy, long format because the <code>count</code> column contains three variables
(population, commuter count, and year the city was incorporated)
and information about each observation
(here, population, commuter, and incorporated values for a region) is split across three rows.
Remember: one of the criteria for tidy data
is that each observation must be in a single row.</p>
<p>Using data in this format—where two or more variables are mixed together
in a single column—makes it harder to apply many usual <code>tidyverse</code> functions.
For example, finding the maximum number of commuters
would require an additional step of filtering for the commuter values
before the maximum can be computed.
In comparison, if the data were tidy,
all we would have to do is compute the maximum value for the commuter column.
To reshape this untidy data set to a tidy (and in this case, wider) format,
we need to create columns called “population”, “commuters”, and “incorporated.”
This is illustrated in the right table of Figure <a href="wrangling.html#fig:long-to-wide">3.10</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:long-to-wide"></span>
<img src="img/wrangling/pivot_functions.002.png" alt="Going from long to wide data." width="100%" />
<p class="caption">
Figure 3.10: Going from long to wide data.
</p>
</div>
<p>To tidy this type of data in R, we can use the <code>pivot_wider</code> function.
The <code>pivot_wider</code> function generally increases the number of columns (widens)
and decreases the number of rows in a data set.
To learn how to use <code>pivot_wider</code>,
we will work through an example
with the <code>region_lang_top5_cities_long.csv</code> data set.
This data set contains the number of Canadians reporting
the primary language at home and work for five
major cities (Toronto, Montréal, Vancouver, Calgary, and Edmonton).</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="wrangling.html#cb117-1" tabindex="-1"></a>lang_long <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/region_lang_top5_cities_long.csv&quot;</span>)</span>
<span id="cb117-2"><a href="wrangling.html#cb117-2" tabindex="-1"></a>lang_long</span></code></pre></div>
<pre><code>## # A tibble: 2,140 × 5
##    region    category             language                     type         count
##    &lt;chr&gt;     &lt;chr&gt;                &lt;chr&gt;                        &lt;chr&gt;        &lt;dbl&gt;
##  1 Montréal  Aboriginal languages Aboriginal languages, n.o.s. most_at_home    15
##  2 Montréal  Aboriginal languages Aboriginal languages, n.o.s. most_at_work     0
##  3 Toronto   Aboriginal languages Aboriginal languages, n.o.s. most_at_home    50
##  4 Toronto   Aboriginal languages Aboriginal languages, n.o.s. most_at_work     0
##  5 Calgary   Aboriginal languages Aboriginal languages, n.o.s. most_at_home     5
##  6 Calgary   Aboriginal languages Aboriginal languages, n.o.s. most_at_work     0
##  7 Edmonton  Aboriginal languages Aboriginal languages, n.o.s. most_at_home    10
##  8 Edmonton  Aboriginal languages Aboriginal languages, n.o.s. most_at_work     0
##  9 Vancouver Aboriginal languages Aboriginal languages, n.o.s. most_at_home    15
## 10 Vancouver Aboriginal languages Aboriginal languages, n.o.s. most_at_work     0
## # ℹ 2,130 more rows</code></pre>
<p>What makes the data set shown above untidy?
In this example, each observation is a language in a region.
However, each observation is split across multiple rows:
one where the count for <code>most_at_home</code> is recorded,
and the other where the count for <code>most_at_work</code> is recorded.
Suppose the goal with this data was to
visualize the relationship between the number of
Canadians reporting their primary language at home and work.
Doing that would be difficult with this data in its current form,
since these two variables are stored in the same column.
Figure <a href="wrangling.html#fig:img-pivot-wider-table">3.11</a> shows how this data
will be tidied using the <code>pivot_wider</code> function.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:img-pivot-wider-table"></span>
<img src="img/wrangling/pivot_functions.004.png" alt="Going from long to wide with the pivot_wider function." width="100%" />
<p class="caption">
Figure 3.11: Going from long to wide with the <code>pivot_wider</code> function.
</p>
</div>
<p>Figure <a href="wrangling.html#fig:img-pivot-wider">3.12</a> details the arguments that we need to specify
in the <code>pivot_wider</code> function.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:img-pivot-wider"></span>
<img src="_main_files/figure-html/img-pivot-wider-1.png" alt="Syntax for the pivot_wider function." width="100%"  />
<p class="caption">
Figure 3.12: Syntax for the <code>pivot_wider</code> function.
</p>
</div>
<p>We will apply the function as detailed in Figure <a href="wrangling.html#fig:img-pivot-wider">3.12</a>.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="wrangling.html#cb119-1" tabindex="-1"></a>lang_home_tidy <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(lang_long,</span>
<span id="cb119-2"><a href="wrangling.html#cb119-2" tabindex="-1"></a>  <span class="at">names_from =</span> type,</span>
<span id="cb119-3"><a href="wrangling.html#cb119-3" tabindex="-1"></a>  <span class="at">values_from =</span> count</span>
<span id="cb119-4"><a href="wrangling.html#cb119-4" tabindex="-1"></a>)</span>
<span id="cb119-5"><a href="wrangling.html#cb119-5" tabindex="-1"></a>lang_home_tidy</span></code></pre></div>
<pre><code>## # A tibble: 1,070 × 5
##    region    category                         language most_at_home most_at_work
##    &lt;chr&gt;     &lt;chr&gt;                            &lt;chr&gt;           &lt;dbl&gt;        &lt;dbl&gt;
##  1 Montréal  Aboriginal languages             Aborigi…           15            0
##  2 Toronto   Aboriginal languages             Aborigi…           50            0
##  3 Calgary   Aboriginal languages             Aborigi…            5            0
##  4 Edmonton  Aboriginal languages             Aborigi…           10            0
##  5 Vancouver Aboriginal languages             Aborigi…           15            0
##  6 Montréal  Non-Official &amp; Non-Aboriginal l… Afrikaa…           10            0
##  7 Toronto   Non-Official &amp; Non-Aboriginal l… Afrikaa…          265            0
##  8 Calgary   Non-Official &amp; Non-Aboriginal l… Afrikaa…          505           15
##  9 Edmonton  Non-Official &amp; Non-Aboriginal l… Afrikaa…          300            0
## 10 Vancouver Non-Official &amp; Non-Aboriginal l… Afrikaa…          520           10
## # ℹ 1,060 more rows</code></pre>
<p>The data above is now tidy! We can go through the three criteria again to check
that this data is a tidy data set.</p>
<ol style="list-style-type: decimal">
<li>All the statistical variables are their own columns in the data frame (i.e.,
<code>most_at_home</code>, and <code>most_at_work</code> have been separated into their own
columns in the data frame).</li>
<li>Each observation, (i.e., each language in a region) is in a single row.</li>
<li>Each value is a single cell (i.e., its row, column position in the data
frame is not shared with another value).</li>
</ol>
<p>You might notice that we have the same number of columns in the tidy data set as
we did in the messy one. Therefore <code>pivot_wider</code> didn’t really “widen” the data,
as the name suggests. This is just because the original <code>type</code> column only had
two categories in it. If it had more than two, <code>pivot_wider</code> would have created
more columns, and we would see the data set “widen.”</p>
</div>
<div id="separate" class="section level3 hasAnchor" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> Tidying up: using <code>separate</code> to deal with multiple delimiters<a href="wrangling.html#separate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Data are also not considered tidy when multiple values are stored in the same
cell. The data set we show below is even messier than the ones we dealt with
above: the <code>Toronto</code>, <code>Montréal</code>, <code>Vancouver</code>, <code>Calgary</code>, and <code>Edmonton</code> columns
contain the number of Canadians reporting their primary language at home and
work in one column separated by the delimiter (<code>/</code>). The column names are the
values of a variable, <em>and</em> each value does not have its own cell! To turn this
messy data into tidy data, we’ll have to fix these issues.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="wrangling.html#cb121-1" tabindex="-1"></a>lang_messy <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/region_lang_top5_cities_messy.csv&quot;</span>)</span>
<span id="cb121-2"><a href="wrangling.html#cb121-2" tabindex="-1"></a>lang_messy</span></code></pre></div>
<pre><code>## # A tibble: 214 × 7
##    category                 language Toronto Montréal Vancouver Calgary Edmonton
##    &lt;chr&gt;                    &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;   
##  1 Aboriginal languages     Aborigi… 50/0    15/0     15/0      5/0     10/0    
##  2 Non-Official &amp; Non-Abor… Afrikaa… 265/0   10/0     520/10    505/15  300/0   
##  3 Non-Official &amp; Non-Abor… Afro-As… 185/10  65/0     10/0      15/0    20/0    
##  4 Non-Official &amp; Non-Abor… Akan (T… 4045/20 440/0    125/10    330/0   445/0   
##  5 Non-Official &amp; Non-Abor… Albanian 6380/2… 1445/20  530/10    620/25  370/10  
##  6 Aboriginal languages     Algonqu… 5/0     0/0      0/0       0/0     0/0     
##  7 Aboriginal languages     Algonqu… 0/0     10/0     0/0       0/0     0/0     
##  8 Non-Official &amp; Non-Abor… America… 720/245 70/0     300/140   85/25   190/85  
##  9 Non-Official &amp; Non-Abor… Amharic  3820/55 315/0    540/10    2730/50 1695/35 
## 10 Non-Official &amp; Non-Abor… Arabic   45025/… 72980/1… 8680/275  11010/… 10590/3…
## # ℹ 204 more rows</code></pre>
<p>First we’ll use <code>pivot_longer</code> to create two columns, <code>region</code> and <code>value</code>,
similar to what we did previously.
The new <code>region</code> columns will contain the region names,
and the new column <code>value</code> will be a temporary holding place for the
data that we need to further separate, i.e., the
number of Canadians reporting their primary language at home and work.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="wrangling.html#cb123-1" tabindex="-1"></a>lang_messy_longer <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(lang_messy,</span>
<span id="cb123-2"><a href="wrangling.html#cb123-2" tabindex="-1"></a>  <span class="at">cols =</span> Toronto<span class="sc">:</span>Edmonton,</span>
<span id="cb123-3"><a href="wrangling.html#cb123-3" tabindex="-1"></a>  <span class="at">names_to =</span> <span class="st">&quot;region&quot;</span>,</span>
<span id="cb123-4"><a href="wrangling.html#cb123-4" tabindex="-1"></a>  <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span></span>
<span id="cb123-5"><a href="wrangling.html#cb123-5" tabindex="-1"></a>)</span>
<span id="cb123-6"><a href="wrangling.html#cb123-6" tabindex="-1"></a></span>
<span id="cb123-7"><a href="wrangling.html#cb123-7" tabindex="-1"></a>lang_messy_longer</span></code></pre></div>
<pre><code>## # A tibble: 1,070 × 4
##    category                                language                 region value
##    &lt;chr&gt;                                   &lt;chr&gt;                    &lt;chr&gt;  &lt;chr&gt;
##  1 Aboriginal languages                    Aboriginal languages, n… Toron… 50/0 
##  2 Aboriginal languages                    Aboriginal languages, n… Montr… 15/0 
##  3 Aboriginal languages                    Aboriginal languages, n… Vanco… 15/0 
##  4 Aboriginal languages                    Aboriginal languages, n… Calga… 5/0  
##  5 Aboriginal languages                    Aboriginal languages, n… Edmon… 10/0 
##  6 Non-Official &amp; Non-Aboriginal languages Afrikaans                Toron… 265/0
##  7 Non-Official &amp; Non-Aboriginal languages Afrikaans                Montr… 10/0 
##  8 Non-Official &amp; Non-Aboriginal languages Afrikaans                Vanco… 520/…
##  9 Non-Official &amp; Non-Aboriginal languages Afrikaans                Calga… 505/…
## 10 Non-Official &amp; Non-Aboriginal languages Afrikaans                Edmon… 300/0
## # ℹ 1,060 more rows</code></pre>
<p>Next we’ll use <code>separate</code> to split the <code>value</code> column into two columns.
One column will contain only the counts of Canadians
that speak each language most at home,
and the other will contain the counts of Canadians
that speak each language most at work for each region.
Figure <a href="wrangling.html#fig:img-separate">3.13</a>
outlines what we need to specify to use <code>separate</code>.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:img-separate"></span>
<img src="_main_files/figure-html/img-separate-1.png" alt="Syntax for the separate function." width="100%"  />
<p class="caption">
Figure 3.13: Syntax for the <code>separate</code> function.
</p>
</div>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="wrangling.html#cb125-1" tabindex="-1"></a>tidy_lang <span class="ot">&lt;-</span> <span class="fu">separate</span>(lang_messy_longer,</span>
<span id="cb125-2"><a href="wrangling.html#cb125-2" tabindex="-1"></a>  <span class="at">col =</span> value,</span>
<span id="cb125-3"><a href="wrangling.html#cb125-3" tabindex="-1"></a>  <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;most_at_home&quot;</span>, <span class="st">&quot;most_at_work&quot;</span>),</span>
<span id="cb125-4"><a href="wrangling.html#cb125-4" tabindex="-1"></a>  <span class="at">sep =</span> <span class="st">&quot;/&quot;</span></span>
<span id="cb125-5"><a href="wrangling.html#cb125-5" tabindex="-1"></a>)</span>
<span id="cb125-6"><a href="wrangling.html#cb125-6" tabindex="-1"></a></span>
<span id="cb125-7"><a href="wrangling.html#cb125-7" tabindex="-1"></a>tidy_lang</span></code></pre></div>
<pre><code>## # A tibble: 1,070 × 5
##    category                            language region most_at_home most_at_work
##    &lt;chr&gt;                               &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;        &lt;chr&gt;       
##  1 Aboriginal languages                Aborigi… Toron… 50           0           
##  2 Aboriginal languages                Aborigi… Montr… 15           0           
##  3 Aboriginal languages                Aborigi… Vanco… 15           0           
##  4 Aboriginal languages                Aborigi… Calga… 5            0           
##  5 Aboriginal languages                Aborigi… Edmon… 10           0           
##  6 Non-Official &amp; Non-Aboriginal lang… Afrikaa… Toron… 265          0           
##  7 Non-Official &amp; Non-Aboriginal lang… Afrikaa… Montr… 10           0           
##  8 Non-Official &amp; Non-Aboriginal lang… Afrikaa… Vanco… 520          10          
##  9 Non-Official &amp; Non-Aboriginal lang… Afrikaa… Calga… 505          15          
## 10 Non-Official &amp; Non-Aboriginal lang… Afrikaa… Edmon… 300          0           
## # ℹ 1,060 more rows</code></pre>
<p>Is this data set now tidy? If we recall the three criteria for tidy data:</p>
<ul>
<li>each row is a single observation,</li>
<li>each column is a single variable, and</li>
<li>each value is a single cell.</li>
</ul>
<p>We can see that this data now satisfies all three criteria, making it easier to
analyze. But we aren’t done yet! Notice in the table above that the word
<code>&lt;chr&gt;</code> appears beneath each of the column names. The word under the column name
indicates the data type of each column. Here all of the variables are
“character” data types. Recall, character data types are letter(s) or digits(s)
surrounded by quotes. In the previous example in Section <a href="wrangling.html#pivot-wider">3.4.2</a>, the
<code>most_at_home</code> and <code>most_at_work</code> variables were <code>&lt;dbl&gt;</code> (double)—you can
verify this by looking at the tables in the previous sections—which is a type
of numeric data. This change is due to the delimiter (<code>/</code>) when we read in this
messy data set. R read these columns in as character types, and by default,
<code>separate</code> will return columns as character data types.</p>
<p>It makes sense for <code>region</code>, <code>category</code>, and <code>language</code> to be stored as a
character (or perhaps factor) type. However, suppose we want to apply any functions that treat the
<code>most_at_home</code> and <code>most_at_work</code> columns as a number (e.g., finding rows
above a numeric threshold of a column).
In that case,
it won’t be possible to do if the variable is stored as a <code>character</code>.
Fortunately, the <code>separate</code> function provides a natural way to fix problems
like this: we can set <code>convert = TRUE</code> to convert the <code>most_at_home</code>
and <code>most_at_work</code> columns to the correct data type.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="wrangling.html#cb127-1" tabindex="-1"></a>tidy_lang <span class="ot">&lt;-</span> <span class="fu">separate</span>(lang_messy_longer,</span>
<span id="cb127-2"><a href="wrangling.html#cb127-2" tabindex="-1"></a>  <span class="at">col =</span> value,</span>
<span id="cb127-3"><a href="wrangling.html#cb127-3" tabindex="-1"></a>  <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;most_at_home&quot;</span>, <span class="st">&quot;most_at_work&quot;</span>),</span>
<span id="cb127-4"><a href="wrangling.html#cb127-4" tabindex="-1"></a>  <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>,</span>
<span id="cb127-5"><a href="wrangling.html#cb127-5" tabindex="-1"></a>  <span class="at">convert =</span> <span class="cn">TRUE</span></span>
<span id="cb127-6"><a href="wrangling.html#cb127-6" tabindex="-1"></a>)</span>
<span id="cb127-7"><a href="wrangling.html#cb127-7" tabindex="-1"></a></span>
<span id="cb127-8"><a href="wrangling.html#cb127-8" tabindex="-1"></a>tidy_lang</span></code></pre></div>
<pre><code>## # A tibble: 1,070 × 5
##    category                            language region most_at_home most_at_work
##    &lt;chr&gt;                               &lt;chr&gt;    &lt;chr&gt;         &lt;int&gt;        &lt;int&gt;
##  1 Aboriginal languages                Aborigi… Toron…           50            0
##  2 Aboriginal languages                Aborigi… Montr…           15            0
##  3 Aboriginal languages                Aborigi… Vanco…           15            0
##  4 Aboriginal languages                Aborigi… Calga…            5            0
##  5 Aboriginal languages                Aborigi… Edmon…           10            0
##  6 Non-Official &amp; Non-Aboriginal lang… Afrikaa… Toron…          265            0
##  7 Non-Official &amp; Non-Aboriginal lang… Afrikaa… Montr…           10            0
##  8 Non-Official &amp; Non-Aboriginal lang… Afrikaa… Vanco…          520           10
##  9 Non-Official &amp; Non-Aboriginal lang… Afrikaa… Calga…          505           15
## 10 Non-Official &amp; Non-Aboriginal lang… Afrikaa… Edmon…          300            0
## # ℹ 1,060 more rows</code></pre>
<p>Now we see <code>&lt;int&gt;</code> appears under the <code>most_at_home</code> and <code>most_at_work</code> columns,
indicating they are integer data types (i.e., numbers)!</p>
</div>
</div>
<div id="using-select-to-extract-a-range-of-columns" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Using <code>select</code> to extract a range of columns<a href="wrangling.html#using-select-to-extract-a-range-of-columns" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that the <code>tidy_lang</code> data is indeed <em>tidy</em>, we can start manipulating it
using the powerful suite of functions from the <code>tidyverse</code>.
For the first example, recall the <code>select</code> function from Chapter <a href="intro.html#intro">1</a>,
which lets us create a subset of columns from a data frame.
Suppose we wanted to select only the columns <code>language</code>, <code>region</code>,
<code>most_at_home</code> and <code>most_at_work</code> from the <code>tidy_lang</code> data set. Using what we
learned in Chapter <a href="intro.html#intro">1</a>, we would pass the <code>tidy_lang</code> data frame as
well as all of these column names into the <code>select</code> function:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="wrangling.html#cb129-1" tabindex="-1"></a>selected_columns <span class="ot">&lt;-</span> <span class="fu">select</span>(tidy_lang,</span>
<span id="cb129-2"><a href="wrangling.html#cb129-2" tabindex="-1"></a>                           language,</span>
<span id="cb129-3"><a href="wrangling.html#cb129-3" tabindex="-1"></a>                           region,</span>
<span id="cb129-4"><a href="wrangling.html#cb129-4" tabindex="-1"></a>                           most_at_home,</span>
<span id="cb129-5"><a href="wrangling.html#cb129-5" tabindex="-1"></a>                           most_at_work)</span>
<span id="cb129-6"><a href="wrangling.html#cb129-6" tabindex="-1"></a>selected_columns</span></code></pre></div>
<pre><code>## # A tibble: 1,070 × 4
##    language                     region    most_at_home most_at_work
##    &lt;chr&gt;                        &lt;chr&gt;            &lt;int&gt;        &lt;int&gt;
##  1 Aboriginal languages, n.o.s. Toronto             50            0
##  2 Aboriginal languages, n.o.s. Montréal            15            0
##  3 Aboriginal languages, n.o.s. Vancouver           15            0
##  4 Aboriginal languages, n.o.s. Calgary              5            0
##  5 Aboriginal languages, n.o.s. Edmonton            10            0
##  6 Afrikaans                    Toronto            265            0
##  7 Afrikaans                    Montréal            10            0
##  8 Afrikaans                    Vancouver          520           10
##  9 Afrikaans                    Calgary            505           15
## 10 Afrikaans                    Edmonton           300            0
## # ℹ 1,060 more rows</code></pre>
<p>Here we wrote out the names of each of the columns. However, this method is
time-consuming, especially if you have a lot of columns! Another approach is to
use a “select helper”. Select helpers are operators that make it easier for
us to select columns. For instance, we can use a select helper to choose a
range of columns rather than typing each column name out. To do this, we use the
colon (<code>:</code>) operator to denote the range. For example, to get all the columns in
the <code>tidy_lang</code> data frame from <code>language</code> to <code>most_at_work</code> we pass
<code>language:most_at_work</code> as the second argument to the <code>select</code> function.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="wrangling.html#cb131-1" tabindex="-1"></a>column_range <span class="ot">&lt;-</span> <span class="fu">select</span>(tidy_lang, language<span class="sc">:</span>most_at_work)</span>
<span id="cb131-2"><a href="wrangling.html#cb131-2" tabindex="-1"></a>column_range</span></code></pre></div>
<pre><code>## # A tibble: 1,070 × 4
##    language                     region    most_at_home most_at_work
##    &lt;chr&gt;                        &lt;chr&gt;            &lt;int&gt;        &lt;int&gt;
##  1 Aboriginal languages, n.o.s. Toronto             50            0
##  2 Aboriginal languages, n.o.s. Montréal            15            0
##  3 Aboriginal languages, n.o.s. Vancouver           15            0
##  4 Aboriginal languages, n.o.s. Calgary              5            0
##  5 Aboriginal languages, n.o.s. Edmonton            10            0
##  6 Afrikaans                    Toronto            265            0
##  7 Afrikaans                    Montréal            10            0
##  8 Afrikaans                    Vancouver          520           10
##  9 Afrikaans                    Calgary            505           15
## 10 Afrikaans                    Edmonton           300            0
## # ℹ 1,060 more rows</code></pre>
<p>Notice that we get the same output as we did above,
but with less (and clearer!) code. This type of operator
is especially handy for large data sets.</p>
<p>Suppose instead we wanted to extract columns that followed a particular pattern
rather than just selecting a range. For example, let’s say we wanted only to select the
columns <code>most_at_home</code> and <code>most_at_work</code>. There are other helpers that allow
us to select variables based on their names. In particular, we can use the <code>select</code> helper
<code>starts_with</code> to choose only the columns that start with the word “most”:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="wrangling.html#cb133-1" tabindex="-1"></a><span class="fu">select</span>(tidy_lang, <span class="fu">starts_with</span>(<span class="st">&quot;most&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 1,070 × 2
##    most_at_home most_at_work
##           &lt;int&gt;        &lt;int&gt;
##  1           50            0
##  2           15            0
##  3           15            0
##  4            5            0
##  5           10            0
##  6          265            0
##  7           10            0
##  8          520           10
##  9          505           15
## 10          300            0
## # ℹ 1,060 more rows</code></pre>
<p>We could also have chosen the columns containing an underscore <code>_</code> by adding
<code>contains("_")</code> as the second argument in the <code>select</code> function, since we notice
the columns we want contain underscores and the others don’t. </p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="wrangling.html#cb135-1" tabindex="-1"></a><span class="fu">select</span>(tidy_lang, <span class="fu">contains</span>(<span class="st">&quot;_&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 1,070 × 2
##    most_at_home most_at_work
##           &lt;int&gt;        &lt;int&gt;
##  1           50            0
##  2           15            0
##  3           15            0
##  4            5            0
##  5           10            0
##  6          265            0
##  7           10            0
##  8          520           10
##  9          505           15
## 10          300            0
## # ℹ 1,060 more rows</code></pre>
<p>There are many different <code>select</code> helpers that select
variables based on certain criteria.
The additional resources section at the end of this chapter
provides a comprehensive resource on <code>select</code> helpers.</p>
</div>
<div id="using-filter-to-extract-rows-1" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Using <code>filter</code> to extract rows<a href="wrangling.html#using-filter-to-extract-rows-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Next, we revisit the <code>filter</code> function from Chapter <a href="intro.html#intro">1</a>,
which lets us create a subset of rows from a data frame.
Recall the two main arguments to the <code>filter</code> function:
the first is the name of the data frame object, and
the second is a <em>logical statement</em> to use when filtering the rows.
<code>filter</code> works by returning the rows where the logical statement evaluates to <code>TRUE</code>.
This section will highlight more advanced usage of the <code>filter</code> function.
In particular, this section provides an in-depth treatment of the variety of logical statements
one can use in the <code>filter</code> function to select subsets of rows.
</p>
<div id="extracting-rows-that-have-a-certain-value-with" class="section level3 hasAnchor" number="3.6.1">
<h3><span class="header-section-number">3.6.1</span> Extracting rows that have a certain value with <code>==</code><a href="wrangling.html#extracting-rows-that-have-a-certain-value-with" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose we are only interested in the subset of rows in <code>tidy_lang</code> corresponding to the
official languages of Canada (English and French).
We can <code>filter</code> for these rows by using the <em>equivalency operator</em> (<code>==</code>)
to compare the values of the <code>category</code> column
with the value <code>"Official languages"</code>.
With these arguments, <code>filter</code> returns a data frame with all the columns
of the input data frame
but only the rows we asked for in the logical statement, i.e.,
those where the <code>category</code> column holds the value <code>"Official languages"</code>.
We name this data frame <code>official_langs</code>.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="wrangling.html#cb137-1" tabindex="-1"></a>official_langs <span class="ot">&lt;-</span> <span class="fu">filter</span>(tidy_lang, category <span class="sc">==</span> <span class="st">&quot;Official languages&quot;</span>)</span>
<span id="cb137-2"><a href="wrangling.html#cb137-2" tabindex="-1"></a>official_langs</span></code></pre></div>
<pre><code>## # A tibble: 10 × 5
##    category           language region    most_at_home most_at_work
##    &lt;chr&gt;              &lt;chr&gt;    &lt;chr&gt;            &lt;int&gt;        &lt;int&gt;
##  1 Official languages English  Toronto        3836770      3218725
##  2 Official languages English  Montréal        620510       412120
##  3 Official languages English  Vancouver      1622735      1330555
##  4 Official languages English  Calgary        1065070       844740
##  5 Official languages English  Edmonton       1050410       792700
##  6 Official languages French   Toronto          29800        11940
##  7 Official languages French   Montréal       2669195      1607550
##  8 Official languages French   Vancouver         8630         3245
##  9 Official languages French   Calgary           8630         2140
## 10 Official languages French   Edmonton         10950         2520</code></pre>
</div>
<div id="extracting-rows-that-do-not-have-a-certain-value-with" class="section level3 hasAnchor" number="3.6.2">
<h3><span class="header-section-number">3.6.2</span> Extracting rows that do not have a certain value with <code>!=</code><a href="wrangling.html#extracting-rows-that-do-not-have-a-certain-value-with" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>What if we want all the other language categories in the data set <em>except</em> for
those in the <code>"Official languages"</code> category? We can accomplish this with the <code>!=</code>
operator, which means “not equal to”. So if we want to find all the rows
where the <code>category</code> does <em>not</em> equal <code>"Official languages"</code> we write the code
below.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="wrangling.html#cb139-1" tabindex="-1"></a><span class="fu">filter</span>(tidy_lang, category <span class="sc">!=</span> <span class="st">&quot;Official languages&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1,060 × 5
##    category                            language region most_at_home most_at_work
##    &lt;chr&gt;                               &lt;chr&gt;    &lt;chr&gt;         &lt;int&gt;        &lt;int&gt;
##  1 Aboriginal languages                Aborigi… Toron…           50            0
##  2 Aboriginal languages                Aborigi… Montr…           15            0
##  3 Aboriginal languages                Aborigi… Vanco…           15            0
##  4 Aboriginal languages                Aborigi… Calga…            5            0
##  5 Aboriginal languages                Aborigi… Edmon…           10            0
##  6 Non-Official &amp; Non-Aboriginal lang… Afrikaa… Toron…          265            0
##  7 Non-Official &amp; Non-Aboriginal lang… Afrikaa… Montr…           10            0
##  8 Non-Official &amp; Non-Aboriginal lang… Afrikaa… Vanco…          520           10
##  9 Non-Official &amp; Non-Aboriginal lang… Afrikaa… Calga…          505           15
## 10 Non-Official &amp; Non-Aboriginal lang… Afrikaa… Edmon…          300            0
## # ℹ 1,050 more rows</code></pre>
</div>
<div id="filter-and" class="section level3 hasAnchor" number="3.6.3">
<h3><span class="header-section-number">3.6.3</span> Extracting rows satisfying multiple conditions using <code>,</code> or <code>&amp;</code><a href="wrangling.html#filter-and" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose now we want to look at only the rows
for the French language in Montréal.
To do this, we need to filter the data set
to find rows that satisfy multiple conditions simultaneously.
We can do this with the comma symbol (<code>,</code>), which in the case of <code>filter</code>
is interpreted by R as “and”.
We write the code as shown below to filter the <code>official_langs</code> data frame
to subset the rows where <code>region == "Montréal"</code>
<em>and</em> the <code>language == "French"</code>. </p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="wrangling.html#cb141-1" tabindex="-1"></a><span class="fu">filter</span>(official_langs, region <span class="sc">==</span> <span class="st">&quot;Montréal&quot;</span>, language <span class="sc">==</span> <span class="st">&quot;French&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 5
##   category           language region   most_at_home most_at_work
##   &lt;chr&gt;              &lt;chr&gt;    &lt;chr&gt;           &lt;int&gt;        &lt;int&gt;
## 1 Official languages French   Montréal      2669195      1607550</code></pre>
<p>We can also use the ampersand (<code>&amp;</code>) logical operator, which gives
us cases where <em>both</em> one condition <em>and</em> another condition
are satisfied. You can use either comma (<code>,</code>) or ampersand (<code>&amp;</code>) in the <code>filter</code>
function interchangeably.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="wrangling.html#cb143-1" tabindex="-1"></a><span class="fu">filter</span>(official_langs, region <span class="sc">==</span> <span class="st">&quot;Montréal&quot;</span> <span class="sc">&amp;</span> language <span class="sc">==</span> <span class="st">&quot;French&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 5
##   category           language region   most_at_home most_at_work
##   &lt;chr&gt;              &lt;chr&gt;    &lt;chr&gt;           &lt;int&gt;        &lt;int&gt;
## 1 Official languages French   Montréal      2669195      1607550</code></pre>
</div>
<div id="extracting-rows-satisfying-at-least-one-condition-using" class="section level3 hasAnchor" number="3.6.4">
<h3><span class="header-section-number">3.6.4</span> Extracting rows satisfying at least one condition using <code>|</code><a href="wrangling.html#extracting-rows-satisfying-at-least-one-condition-using" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose we were interested in only those rows corresponding to cities in Alberta
in the <code>official_langs</code> data set (Edmonton and Calgary).
We can’t use <code>,</code> as we did above because <code>region</code>
cannot be both Edmonton <em>and</em> Calgary simultaneously.
Instead, we can use the vertical pipe (<code>|</code>) logical operator,
which gives us the cases where one condition <em>or</em>
another condition <em>or</em> both are satisfied.
In the code below, we ask R to return the rows
where the <code>region</code> columns are equal to “Calgary” <em>or</em> “Edmonton”. </p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="wrangling.html#cb145-1" tabindex="-1"></a><span class="fu">filter</span>(official_langs, region <span class="sc">==</span> <span class="st">&quot;Calgary&quot;</span> <span class="sc">|</span> region <span class="sc">==</span> <span class="st">&quot;Edmonton&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 5
##   category           language region   most_at_home most_at_work
##   &lt;chr&gt;              &lt;chr&gt;    &lt;chr&gt;           &lt;int&gt;        &lt;int&gt;
## 1 Official languages English  Calgary       1065070       844740
## 2 Official languages English  Edmonton      1050410       792700
## 3 Official languages French   Calgary          8630         2140
## 4 Official languages French   Edmonton        10950         2520</code></pre>
</div>
<div id="extracting-rows-with-values-in-a-vector-using-in" class="section level3 hasAnchor" number="3.6.5">
<h3><span class="header-section-number">3.6.5</span> Extracting rows with values in a vector using <code>%in%</code><a href="wrangling.html#extracting-rows-with-values-in-a-vector-using-in" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next, suppose we want to see the populations of our five cities.
Let’s read in the <code>region_data.csv</code> file
that comes from the 2016 Canadian census,
as it contains statistics for number of households, land area, population
and number of dwellings for different regions.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="wrangling.html#cb147-1" tabindex="-1"></a>region_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/region_data.csv&quot;</span>)</span>
<span id="cb147-2"><a href="wrangling.html#cb147-2" tabindex="-1"></a>region_data</span></code></pre></div>
<pre><code>## # A tibble: 35 × 5
##    region         households  area population dwellings
##    &lt;chr&gt;               &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
##  1 Belleville          43002 1355.     103472     45050
##  2 Lethbridge          45696 3047.     117394     48317
##  3 Thunder Bay         52545 2618.     121621     57146
##  4 Peterborough        50533 1637.     121721     55662
##  5 Saint John          52872 3793.     126202     58398
##  6 Brantford           52530 1086.     134203     54419
##  7 Moncton             61769 2625.     144810     66699
##  8 Guelph              59280  604.     151984     63324
##  9 Trois-Rivières      72502 1053.     156042     77734
## 10 Saguenay            72479 3079.     160980     77968
## # ℹ 25 more rows</code></pre>
<p>To get the population of the five cities
we can filter the data set using the <code>%in%</code> operator.
The <code>%in%</code> operator is used to see if an element belongs to a vector.
Here we are filtering for rows where the value in the <code>region</code> column
matches any of the five cities we are intersted in: Toronto, Montréal,
Vancouver, Calgary, and Edmonton.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="wrangling.html#cb149-1" tabindex="-1"></a>city_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Toronto&quot;</span>, <span class="st">&quot;Montréal&quot;</span>, <span class="st">&quot;Vancouver&quot;</span>, <span class="st">&quot;Calgary&quot;</span>, <span class="st">&quot;Edmonton&quot;</span>)</span>
<span id="cb149-2"><a href="wrangling.html#cb149-2" tabindex="-1"></a>five_cities <span class="ot">&lt;-</span> <span class="fu">filter</span>(region_data,</span>
<span id="cb149-3"><a href="wrangling.html#cb149-3" tabindex="-1"></a>                      region <span class="sc">%in%</span> city_names)</span>
<span id="cb149-4"><a href="wrangling.html#cb149-4" tabindex="-1"></a>five_cities</span></code></pre></div>
<pre><code>## # A tibble: 5 × 5
##   region    households  area population dwellings
##   &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
## 1 Edmonton      502143 9858.    1321426    537634
## 2 Calgary       519693 5242.    1392609    544870
## 3 Vancouver     960894 3040.    2463431   1027613
## 4 Montréal     1727310 4638.    4098927   1823281
## 5 Toronto      2135909 6270.    5928040   2235145</code></pre>
<blockquote>
<p><strong>Note:</strong> What’s the difference between <code>==</code> and <code>%in%</code>? Suppose we have two
vectors, <code>vectorA</code> and <code>vectorB</code>. If you type <code>vectorA == vectorB</code> into R it
will compare the vectors element by element. R checks if the first element of
<code>vectorA</code> equals the first element of <code>vectorB</code>, the second element of
<code>vectorA</code> equals the second element of <code>vectorB</code>, and so on. On the other hand,
<code>vectorA %in% vectorB</code> compares the first element of <code>vectorA</code> to all the
elements in <code>vectorB</code>. Then the second element of <code>vectorA</code> is compared
to all the elements in <code>vectorB</code>, and so on. Notice the difference between <code>==</code> and
<code>%in%</code> in the example below.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="wrangling.html#cb151-1" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;Vancouver&quot;</span>, <span class="st">&quot;Toronto&quot;</span>) <span class="sc">==</span> <span class="fu">c</span>(<span class="st">&quot;Toronto&quot;</span>, <span class="st">&quot;Vancouver&quot;</span>)</span></code></pre></div>
<pre><code>## [1] FALSE FALSE</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="wrangling.html#cb153-1" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;Vancouver&quot;</span>, <span class="st">&quot;Toronto&quot;</span>) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Toronto&quot;</span>, <span class="st">&quot;Vancouver&quot;</span>)</span></code></pre></div>
<pre><code>## [1] TRUE TRUE</code></pre>
</blockquote>
</div>
<div id="extracting-rows-above-or-below-a-threshold-using-and" class="section level3 hasAnchor" number="3.6.6">
<h3><span class="header-section-number">3.6.6</span> Extracting rows above or below a threshold using <code>&gt;</code> and <code>&lt;</code><a href="wrangling.html#extracting-rows-above-or-below-a-threshold-using-and" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We saw in Section <a href="wrangling.html#filter-and">3.6.3</a> that
2,669,195 people reported
speaking French in Montréal as their primary language at home.
If we are interested in finding the official languages in regions
with higher numbers of people who speak it as their primary language at home
compared to French in Montréal, then we can use <code>filter</code> to obtain rows
where the value of <code>most_at_home</code> is greater than
2,669,195.
We use the <code>&gt;</code> symbol to look for values <em>above</em> a threshold, and the <code>&lt;</code> symbol
to look for values <em>below</em> a threshold. The <code>&gt;=</code> and <code>&lt;=</code> symbols similarly look
for <em>equal to or above</em> a threshold and <em>equal to or below</em> a
threshold. </p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="wrangling.html#cb155-1" tabindex="-1"></a><span class="fu">filter</span>(official_langs, most_at_home <span class="sc">&gt;</span> <span class="dv">2669195</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 5
##   category           language region  most_at_home most_at_work
##   &lt;chr&gt;              &lt;chr&gt;    &lt;chr&gt;          &lt;int&gt;        &lt;int&gt;
## 1 Official languages English  Toronto      3836770      3218725</code></pre>
<p><code>filter</code> returns a data frame with only one row, indicating that when
considering the official languages,
only English in Toronto is reported by more people
as their primary language at home
than French in Montréal according to the 2016 Canadian census.</p>
</div>
</div>
<div id="using-mutate-to-modify-or-add-columns" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Using <code>mutate</code> to modify or add columns<a href="wrangling.html#using-mutate-to-modify-or-add-columns" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="using-mutate-to-modify-columns" class="section level3 hasAnchor" number="3.7.1">
<h3><span class="header-section-number">3.7.1</span> Using <code>mutate</code> to modify columns<a href="wrangling.html#using-mutate-to-modify-columns" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In Section <a href="wrangling.html#separate">3.4.3</a>,
when we first read in the <code>"region_lang_top5_cities_messy.csv"</code> data,
all of the variables were “character” data types.
During the tidying process,
we used the <code>convert</code> argument from the <code>separate</code> function
to convert the <code>most_at_home</code> and <code>most_at_work</code> columns
to the desired integer (i.e., numeric class) data types.
But suppose we didn’t use the <code>convert</code> argument,
and needed to modify the column type some other way.
Below we create such a situation
so that we can demonstrate how to use <code>mutate</code>
to change the column types of a data frame.
<code>mutate</code> is a useful function to modify or create new data frame columns.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="wrangling.html#cb157-1" tabindex="-1"></a>lang_messy <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/region_lang_top5_cities_messy.csv&quot;</span>)</span>
<span id="cb157-2"><a href="wrangling.html#cb157-2" tabindex="-1"></a>lang_messy_longer <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(lang_messy,</span>
<span id="cb157-3"><a href="wrangling.html#cb157-3" tabindex="-1"></a>               <span class="at">cols =</span> Toronto<span class="sc">:</span>Edmonton,</span>
<span id="cb157-4"><a href="wrangling.html#cb157-4" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;region&quot;</span>,</span>
<span id="cb157-5"><a href="wrangling.html#cb157-5" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>)</span>
<span id="cb157-6"><a href="wrangling.html#cb157-6" tabindex="-1"></a>tidy_lang_chr <span class="ot">&lt;-</span> <span class="fu">separate</span>(lang_messy_longer, <span class="at">col =</span> value,</span>
<span id="cb157-7"><a href="wrangling.html#cb157-7" tabindex="-1"></a>           <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;most_at_home&quot;</span>, <span class="st">&quot;most_at_work&quot;</span>),</span>
<span id="cb157-8"><a href="wrangling.html#cb157-8" tabindex="-1"></a>           <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span>
<span id="cb157-9"><a href="wrangling.html#cb157-9" tabindex="-1"></a>official_langs_chr <span class="ot">&lt;-</span> <span class="fu">filter</span>(tidy_lang_chr, category <span class="sc">==</span> <span class="st">&quot;Official languages&quot;</span>)</span>
<span id="cb157-10"><a href="wrangling.html#cb157-10" tabindex="-1"></a></span>
<span id="cb157-11"><a href="wrangling.html#cb157-11" tabindex="-1"></a>official_langs_chr</span></code></pre></div>
<pre><code>## # A tibble: 10 × 5
##    category           language region    most_at_home most_at_work
##    &lt;chr&gt;              &lt;chr&gt;    &lt;chr&gt;     &lt;chr&gt;        &lt;chr&gt;       
##  1 Official languages English  Toronto   3836770      3218725     
##  2 Official languages English  Montréal  620510       412120      
##  3 Official languages English  Vancouver 1622735      1330555     
##  4 Official languages English  Calgary   1065070      844740      
##  5 Official languages English  Edmonton  1050410      792700      
##  6 Official languages French   Toronto   29800        11940       
##  7 Official languages French   Montréal  2669195      1607550     
##  8 Official languages French   Vancouver 8630         3245        
##  9 Official languages French   Calgary   8630         2140        
## 10 Official languages French   Edmonton  10950        2520</code></pre>
<p>To use <code>mutate</code>, again we first specify the data set in the first argument,
and in the following arguments,
we specify the name of the column we want to modify or create
(here <code>most_at_home</code> and <code>most_at_work</code>), an <code>=</code> sign,
and then the function we want to apply (here <code>as.numeric</code>).
In the function we want to apply,
we refer directly to the column name upon which we want it to act
(here <code>most_at_home</code> and <code>most_at_work</code>).
In our example, we are naming the columns the same
names as columns that already exist in the data frame
(“most_at_home”, “most_at_work”)
and this will cause <code>mutate</code> to <em>overwrite</em> those columns
(also referred to as modifying those columns <em>in-place</em>).
If we were to give the columns a new name,
then <code>mutate</code> would create new columns with the names we specified.
<code>mutate</code>’s general syntax is detailed in Figure <a href="wrangling.html#fig:img-mutate">3.14</a>.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:img-mutate"></span>
<img src="_main_files/figure-html/img-mutate-1.png" alt="Syntax for the mutate function." width="100%"  />
<p class="caption">
Figure 3.14: Syntax for the <code>mutate</code> function.
</p>
</div>
<p>Below we use <code>mutate</code> to convert the columns <code>most_at_home</code> and <code>most_at_work</code>
to numeric data types in the <code>official_langs</code> data set as described in Figure
<a href="wrangling.html#fig:img-mutate">3.14</a>:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="wrangling.html#cb159-1" tabindex="-1"></a>official_langs_numeric <span class="ot">&lt;-</span> <span class="fu">mutate</span>(official_langs_chr,</span>
<span id="cb159-2"><a href="wrangling.html#cb159-2" tabindex="-1"></a>  <span class="at">most_at_home =</span> <span class="fu">as.numeric</span>(most_at_home),</span>
<span id="cb159-3"><a href="wrangling.html#cb159-3" tabindex="-1"></a>  <span class="at">most_at_work =</span> <span class="fu">as.numeric</span>(most_at_work)</span>
<span id="cb159-4"><a href="wrangling.html#cb159-4" tabindex="-1"></a>)</span>
<span id="cb159-5"><a href="wrangling.html#cb159-5" tabindex="-1"></a></span>
<span id="cb159-6"><a href="wrangling.html#cb159-6" tabindex="-1"></a>official_langs_numeric</span></code></pre></div>
<pre><code>## # A tibble: 10 × 5
##    category           language region    most_at_home most_at_work
##    &lt;chr&gt;              &lt;chr&gt;    &lt;chr&gt;            &lt;dbl&gt;        &lt;dbl&gt;
##  1 Official languages English  Toronto        3836770      3218725
##  2 Official languages English  Montréal        620510       412120
##  3 Official languages English  Vancouver      1622735      1330555
##  4 Official languages English  Calgary        1065070       844740
##  5 Official languages English  Edmonton       1050410       792700
##  6 Official languages French   Toronto          29800        11940
##  7 Official languages French   Montréal       2669195      1607550
##  8 Official languages French   Vancouver         8630         3245
##  9 Official languages French   Calgary           8630         2140
## 10 Official languages French   Edmonton         10950         2520</code></pre>
<p>Now we see <code>&lt;dbl&gt;</code> appears under the <code>most_at_home</code> and <code>most_at_work</code> columns,
indicating they are double data types (which is a numeric data type)!</p>
</div>
<div id="using-mutate-to-create-new-columns" class="section level3 hasAnchor" number="3.7.2">
<h3><span class="header-section-number">3.7.2</span> Using <code>mutate</code> to create new columns<a href="wrangling.html#using-mutate-to-create-new-columns" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can see in the table that
3,836,770 people reported
speaking English in Toronto as their primary language at home, according to
the 2016 Canadian census. What does this number mean to us? To understand this
number, we need context. In particular, how many people were in Toronto when
this data was collected? From the 2016 Canadian census profile, the population
of Toronto was reported to be
5,928,040 people.
The number of people who report that English is their primary language at home
is much more meaningful when we report it in this context.
We can even go a step further and transform this count to a relative frequency
or proportion.
We can do this by dividing the number of people reporting a given language
as their primary language at home by the number of people who live in Toronto.
For example,
the proportion of people who reported that their primary language at home
was English in the 2016 Canadian census was
0.65
in Toronto.</p>
<p>Let’s use <code>mutate</code> to create a new column in our data frame
that holds the proportion of people who speak English
for our five cities of focus in this chapter.
To accomplish this, we will need to do two tasks
beforehand:</p>
<ol style="list-style-type: decimal">
<li>Create a vector containing the population values for the cities.</li>
<li>Filter the <code>official_langs</code> data frame
so that we only keep the rows where the language is English.</li>
</ol>
<p>To create a vector containing the population values for the five cities
(Toronto, Montréal, Vancouver, Calgary, Edmonton),
we will use the <code>c</code> function (recall that <code>c</code> stands for “concatenate”):</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="wrangling.html#cb161-1" tabindex="-1"></a>city_pops <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5928040</span>, <span class="dv">4098927</span>, <span class="dv">2463431</span>, <span class="dv">1392609</span>, <span class="dv">1321426</span>)</span>
<span id="cb161-2"><a href="wrangling.html#cb161-2" tabindex="-1"></a>city_pops</span></code></pre></div>
<pre><code>## [1] 5928040 4098927 2463431 1392609 1321426</code></pre>
<p>And next, we will filter the <code>official_langs</code> data frame
so that we only keep the rows where the language is English.
We will name the new data frame we get from this <code>english_langs</code>:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="wrangling.html#cb163-1" tabindex="-1"></a>english_langs <span class="ot">&lt;-</span> <span class="fu">filter</span>(official_langs, language <span class="sc">==</span> <span class="st">&quot;English&quot;</span>)</span>
<span id="cb163-2"><a href="wrangling.html#cb163-2" tabindex="-1"></a>english_langs</span></code></pre></div>
<pre><code>## # A tibble: 5 × 5
##   category           language region    most_at_home most_at_work
##   &lt;chr&gt;              &lt;chr&gt;    &lt;chr&gt;            &lt;int&gt;        &lt;int&gt;
## 1 Official languages English  Toronto        3836770      3218725
## 2 Official languages English  Montréal        620510       412120
## 3 Official languages English  Vancouver      1622735      1330555
## 4 Official languages English  Calgary        1065070       844740
## 5 Official languages English  Edmonton       1050410       792700</code></pre>
<p>Finally, we can use <code>mutate</code> to create a new column,
named <code>most_at_home_proportion</code>, that will have value that corresponds to
the proportion of people reporting English as their primary
language at home.
We will compute this by dividing the column by our vector of city populations.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="wrangling.html#cb165-1" tabindex="-1"></a>english_langs <span class="ot">&lt;-</span> <span class="fu">mutate</span>(english_langs,</span>
<span id="cb165-2"><a href="wrangling.html#cb165-2" tabindex="-1"></a>                         <span class="at">most_at_home_proportion =</span> most_at_home <span class="sc">/</span> city_pops)</span>
<span id="cb165-3"><a href="wrangling.html#cb165-3" tabindex="-1"></a></span>
<span id="cb165-4"><a href="wrangling.html#cb165-4" tabindex="-1"></a>english_langs</span></code></pre></div>
<pre><code>## # A tibble: 5 × 6
##   category      language region most_at_home most_at_work most_at_home_proport…¹
##   &lt;chr&gt;         &lt;chr&gt;    &lt;chr&gt;         &lt;int&gt;        &lt;int&gt;                  &lt;dbl&gt;
## 1 Official lan… English  Toron…      3836770      3218725                  0.647
## 2 Official lan… English  Montr…       620510       412120                  0.151
## 3 Official lan… English  Vanco…      1622735      1330555                  0.659
## 4 Official lan… English  Calga…      1065070       844740                  0.765
## 5 Official lan… English  Edmon…      1050410       792700                  0.795
## # ℹ abbreviated name: ¹​most_at_home_proportion</code></pre>
<p>In the computation above, we had to ensure that we ordered the <code>city_pops</code> vector in the
same order as the cities were listed in the <code>english_langs</code> data frame.
This is because R will perform the division computation we did by dividing
each element of the <code>most_at_home</code> column by each element of the
<code>city_pops</code> vector, matching them up by position.
Failing to do this would have resulted in the incorrect math being performed.</p>
<blockquote>
<p><strong>Note:</strong> In more advanced data wrangling,
one might solve this problem in a less error-prone way though using
a technique called “joins.”
We link to resources that discuss this in the additional
resources at the end of this chapter.</p>
</blockquote>
</div>
</div>
<div id="combining-functions-using-the-pipe-operator" class="section level2 hasAnchor" number="3.8">
<h2><span class="header-section-number">3.8</span> Combining functions using the pipe operator, <code>|&gt;</code><a href="wrangling.html#combining-functions-using-the-pipe-operator" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In R, we often have to call multiple functions in a sequence to process a data
frame. The basic ways of doing this can become quickly unreadable if there are
many steps. For example, suppose we need to perform three operations on a data
frame called <code>data</code>: </p>
<ol style="list-style-type: decimal">
<li>add a new column <code>new_col</code> that is double another <code>old_col</code>,</li>
<li>filter for rows where another column, <code>other_col</code>, is more than 5, and</li>
<li>select only the new column <code>new_col</code> for those rows.</li>
</ol>
<p>One way of performing these three steps is to just write
multiple lines of code, storing temporary objects as you go:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="wrangling.html#cb167-1" tabindex="-1"></a>output_1 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(data, <span class="at">new_col =</span> old_col <span class="sc">*</span> <span class="dv">2</span>)</span>
<span id="cb167-2"><a href="wrangling.html#cb167-2" tabindex="-1"></a>output_2 <span class="ot">&lt;-</span> <span class="fu">filter</span>(output_1, other_col <span class="sc">&gt;</span> <span class="dv">5</span>)</span>
<span id="cb167-3"><a href="wrangling.html#cb167-3" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">select</span>(output_2, new_col)</span></code></pre></div>
<p>This is difficult to understand for multiple reasons. The reader may be tricked
into thinking the named <code>output_1</code> and <code>output_2</code> objects are important for some
reason, while they are just temporary intermediate computations. Further, the
reader has to look through and find where <code>output_1</code> and <code>output_2</code> are used in
each subsequent line.</p>
<p>Another option for doing this would be to <em>compose</em> the functions:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="wrangling.html#cb168-1" tabindex="-1"></a>output <span class="ot">&lt;-</span> <span class="fu">select</span>(<span class="fu">filter</span>(<span class="fu">mutate</span>(data, <span class="at">new_col =</span> old_col <span class="sc">*</span> <span class="dv">2</span>),</span>
<span id="cb168-2"><a href="wrangling.html#cb168-2" tabindex="-1"></a>                        other_col <span class="sc">&gt;</span> <span class="dv">5</span>),</span>
<span id="cb168-3"><a href="wrangling.html#cb168-3" tabindex="-1"></a>                 new_col)</span></code></pre></div>
<p>Code like this can also be difficult to understand. Functions compose (reading
from left to right) in the <em>opposite order</em> in which they are computed by R
(above, <code>mutate</code> happens first, then <code>filter</code>, then <code>select</code>). It is also just a
really long line of code to read in one go.</p>
<p>The <em>pipe operator</em> (<code>|&gt;</code>) solves this problem, resulting in cleaner and
easier-to-follow code. <code>|&gt;</code> is built into R so you don’t need to load any
packages to use it.
You can think of the pipe as a physical pipe. It takes the output from the
function on the left-hand side of the pipe, and passes it as the first argument
to the function on the right-hand side of the pipe.
The code below accomplishes the same thing as the previous
two code blocks:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="wrangling.html#cb169-1" tabindex="-1"></a>output <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb169-2"><a href="wrangling.html#cb169-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new_col =</span> old_col <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb169-3"><a href="wrangling.html#cb169-3" tabindex="-1"></a>  <span class="fu">filter</span>(other_col <span class="sc">&gt;</span> <span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb169-4"><a href="wrangling.html#cb169-4" tabindex="-1"></a>  <span class="fu">select</span>(new_col)</span></code></pre></div>
<blockquote>
<p><strong>Note:</strong> You might also have noticed that we split the function calls across
lines after the pipe, similar to when we did this earlier in the chapter
for long function calls. Again, this is allowed and recommended, especially when
the piped function calls create a long line of code. Doing this makes
your code more readable. When you do this, it is important to end each line
with the pipe operator <code>|&gt;</code> to tell R that your code is continuing onto the
next line.</p>
</blockquote>
<blockquote>
<p><strong>Note:</strong> In this textbook, we will be using the base R pipe operator syntax, <code>|&gt;</code>.
This base R <code>|&gt;</code> pipe operator was inspired by a previous version of the pipe
operator, <code>%&gt;%</code>. The <code>%&gt;%</code> pipe operator is not built into R
and is from the <code>magrittr</code> R package.
The <code>tidyverse</code> metapackage imports the <code>%&gt;%</code> pipe operator via <code>dplyr</code>
(which in turn imports the <code>magrittr</code> R package).
There are some other differences between <code>%&gt;%</code> and <code>|&gt;</code> related to
more advanced R uses, such as sharing and distributing code as R packages,
however, these are beyond the scope of this textbook.
We have this note in the book to make the reader aware that <code>%&gt;%</code> exists
as it is still commonly used in data analysis code and in many data science
books and other resources.
In most cases these two pipes are interchangeable and either can be used.</p>
</blockquote>
<p></p>
<div id="using-to-combine-filter-and-select" class="section level3 hasAnchor" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Using <code>|&gt;</code> to combine <code>filter</code> and <code>select</code><a href="wrangling.html#using-to-combine-filter-and-select" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s work with the tidy <code>tidy_lang</code> data set from Section <a href="wrangling.html#separate">3.4.3</a>,
which contains the number of Canadians reporting their primary language at home
and work for five major cities
(Toronto, Montréal, Vancouver, Calgary, and Edmonton):</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="wrangling.html#cb170-1" tabindex="-1"></a>tidy_lang</span></code></pre></div>
<pre><code>## # A tibble: 1,070 × 5
##    category                            language region most_at_home most_at_work
##    &lt;chr&gt;                               &lt;chr&gt;    &lt;chr&gt;         &lt;int&gt;        &lt;int&gt;
##  1 Aboriginal languages                Aborigi… Toron…           50            0
##  2 Aboriginal languages                Aborigi… Montr…           15            0
##  3 Aboriginal languages                Aborigi… Vanco…           15            0
##  4 Aboriginal languages                Aborigi… Calga…            5            0
##  5 Aboriginal languages                Aborigi… Edmon…           10            0
##  6 Non-Official &amp; Non-Aboriginal lang… Afrikaa… Toron…          265            0
##  7 Non-Official &amp; Non-Aboriginal lang… Afrikaa… Montr…           10            0
##  8 Non-Official &amp; Non-Aboriginal lang… Afrikaa… Vanco…          520           10
##  9 Non-Official &amp; Non-Aboriginal lang… Afrikaa… Calga…          505           15
## 10 Non-Official &amp; Non-Aboriginal lang… Afrikaa… Edmon…          300            0
## # ℹ 1,060 more rows</code></pre>
<p>Suppose we want to create a subset of the data with only the languages and
counts of each language spoken most at home for the city of Vancouver. To do
this, we can use the functions <code>filter</code> and <code>select</code>. First, we use <code>filter</code> to
create a data frame called <code>van_data</code> that contains only values for Vancouver.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="wrangling.html#cb172-1" tabindex="-1"></a>van_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(tidy_lang, region <span class="sc">==</span> <span class="st">&quot;Vancouver&quot;</span>)</span>
<span id="cb172-2"><a href="wrangling.html#cb172-2" tabindex="-1"></a>van_data</span></code></pre></div>
<pre><code>## # A tibble: 214 × 5
##    category                            language region most_at_home most_at_work
##    &lt;chr&gt;                               &lt;chr&gt;    &lt;chr&gt;         &lt;int&gt;        &lt;int&gt;
##  1 Aboriginal languages                Aborigi… Vanco…           15            0
##  2 Non-Official &amp; Non-Aboriginal lang… Afrikaa… Vanco…          520           10
##  3 Non-Official &amp; Non-Aboriginal lang… Afro-As… Vanco…           10            0
##  4 Non-Official &amp; Non-Aboriginal lang… Akan (T… Vanco…          125           10
##  5 Non-Official &amp; Non-Aboriginal lang… Albanian Vanco…          530           10
##  6 Aboriginal languages                Algonqu… Vanco…            0            0
##  7 Aboriginal languages                Algonqu… Vanco…            0            0
##  8 Non-Official &amp; Non-Aboriginal lang… America… Vanco…          300          140
##  9 Non-Official &amp; Non-Aboriginal lang… Amharic  Vanco…          540           10
## 10 Non-Official &amp; Non-Aboriginal lang… Arabic   Vanco…         8680          275
## # ℹ 204 more rows</code></pre>
<p>We then use <code>select</code> on this data frame to keep only the variables we want:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="wrangling.html#cb174-1" tabindex="-1"></a>van_data_selected <span class="ot">&lt;-</span> <span class="fu">select</span>(van_data, language, most_at_home)</span>
<span id="cb174-2"><a href="wrangling.html#cb174-2" tabindex="-1"></a>van_data_selected</span></code></pre></div>
<pre><code>## # A tibble: 214 × 2
##    language                       most_at_home
##    &lt;chr&gt;                                 &lt;int&gt;
##  1 Aboriginal languages, n.o.s.             15
##  2 Afrikaans                               520
##  3 Afro-Asiatic languages, n.i.e.           10
##  4 Akan (Twi)                              125
##  5 Albanian                                530
##  6 Algonquian languages, n.i.e.              0
##  7 Algonquin                                 0
##  8 American Sign Language                  300
##  9 Amharic                                 540
## 10 Arabic                                 8680
## # ℹ 204 more rows</code></pre>
<p>Although this is valid code, there is a more readable approach we could take by
using the pipe, <code>|&gt;</code>. With the pipe, we do not need to create an intermediate
object to store the output from <code>filter</code>. Instead, we can directly send the
output of <code>filter</code> to the input of <code>select</code>:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="wrangling.html#cb176-1" tabindex="-1"></a>van_data_selected <span class="ot">&lt;-</span> <span class="fu">filter</span>(tidy_lang, region <span class="sc">==</span> <span class="st">&quot;Vancouver&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb176-2"><a href="wrangling.html#cb176-2" tabindex="-1"></a>        <span class="fu">select</span>(language, most_at_home)</span>
<span id="cb176-3"><a href="wrangling.html#cb176-3" tabindex="-1"></a></span>
<span id="cb176-4"><a href="wrangling.html#cb176-4" tabindex="-1"></a>van_data_selected</span></code></pre></div>
<pre><code>## # A tibble: 214 × 2
##    language                       most_at_home
##    &lt;chr&gt;                                 &lt;int&gt;
##  1 Aboriginal languages, n.o.s.             15
##  2 Afrikaans                               520
##  3 Afro-Asiatic languages, n.i.e.           10
##  4 Akan (Twi)                              125
##  5 Albanian                                530
##  6 Algonquian languages, n.i.e.              0
##  7 Algonquin                                 0
##  8 American Sign Language                  300
##  9 Amharic                                 540
## 10 Arabic                                 8680
## # ℹ 204 more rows</code></pre>
<p>But wait…Why do the <code>select</code> function calls
look different in these two examples?
Remember: when you use the pipe,
the output of the first function is automatically provided
as the first argument for the function that comes after it.
Therefore you do not specify the first argument in that function call.
In the code above,
The pipe passes the left-hand side (the output of <code>filter</code>) to the first argument of the function on the right (<code>select</code>),
so in the <code>select</code> function you only see the second argument (and beyond).
As you can see, both of these approaches—with and without pipes—give us the same output, but the second
approach is clearer and more readable.</p>
</div>
<div id="using-with-more-than-two-functions" class="section level3 hasAnchor" number="3.8.2">
<h3><span class="header-section-number">3.8.2</span> Using <code>|&gt;</code> with more than two functions<a href="wrangling.html#using-with-more-than-two-functions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The pipe operator (|&gt;) can be used with any function in R.
Additionally, we can pipe together more than two functions.
For example, we can pipe together three functions to:</p>
<ul>
<li><code>filter</code> rows to include only those where the counts of the language most spoken at home are greater than 10,000,</li>
<li><code>select</code> only the columns corresponding to <code>region</code>, <code>language</code> and <code>most_at_home</code>, and</li>
<li><code>arrange</code> the data frame rows in order by counts of the language most spoken at home
from smallest to largest.</li>
</ul>
<p>As we saw in Chapter <a href="intro.html#intro">1</a>,
we can use the <code>tidyverse</code> <code>arrange</code> function
to order the rows in the data frame by the values of one or more columns.
Here we pass the column name <code>most_at_home</code> to arrange the data frame rows by the values in that column, in ascending order.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="wrangling.html#cb178-1" tabindex="-1"></a>large_region_lang <span class="ot">&lt;-</span> <span class="fu">filter</span>(tidy_lang, most_at_home <span class="sc">&gt;</span> <span class="dv">10000</span>) <span class="sc">|&gt;</span></span>
<span id="cb178-2"><a href="wrangling.html#cb178-2" tabindex="-1"></a>  <span class="fu">select</span>(region, language, most_at_home) <span class="sc">|&gt;</span></span>
<span id="cb178-3"><a href="wrangling.html#cb178-3" tabindex="-1"></a>  <span class="fu">arrange</span>(most_at_home)</span>
<span id="cb178-4"><a href="wrangling.html#cb178-4" tabindex="-1"></a></span>
<span id="cb178-5"><a href="wrangling.html#cb178-5" tabindex="-1"></a>large_region_lang</span></code></pre></div>
<pre><code>## # A tibble: 67 × 3
##    region    language most_at_home
##    &lt;chr&gt;     &lt;chr&gt;           &lt;int&gt;
##  1 Edmonton  Arabic          10590
##  2 Montréal  Tamil           10670
##  3 Vancouver Russian         10795
##  4 Edmonton  Spanish         10880
##  5 Edmonton  French          10950
##  6 Calgary   Arabic          11010
##  7 Calgary   Urdu            11060
##  8 Vancouver Hindi           11235
##  9 Montréal  Armenian        11835
## 10 Toronto   Romanian        12200
## # ℹ 57 more rows</code></pre>
<p>You will notice above that we passed <code>tidy_lang</code> as the first argument of the <code>filter</code> function.
We can also pipe the data frame into the same sequence of functions rather than
using it as the first argument of the first function. These two choices are equivalent,
and we get the same result.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="wrangling.html#cb180-1" tabindex="-1"></a>large_region_lang <span class="ot">&lt;-</span> tidy_lang <span class="sc">|&gt;</span></span>
<span id="cb180-2"><a href="wrangling.html#cb180-2" tabindex="-1"></a>  <span class="fu">filter</span>(most_at_home <span class="sc">&gt;</span> <span class="dv">10000</span>) <span class="sc">|&gt;</span></span>
<span id="cb180-3"><a href="wrangling.html#cb180-3" tabindex="-1"></a>  <span class="fu">select</span>(region, language, most_at_home) <span class="sc">|&gt;</span></span>
<span id="cb180-4"><a href="wrangling.html#cb180-4" tabindex="-1"></a>  <span class="fu">arrange</span>(most_at_home)</span>
<span id="cb180-5"><a href="wrangling.html#cb180-5" tabindex="-1"></a></span>
<span id="cb180-6"><a href="wrangling.html#cb180-6" tabindex="-1"></a>large_region_lang</span></code></pre></div>
<pre><code>## # A tibble: 67 × 3
##    region    language most_at_home
##    &lt;chr&gt;     &lt;chr&gt;           &lt;int&gt;
##  1 Edmonton  Arabic          10590
##  2 Montréal  Tamil           10670
##  3 Vancouver Russian         10795
##  4 Edmonton  Spanish         10880
##  5 Edmonton  French          10950
##  6 Calgary   Arabic          11010
##  7 Calgary   Urdu            11060
##  8 Vancouver Hindi           11235
##  9 Montréal  Armenian        11835
## 10 Toronto   Romanian        12200
## # ℹ 57 more rows</code></pre>
<p>Now that we’ve shown you the pipe operator as an alternative to storing
temporary objects and composing code, does this mean you should <em>never</em> store
temporary objects or compose code? Not necessarily!
There are times when you will still want to do these things.
For example, you might store a temporary object before feeding it into a plot function
so you can iteratively change the plot without having to
redo all of your data transformations.
Additionally, piping many functions can be overwhelming and difficult to debug;
you may want to store a temporary object midway through to inspect your result
before moving on with further steps.</p>
</div>
</div>
<div id="aggregating-data-with-summarize-and-map" class="section level2 hasAnchor" number="3.9">
<h2><span class="header-section-number">3.9</span> Aggregating data with <code>summarize</code> and <code>map</code><a href="wrangling.html#aggregating-data-with-summarize-and-map" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="calculating-summary-statistics-on-whole-columns" class="section level3 hasAnchor" number="3.9.1">
<h3><span class="header-section-number">3.9.1</span> Calculating summary statistics on whole columns<a href="wrangling.html#calculating-summary-statistics-on-whole-columns" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As a part of many data analyses, we need to calculate a summary value for the
data (a <em>summary statistic</em>).
Examples of summary statistics we might want to calculate
are the number of observations, the average/mean value for a column,
the minimum value, etc.
Oftentimes,
this summary statistic is calculated from the values in a data frame column,
or columns, as shown in Figure <a href="wrangling.html#fig:summarize">3.15</a>.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:summarize"></span>
<img src="_main_files/figure-html/summarize-1.png" alt="summarize is useful for calculating summary statistics on one or more column(s). In its simplest use case, it creates a new data frame with a single row containing the summary statistic(s) for each column being summarized. The darker, top row of each table represents the column headers." width="85%" />
<p class="caption">
Figure 3.15: <code>summarize</code> is useful for calculating summary statistics on one or more column(s). In its simplest use case, it creates a new data frame with a single row containing the summary statistic(s) for each column being summarized. The darker, top row of each table represents the column headers.
</p>
</div>
<p>A useful <code>dplyr</code> function for calculating summary statistics is <code>summarize</code>,
where the first argument is the data frame and subsequent arguments
are the summaries we want to perform.
Here we show how to use the <code>summarize</code> function to calculate the minimum
and maximum number of Canadians
reporting a particular language as their primary language at home.
First a reminder of what <code>region_lang</code> looks like:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="wrangling.html#cb182-1" tabindex="-1"></a>region_lang</span></code></pre></div>
<pre><code>## # A tibble: 7,490 × 7
##    region   category language mother_tongue most_at_home most_at_work lang_known
##    &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;            &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;
##  1 St. Joh… Aborigi… Aborigi…             5            0            0          0
##  2 Halifax  Aborigi… Aborigi…             5            0            0          0
##  3 Moncton  Aborigi… Aborigi…             0            0            0          0
##  4 Saint J… Aborigi… Aborigi…             0            0            0          0
##  5 Saguenay Aborigi… Aborigi…             5            5            0          0
##  6 Québec   Aborigi… Aborigi…             0            5            0         20
##  7 Sherbro… Aborigi… Aborigi…             0            0            0          0
##  8 Trois-R… Aborigi… Aborigi…             0            0            0          0
##  9 Montréal Aborigi… Aborigi…            30           15            0         10
## 10 Kingston Aborigi… Aborigi…             0            0            0          0
## # ℹ 7,480 more rows</code></pre>
<p>We apply <code>summarize</code> to calculate the minimum
and maximum number of Canadians
reporting a particular language as their primary language at home,
for any region:</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="wrangling.html#cb184-1" tabindex="-1"></a><span class="fu">summarize</span>(region_lang,</span>
<span id="cb184-2"><a href="wrangling.html#cb184-2" tabindex="-1"></a>          <span class="at">min_most_at_home =</span> <span class="fu">min</span>(most_at_home),</span>
<span id="cb184-3"><a href="wrangling.html#cb184-3" tabindex="-1"></a>          <span class="at">max_most_at_home =</span> <span class="fu">max</span>(most_at_home))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   min_most_at_home max_most_at_home
##              &lt;dbl&gt;            &lt;dbl&gt;
## 1                0          3836770</code></pre>
<p>From this we see that there are some languages in the data set that no one speaks
as their primary language at home. We also see that the most commonly spoken
primary language at home is spoken by
3,836,770
people.</p>
</div>
<div id="calculating-summary-statistics-when-there-are-nas" class="section level3 hasAnchor" number="3.9.2">
<h3><span class="header-section-number">3.9.2</span> Calculating summary statistics when there are <code>NA</code>s<a href="wrangling.html#calculating-summary-statistics-when-there-are-nas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In data frames in R, the value <code>NA</code> is often used to denote missing data.
Many of the base R statistical summary functions
(e.g., <code>max</code>, <code>min</code>, <code>mean</code>, <code>sum</code>, etc) will return <code>NA</code>
when applied to columns containing <code>NA</code> values.
Usually that is not what we want to happen;
instead, we would usually like R to ignore the missing entries
and calculate the summary statistic using all of the other non-<code>NA</code> values
in the column.
Fortunately many of these functions provide an argument <code>na.rm</code> that lets
us tell the function what to do when it encounters <code>NA</code> values.
In particular, if we specify <code>na.rm = TRUE</code>, the function will ignore
missing values and return a summary of all the non-missing entries.
We show an example of this combined with <code>summarize</code> below.</p>
<p>First we create a new version of the <code>region_lang</code> data frame,
named <code>region_lang_na</code>, that has a seemingly innocuous <code>NA</code>
in the first row of the <code>most_at_home column</code>:</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="wrangling.html#cb186-1" tabindex="-1"></a>region_lang_na</span></code></pre></div>
<pre><code>## # A tibble: 7,490 × 7
##    region   category language mother_tongue most_at_home most_at_work lang_known
##    &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;            &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;
##  1 St. Joh… Aborigi… Aborigi…             5           NA            0          0
##  2 Halifax  Aborigi… Aborigi…             5            0            0          0
##  3 Moncton  Aborigi… Aborigi…             0            0            0          0
##  4 Saint J… Aborigi… Aborigi…             0            0            0          0
##  5 Saguenay Aborigi… Aborigi…             5            5            0          0
##  6 Québec   Aborigi… Aborigi…             0            5            0         20
##  7 Sherbro… Aborigi… Aborigi…             0            0            0          0
##  8 Trois-R… Aborigi… Aborigi…             0            0            0          0
##  9 Montréal Aborigi… Aborigi…            30           15            0         10
## 10 Kingston Aborigi… Aborigi…             0            0            0          0
## # ℹ 7,480 more rows</code></pre>
<p>Now if we apply the <code>summarize</code> function as above,
we see that we no longer get the minimum and maximum returned,
but just an <code>NA</code> instead!</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="wrangling.html#cb188-1" tabindex="-1"></a><span class="fu">summarize</span>(region_lang_na,</span>
<span id="cb188-2"><a href="wrangling.html#cb188-2" tabindex="-1"></a>          <span class="at">min_most_at_home =</span> <span class="fu">min</span>(most_at_home),</span>
<span id="cb188-3"><a href="wrangling.html#cb188-3" tabindex="-1"></a>          <span class="at">max_most_at_home =</span> <span class="fu">max</span>(most_at_home))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   min_most_at_home max_most_at_home
##              &lt;dbl&gt;            &lt;dbl&gt;
## 1               NA               NA</code></pre>
<p>We can fix this by adding the <code>na.rm = TRUE</code> as explained above:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="wrangling.html#cb190-1" tabindex="-1"></a><span class="fu">summarize</span>(region_lang_na,</span>
<span id="cb190-2"><a href="wrangling.html#cb190-2" tabindex="-1"></a>          <span class="at">min_most_at_home =</span> <span class="fu">min</span>(most_at_home, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb190-3"><a href="wrangling.html#cb190-3" tabindex="-1"></a>          <span class="at">max_most_at_home =</span> <span class="fu">max</span>(most_at_home, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   min_most_at_home max_most_at_home
##              &lt;dbl&gt;            &lt;dbl&gt;
## 1                0          3836770</code></pre>
</div>
<div id="calculating-summary-statistics-for-groups-of-rows" class="section level3 hasAnchor" number="3.9.3">
<h3><span class="header-section-number">3.9.3</span> Calculating summary statistics for groups of rows<a href="wrangling.html#calculating-summary-statistics-for-groups-of-rows" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A common pairing with <code>summarize</code> is <code>group_by</code>. Pairing these functions
together can let you summarize values for subgroups within a data set,
as illustrated in Figure <a href="wrangling.html#fig:summarize-groupby">3.16</a>.
For example, we can use <code>group_by</code> to group the regions of the <code>region_lang</code> data frame and then calculate the minimum and maximum number of Canadians
reporting the language as the primary language at home
for each of the regions in the data set.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:summarize-groupby"></span>
<img src="_main_files/figure-html/summarize-groupby-1.png" alt="summarize and group_by is useful for calculating summary statistics on one or more column(s) for each group. It creates a new data frame—with one row for each group—containing the summary statistic(s) for each column being summarized. It also creates a column listing the value of the grouping variable. The darker, top row of each table represents the column headers. The orange, blue, and green colored rows correspond to the rows that belong to each of the three groups being represented in this cartoon example." width="85%" />
<p class="caption">
Figure 3.16: <code>summarize</code> and <code>group_by</code> is useful for calculating summary statistics on one or more column(s) for each group. It creates a new data frame—with one row for each group—containing the summary statistic(s) for each column being summarized. It also creates a column listing the value of the grouping variable. The darker, top row of each table represents the column headers. The orange, blue, and green colored rows correspond to the rows that belong to each of the three groups being represented in this cartoon example.
</p>
</div>
<p>The <code>group_by</code> function takes at least two arguments. The first is the data
frame that will be grouped, and the second and onwards are columns to use in the
grouping. Here we use only one column for grouping (<code>region</code>), but more than one
can also be used. To do this, list additional columns separated by commas.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="wrangling.html#cb192-1" tabindex="-1"></a><span class="fu">group_by</span>(region_lang, region) <span class="sc">|&gt;</span></span>
<span id="cb192-2"><a href="wrangling.html#cb192-2" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb192-3"><a href="wrangling.html#cb192-3" tabindex="-1"></a>    <span class="at">min_most_at_home =</span> <span class="fu">min</span>(most_at_home),</span>
<span id="cb192-4"><a href="wrangling.html#cb192-4" tabindex="-1"></a>    <span class="at">max_most_at_home =</span> <span class="fu">max</span>(most_at_home)</span>
<span id="cb192-5"><a href="wrangling.html#cb192-5" tabindex="-1"></a>    )</span></code></pre></div>
<pre><code>## # A tibble: 35 × 3
##    region               min_most_at_home max_most_at_home
##    &lt;chr&gt;                           &lt;dbl&gt;            &lt;dbl&gt;
##  1 Abbotsford - Mission                0           137445
##  2 Barrie                              0           182390
##  3 Belleville                          0            97840
##  4 Brantford                           0           124560
##  5 Calgary                             0          1065070
##  6 Edmonton                            0          1050410
##  7 Greater Sudbury                     0           133960
##  8 Guelph                              0           130950
##  9 Halifax                             0           371215
## 10 Hamilton                            0           630380
## # ℹ 25 more rows</code></pre>
<p>Notice that <code>group_by</code> on its own doesn’t change the way the data looks.
In the output below, the grouped data set looks the same,
and it doesn’t <em>appear</em> to be grouped by <code>region</code>.
Instead, <code>group_by</code> simply changes how other functions work with the data,
as we saw with <code>summarize</code> above.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="wrangling.html#cb194-1" tabindex="-1"></a><span class="fu">group_by</span>(region_lang, region)</span></code></pre></div>
<pre><code>## # A tibble: 7,490 × 7
## # Groups:   region [35]
##    region   category language mother_tongue most_at_home most_at_work lang_known
##    &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;            &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;
##  1 St. Joh… Aborigi… Aborigi…             5            0            0          0
##  2 Halifax  Aborigi… Aborigi…             5            0            0          0
##  3 Moncton  Aborigi… Aborigi…             0            0            0          0
##  4 Saint J… Aborigi… Aborigi…             0            0            0          0
##  5 Saguenay Aborigi… Aborigi…             5            5            0          0
##  6 Québec   Aborigi… Aborigi…             0            5            0         20
##  7 Sherbro… Aborigi… Aborigi…             0            0            0          0
##  8 Trois-R… Aborigi… Aborigi…             0            0            0          0
##  9 Montréal Aborigi… Aborigi…            30           15            0         10
## 10 Kingston Aborigi… Aborigi…             0            0            0          0
## # ℹ 7,480 more rows</code></pre>
</div>
<div id="calculating-summary-statistics-on-many-columns" class="section level3 hasAnchor" number="3.9.4">
<h3><span class="header-section-number">3.9.4</span> Calculating summary statistics on many columns<a href="wrangling.html#calculating-summary-statistics-on-many-columns" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Sometimes we need to summarize statistics across many columns.
An example of this is illustrated in Figure <a href="wrangling.html#fig:summarize-across">3.17</a>.
In such a case, using <code>summarize</code> alone means that we have to
type out the name of each column we want to summarize.
In this section we will meet two strategies for performing this task.
First we will see how we can do this using <code>summarize</code> + <code>across</code>.
Then we will also explore how we can use a more general iteration function,
<code>map</code>, to also accomplish this.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:summarize-across"></span>
<img src="_main_files/figure-html/summarize-across-1.png" alt="summarize + across or map is useful for efficiently calculating summary statistics on many columns at once. The darker, top row of each table represents the column headers." width="85%"  />
<p class="caption">
Figure 3.17: <code>summarize</code> + <code>across</code> or <code>map</code> is useful for efficiently calculating summary statistics on many columns at once. The darker, top row of each table represents the column headers.
</p>
</div>
<div id="summarize-and-across-for-calculating-summary-statistics-on-many-columns" class="section level4 unnumbered hasAnchor">
<h4><code>summarize</code> and <code>across</code> for calculating summary statistics on many columns<a href="wrangling.html#summarize-and-across-for-calculating-summary-statistics-on-many-columns" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To summarize statistics across many columns, we can use the
<code>summarize</code> function we have just recently learned about.
However, in such a case, using <code>summarize</code> alone means that we have to
type out the name of each column we want to summarize.
To do this more efficiently, we can pair <code>summarize</code> with <code>across</code>
and use a colon <code>:</code> to specify a range of columns we would like
to perform the statistical summaries on.
Here we demonstrate finding the maximum value
of each of the numeric
columns of the <code>region_lang</code> data set.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="wrangling.html#cb196-1" tabindex="-1"></a>region_lang <span class="sc">|&gt;</span></span>
<span id="cb196-2"><a href="wrangling.html#cb196-2" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(mother_tongue<span class="sc">:</span>lang_known, max))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 4
##   mother_tongue most_at_home most_at_work lang_known
##           &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;
## 1       3061820      3836770      3218725    5600480</code></pre>
<blockquote>
<p><strong>Note:</strong> Similar to when we use base R statistical summary functions
(e.g., <code>max</code>, <code>min</code>, <code>mean</code>, <code>sum</code>, etc) with <code>summarize</code> alone,
the use of the <code>summarize</code> + <code>across</code> functions paired
with base R statistical summary functions
also return <code>NA</code>s when we apply them to columns that
contain <code>NA</code>s in the data frame. </p>
<p>To resolve this issue, again we need to add the argument <code>na.rm = TRUE</code>.
But in this case we need to use it a little bit differently:
we write a <code>~</code>, and then call the summary function
with the first argument <code>.x</code> and the second argument <code>na.rm = TRUE</code>.
For example, for the previous example with the <code>max</code> function, we would write</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="wrangling.html#cb198-1" tabindex="-1"></a>region_lang_na <span class="sc">|&gt;</span></span>
<span id="cb198-2"><a href="wrangling.html#cb198-2" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="fu">across</span>(mother_tongue<span class="sc">:</span>lang_known, <span class="sc">~</span> <span class="fu">max</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 4
##   mother_tongue most_at_home most_at_work lang_known
##           &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;
## 1       3061820      3836770      3218725    5600480</code></pre>
<p>The meaning of this unusual syntax is a bit beyond the scope of this book,
but interested readers can look up <em>anonymous functions</em> in the <code>purrr</code>
package from <code>tidyverse</code>.</p>
</blockquote>
</div>
<div id="map-for-calculating-summary-statistics-on-many-columns" class="section level4 unnumbered hasAnchor">
<h4><code>map</code> for calculating summary statistics on many columns<a href="wrangling.html#map-for-calculating-summary-statistics-on-many-columns" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>An alternative to <code>summarize</code> and <code>across</code>
for applying a function to many columns is the <code>map</code> family of functions.
Let’s again find the maximum value of each column of the
<code>region_lang</code> data frame, but using <code>map</code> with the <code>max</code> function this time.
<code>map</code> takes two arguments:
an object (a vector, data frame or list) that you want to apply the function to,
and the function that you would like to apply to each column.
Note that <code>map</code> does not have an argument
to specify <em>which</em> columns to apply the function to.
Therefore, we will use the <code>select</code> function before calling <code>map</code>
to choose the columns for which we want the maximum.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="wrangling.html#cb200-1" tabindex="-1"></a>region_lang <span class="sc">|&gt;</span></span>
<span id="cb200-2"><a href="wrangling.html#cb200-2" tabindex="-1"></a>  <span class="fu">select</span>(mother_tongue<span class="sc">:</span>lang_known) <span class="sc">|&gt;</span></span>
<span id="cb200-3"><a href="wrangling.html#cb200-3" tabindex="-1"></a>  <span class="fu">map</span>(max)</span></code></pre></div>
<pre><code>## $mother_tongue
## [1] 3061820
## 
## $most_at_home
## [1] 3836770
## 
## $most_at_work
## [1] 3218725
## 
## $lang_known
## [1] 5600480</code></pre>
<blockquote>
<p><strong>Note:</strong> The <code>map</code> function comes from the <code>purrr</code> package. But since
<code>purrr</code> is part of the tidyverse, once we call <code>library(tidyverse)</code> we
do not need to load the <code>purrr</code> package separately.</p>
</blockquote>
<p>The output looks a bit weird… we passed in a data frame, but the output
doesn’t look like a data frame. As it so happens, it is <em>not</em> a data frame, but
rather a plain list:</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="wrangling.html#cb202-1" tabindex="-1"></a>region_lang <span class="sc">|&gt;</span></span>
<span id="cb202-2"><a href="wrangling.html#cb202-2" tabindex="-1"></a>  <span class="fu">select</span>(mother_tongue<span class="sc">:</span>lang_known) <span class="sc">|&gt;</span></span>
<span id="cb202-3"><a href="wrangling.html#cb202-3" tabindex="-1"></a>  <span class="fu">map</span>(max) <span class="sc">|&gt;</span></span>
<span id="cb202-4"><a href="wrangling.html#cb202-4" tabindex="-1"></a>  <span class="fu">typeof</span>()</span></code></pre></div>
<pre><code>## [1] &quot;list&quot;</code></pre>
<p>So what do we do? Should we convert this to a data frame? We could, but a
simpler alternative is to just use a different <code>map</code> function. There
are quite a few to choose from, they all work similarly, but
their name reflects the type of output you want from the mapping operation.
Table <a href="wrangling.html#tab:map-table">3.3</a> lists the commonly used <code>map</code> functions as well
as their output type. </p>
<table>
<caption><span id="tab:map-table">Table 3.3: </span> The <code>map</code> functions in R.</caption>
<thead>
<tr class="header">
<th><code>map</code> function</th>
<th>Output</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>map</code></td>
<td>list</td>
</tr>
<tr class="even">
<td><code>map_lgl</code></td>
<td>logical vector</td>
</tr>
<tr class="odd">
<td><code>map_int</code></td>
<td>integer vector</td>
</tr>
<tr class="even">
<td><code>map_dbl</code></td>
<td>double vector</td>
</tr>
<tr class="odd">
<td><code>map_chr</code></td>
<td>character vector</td>
</tr>
<tr class="even">
<td><code>map_dfc</code></td>
<td>data frame, combining column-wise</td>
</tr>
<tr class="odd">
<td><code>map_dfr</code></td>
<td>data frame, combining row-wise</td>
</tr>
</tbody>
</table>
<p>Let’s get the columns’ maximums again, but this time use the <code>map_dfr</code> function
to return the output as a data frame:</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="wrangling.html#cb204-1" tabindex="-1"></a>region_lang <span class="sc">|&gt;</span></span>
<span id="cb204-2"><a href="wrangling.html#cb204-2" tabindex="-1"></a>  <span class="fu">select</span>(mother_tongue<span class="sc">:</span>lang_known) <span class="sc">|&gt;</span></span>
<span id="cb204-3"><a href="wrangling.html#cb204-3" tabindex="-1"></a>  <span class="fu">map_dfr</span>(max)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 4
##   mother_tongue most_at_home most_at_work lang_known
##           &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;
## 1       3061820      3836770      3218725    5600480</code></pre>
<blockquote>
<p><strong>Note:</strong> Similar to when we use base R statistical summary functions
(e.g., <code>max</code>, <code>min</code>, <code>mean</code>, <code>sum</code>, etc.) with <code>summarize</code>,
<code>map</code> functions paired with base R statistical summary functions
also return <code>NA</code> values when we apply them to columns that
contain <code>NA</code> values. </p>
<p>To avoid this, again we need to add the argument <code>na.rm = TRUE</code>.
When we use this with <code>map</code>, we do this by adding a <code>,</code>
and then <code>na.rm = TRUE</code> after specifying the function, as illustrated below:</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="wrangling.html#cb206-1" tabindex="-1"></a>region_lang_na <span class="sc">|&gt;</span></span>
<span id="cb206-2"><a href="wrangling.html#cb206-2" tabindex="-1"></a>  <span class="fu">select</span>(mother_tongue<span class="sc">:</span>lang_known) <span class="sc">|&gt;</span></span>
<span id="cb206-3"><a href="wrangling.html#cb206-3" tabindex="-1"></a>  <span class="fu">map_dfr</span>(max, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 4
##   mother_tongue most_at_home most_at_work lang_known
##           &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;
## 1       3061820      3836770      3218725    5600480</code></pre>
</blockquote>
<p>The <code>map</code> functions are generally quite useful for solving many problems
involving repeatedly applying functions in R.
Additionally, their use is not limited to columns of a data frame;
<code>map</code> family functions can be used to apply functions to elements of a vector,
or a list, and even to lists of (nested!) data frames.
To learn more about the <code>map</code> functions, see the additional resources
section at the end of this chapter.</p>
</div>
</div>
</div>
<div id="apply-functions-across-many-columns-with-mutate-and-across" class="section level2 hasAnchor" number="3.10">
<h2><span class="header-section-number">3.10</span> Apply functions across many columns with <code>mutate</code> and <code>across</code><a href="wrangling.html#apply-functions-across-many-columns-with-mutate-and-across" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Sometimes we need to apply a function to many columns in a data frame.
For example, we would need to do this when converting units of measurements across many columns.
We illustrate such a data transformation in Figure <a href="wrangling.html#fig:mutate-across">3.18</a>.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:mutate-across"></span>
<img src="_main_files/figure-html/mutate-across-1.png" alt="mutate and across is useful for applying functions across many columns. The darker, top row of each table represents the column headers." width="85%" />
<p class="caption">
Figure 3.18: <code>mutate</code> and <code>across</code> is useful for applying functions across many columns. The darker, top row of each table represents the column headers.
</p>
</div>
<p>For example,
imagine that we wanted to convert all the numeric columns
in the <code>region_lang</code> data frame from double type to integer type
using the <code>as.integer</code> function.
When we revisit the <code>region_lang</code> data frame,
we can see that this would be the columns from <code>mother_tongue</code> to <code>lang_known</code>.</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="wrangling.html#cb208-1" tabindex="-1"></a>region_lang</span></code></pre></div>
<pre><code>## # A tibble: 7,490 × 7
##    region   category language mother_tongue most_at_home most_at_work lang_known
##    &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;            &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;
##  1 St. Joh… Aborigi… Aborigi…             5            0            0          0
##  2 Halifax  Aborigi… Aborigi…             5            0            0          0
##  3 Moncton  Aborigi… Aborigi…             0            0            0          0
##  4 Saint J… Aborigi… Aborigi…             0            0            0          0
##  5 Saguenay Aborigi… Aborigi…             5            5            0          0
##  6 Québec   Aborigi… Aborigi…             0            5            0         20
##  7 Sherbro… Aborigi… Aborigi…             0            0            0          0
##  8 Trois-R… Aborigi… Aborigi…             0            0            0          0
##  9 Montréal Aborigi… Aborigi…            30           15            0         10
## 10 Kingston Aborigi… Aborigi…             0            0            0          0
## # ℹ 7,480 more rows</code></pre>
<p>To accomplish such a task, we can use <code>mutate</code> paired with <code>across</code>.
This works in a similar way for column selection,
as we saw when we used <code>summarize</code> + <code>across</code> earlier.
As we did above,
we again use <code>across</code> to specify the columns using <code>select</code> syntax
as well as the function we want to apply on the specified columns.
However, a key difference here is that we are using <code>mutate</code>,
which means that we get back a data frame with the same number of columns and rows.
The only thing that changes is the transformation we applied
to the specified columns (here <code>mother_tongue</code> to <code>lang_known</code>).</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="wrangling.html#cb210-1" tabindex="-1"></a>region_lang <span class="sc">|&gt;</span></span>
<span id="cb210-2"><a href="wrangling.html#cb210-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(mother_tongue<span class="sc">:</span>lang_known, as.integer))</span></code></pre></div>
<pre><code>## # A tibble: 7,490 × 7
##    region   category language mother_tongue most_at_home most_at_work lang_known
##    &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;            &lt;int&gt;        &lt;int&gt;        &lt;int&gt;      &lt;int&gt;
##  1 St. Joh… Aborigi… Aborigi…             5            0            0          0
##  2 Halifax  Aborigi… Aborigi…             5            0            0          0
##  3 Moncton  Aborigi… Aborigi…             0            0            0          0
##  4 Saint J… Aborigi… Aborigi…             0            0            0          0
##  5 Saguenay Aborigi… Aborigi…             5            5            0          0
##  6 Québec   Aborigi… Aborigi…             0            5            0         20
##  7 Sherbro… Aborigi… Aborigi…             0            0            0          0
##  8 Trois-R… Aborigi… Aborigi…             0            0            0          0
##  9 Montréal Aborigi… Aborigi…            30           15            0         10
## 10 Kingston Aborigi… Aborigi…             0            0            0          0
## # ℹ 7,480 more rows</code></pre>
</div>
<div id="apply-functions-across-columns-within-one-row-with-rowwise-and-mutate" class="section level2 hasAnchor" number="3.11">
<h2><span class="header-section-number">3.11</span> Apply functions across columns within one row with <code>rowwise</code> and <code>mutate</code><a href="wrangling.html#apply-functions-across-columns-within-one-row-with-rowwise-and-mutate" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>What if you want to apply a function across columns but within one row?
We illustrate such a data transformation in Figure <a href="wrangling.html#fig:rowwise">3.19</a>.</p>

<div class="figure" style="text-align: center"><span style="display:block;" id="fig:rowwise"></span>
<img src="_main_files/figure-html/rowwise-1.png" alt="rowwise and mutate is useful for applying functions across columns within one row. The darker, top row of each table represents the column headers." width="85%" />
<p class="caption">
Figure 3.19: <code>rowwise</code> and <code>mutate</code> is useful for applying functions across columns within one row. The darker, top row of each table represents the column headers.
</p>
</div>
<p>For instance, suppose we want to know the maximum value between <code>mother_tongue</code>,
<code>most_at_home</code>, <code>most_at_work</code>
and <code>lang_known</code> for each language and region
in the <code>region_lang</code> data set.
In other words, we want to apply the <code>max</code> function <em>row-wise.</em>
We will use the (aptly named) <code>rowwise</code> function in combination with <code>mutate</code>
to accomplish this task.</p>
<p>Before we apply <code>rowwise</code>, we will <code>select</code> only the count columns
so we can see all the columns in the data frame’s output easily in the book.
So for this demonstration, the data set we are operating on looks like this:</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="wrangling.html#cb212-1" tabindex="-1"></a>region_lang <span class="sc">|&gt;</span></span>
<span id="cb212-2"><a href="wrangling.html#cb212-2" tabindex="-1"></a>  <span class="fu">select</span>(mother_tongue<span class="sc">:</span>lang_known)</span></code></pre></div>
<pre><code>## # A tibble: 7,490 × 4
##    mother_tongue most_at_home most_at_work lang_known
##            &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;
##  1             5            0            0          0
##  2             5            0            0          0
##  3             0            0            0          0
##  4             0            0            0          0
##  5             5            5            0          0
##  6             0            5            0         20
##  7             0            0            0          0
##  8             0            0            0          0
##  9            30           15            0         10
## 10             0            0            0          0
## # ℹ 7,480 more rows</code></pre>
<p>Now we apply <code>rowwise</code> before <code>mutate</code>, to tell R that we would like
the mutate function to be applied across, and within, a row,
as opposed to being applied on a column
(which is the default behavior of <code>mutate</code>):</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="wrangling.html#cb214-1" tabindex="-1"></a>region_lang <span class="sc">|&gt;</span></span>
<span id="cb214-2"><a href="wrangling.html#cb214-2" tabindex="-1"></a>  <span class="fu">select</span>(mother_tongue<span class="sc">:</span>lang_known) <span class="sc">|&gt;</span></span>
<span id="cb214-3"><a href="wrangling.html#cb214-3" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">|&gt;</span></span>
<span id="cb214-4"><a href="wrangling.html#cb214-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">maximum =</span> <span class="fu">max</span>(<span class="fu">c</span>(mother_tongue,</span>
<span id="cb214-5"><a href="wrangling.html#cb214-5" tabindex="-1"></a>                         most_at_home,</span>
<span id="cb214-6"><a href="wrangling.html#cb214-6" tabindex="-1"></a>                         most_at_work,</span>
<span id="cb214-7"><a href="wrangling.html#cb214-7" tabindex="-1"></a>                         lang_known)))</span></code></pre></div>
<pre><code>## # A tibble: 7,490 × 5
## # Rowwise: 
##    mother_tongue most_at_home most_at_work lang_known maximum
##            &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;
##  1             5            0            0          0       5
##  2             5            0            0          0       5
##  3             0            0            0          0       0
##  4             0            0            0          0       0
##  5             5            5            0          0       5
##  6             0            5            0         20      20
##  7             0            0            0          0       0
##  8             0            0            0          0       0
##  9            30           15            0         10      30
## 10             0            0            0          0       0
## # ℹ 7,480 more rows</code></pre>
<p>We see that we get an additional column added to the data frame,
named <code>maximum</code>, which is the maximum value between <code>mother_tongue</code>,
<code>most_at_home</code>, <code>most_at_work</code> and <code>lang_known</code> for each language
and region.</p>
<p>Similar to <code>group_by</code>,
<code>rowwise</code> doesn’t appear to do anything when it is called by itself.
However, we can apply <code>rowwise</code> in combination
with other functions to change how these other functions operate on the data.
Notice if we used <code>mutate</code> without <code>rowwise</code>,
we would have computed the maximum value across <em>all</em> rows
rather than the maximum value for <em>each</em> row.
Below we show what would have happened had we not used
<code>rowwise</code>. In particular, the same maximum value is reported
in every single row; this code does not provide the desired result.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="wrangling.html#cb216-1" tabindex="-1"></a>region_lang <span class="sc">|&gt;</span></span>
<span id="cb216-2"><a href="wrangling.html#cb216-2" tabindex="-1"></a>  <span class="fu">select</span>(mother_tongue<span class="sc">:</span>lang_known) <span class="sc">|&gt;</span></span>
<span id="cb216-3"><a href="wrangling.html#cb216-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">maximum =</span> <span class="fu">max</span>(<span class="fu">c</span>(mother_tongue,</span>
<span id="cb216-4"><a href="wrangling.html#cb216-4" tabindex="-1"></a>                         most_at_home,</span>
<span id="cb216-5"><a href="wrangling.html#cb216-5" tabindex="-1"></a>                         most_at_home,</span>
<span id="cb216-6"><a href="wrangling.html#cb216-6" tabindex="-1"></a>                         lang_known)))</span></code></pre></div>
<pre><code>## # A tibble: 7,490 × 5
##    mother_tongue most_at_home most_at_work lang_known maximum
##            &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;
##  1             5            0            0          0 5600480
##  2             5            0            0          0 5600480
##  3             0            0            0          0 5600480
##  4             0            0            0          0 5600480
##  5             5            5            0          0 5600480
##  6             0            5            0         20 5600480
##  7             0            0            0          0 5600480
##  8             0            0            0          0 5600480
##  9            30           15            0         10 5600480
## 10             0            0            0          0 5600480
## # ℹ 7,480 more rows</code></pre>
</div>
<div id="summary" class="section level2 hasAnchor" number="3.12">
<h2><span class="header-section-number">3.12</span> Summary<a href="wrangling.html#summary" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Cleaning and wrangling data can be a very time-consuming process. However,
it is a critical step in any data analysis. We have explored many different
functions for cleaning and wrangling data into a tidy format.
Table <a href="wrangling.html#tab:summary-functions-table">3.4</a> summarizes some of the key wrangling
functions we learned in this chapter. In the following chapters, you will
learn how you can take this tidy data and do so much more with it to answer your
burning data science questions!</p>
<div style="page-break-after: always;"></div>
<table>
<caption><span id="tab:summary-functions-table">Table 3.4: </span> Summary of wrangling functions</caption>
<colgroup>
<col width="21%" />
<col width="78%" />
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>across</code></td>
<td>allows you to apply function(s) to multiple columns</td>
</tr>
<tr class="even">
<td><code>filter</code></td>
<td>subsets rows of a data frame</td>
</tr>
<tr class="odd">
<td><code>group_by</code></td>
<td>allows you to apply function(s) to groups of rows</td>
</tr>
<tr class="even">
<td><code>mutate</code></td>
<td>adds or modifies columns in a data frame</td>
</tr>
<tr class="odd">
<td><code>map</code></td>
<td>general iteration function</td>
</tr>
<tr class="even">
<td><code>pivot_longer</code></td>
<td>generally makes the data frame longer and narrower</td>
</tr>
<tr class="odd">
<td><code>pivot_wider</code></td>
<td>generally makes a data frame wider and decreases the number of rows</td>
</tr>
<tr class="even">
<td><code>rowwise</code></td>
<td>applies functions across columns within one row</td>
</tr>
<tr class="odd">
<td><code>separate</code></td>
<td>splits up a character column into multiple columns</td>
</tr>
<tr class="even">
<td><code>select</code></td>
<td>subsets columns of a data frame</td>
</tr>
<tr class="odd">
<td><code>summarize</code></td>
<td>calculates summaries of inputs</td>
</tr>
</tbody>
</table>
</div>
<div id="exercises-2" class="section level2 hasAnchor" number="3.13">
<h2><span class="header-section-number">3.13</span> Exercises<a href="wrangling.html#exercises-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Practice exercises for the material covered in this chapter
can be found in the accompanying
<a href="https://worksheets.datasciencebook.ca">worksheets repository</a>
in the “Cleaning and wrangling data” row.
You can launch an interactive version of the worksheet in your browser by clicking the “launch binder” button.
You can also preview a non-interactive version of the worksheet by clicking “view worksheet.”
If you instead decide to download the worksheet and run it on your own machine,
make sure to follow the instructions for computer setup
found in Chapter <a href="setup.html#setup">13</a>. This will ensure that the automated feedback
and guidance that the worksheets provide will function as intended.</p>
</div>
<div id="additional-resources-1" class="section level2 hasAnchor" number="3.14">
<h2><span class="header-section-number">3.14</span> Additional resources<a href="wrangling.html#additional-resources-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>As we mentioned earlier, <code>tidyverse</code> is actually an <em>R
meta package</em>: it installs and loads a collection of R packages that all
follow the tidy data philosophy we discussed above. One of the <code>tidyverse</code>
packages is <code>dplyr</code>—a data wrangling workhorse. You have already met many
of <code>dplyr</code>’s functions
(<code>select</code>, <code>filter</code>, <code>mutate</code>, <code>arrange</code>, <code>summarize</code>, and <code>group_by</code>).
To learn more about these functions and meet a few more useful
functions, we recommend you check out Chapters 5-9 of the <a href="https://stat545.com/">STAT545 online notes</a>.
of the data wrangling, exploration, and analysis with R book.</li>
<li>The <a href="https://dplyr.tidyverse.org/"><code>dplyr</code> R package documentation</a> <span class="citation">(<a href="#ref-dplyr">Wickham, François, et al. 2021</a>)</span> is
another resource to learn more about the functions in this
chapter, the full set of arguments you can use, and other related functions.
The site also provides a very nice cheat sheet that summarizes many of the
data wrangling functions from this chapter.</li>
<li>Check out the <a href="https://tidyselect.r-lib.org/index.html"><code>tidyselect</code> R package page</a>
<span class="citation">(<a href="#ref-tidyselect">Henry and Wickham 2021</a>)</span> for a comprehensive list of <code>select</code> helpers.
These helpers can be used to choose columns in a data frame when paired with the <code>select</code> function
(and other functions that use the <code>tidyselect</code> syntax, such as <code>pivot_longer</code>).
The <a href="https://tidyselect.r-lib.org/reference/select_helpers.html">documentation for <code>select</code> helpers</a>
is a useful reference to find the helper you need for your particular problem.</li>
<li><em>R for Data Science</em> <span class="citation">(<a href="#ref-wickham2016r">Wickham and Grolemund 2016</a>)</span> has a few chapters related to
data wrangling that go into more depth than this book. For example, the
<a href="https://r4ds.had.co.nz/tidy-data.html">tidy data chapter</a> covers tidy data,
<code>pivot_longer</code>/<code>pivot_wider</code> and <code>separate</code>, but also covers missing values
and additional wrangling functions (like <code>unite</code>). The <a href="https://r4ds.had.co.nz/transform.html">data
transformation chapter</a> covers
<code>select</code>, <code>filter</code>, <code>arrange</code>, <code>mutate</code>, and <code>summarize</code>. And the <a href="https://r4ds.had.co.nz/iteration.html#the-map-functions"><code>map</code>
functions chapter</a>
provides more about the <code>map</code> functions.</li>
<li>You will occasionally encounter a case where you need to iterate over items
in a data frame, but none of the above functions are flexible enough to do
what you want. In that case, you may consider using <a href="https://r4ds.had.co.nz/iteration.html#iteration">a for
loop</a>.</li>
</ul>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-tidyselect" class="csl-entry">
Henry, Lionel, and Hadley Wickham. 2021. <em><span class="nocase">tidyselect R package</span></em>. <a href="https://tidyselect.r-lib.org/">https://tidyselect.r-lib.org/</a>.
</div>
<div id="ref-wickham2014tidy" class="csl-entry">
Wickham, Hadley. 2014. <span>“Tidy Data.”</span> <em>Journal of Statistical Software</em> 59 (10): 1–23.
</div>
<div id="ref-wickham2019advanced" class="csl-entry">
———. 2019. <em>Advanced <span>R</span></em>. CRC Press. <a href="https://adv-r.hadley.nz/">https://adv-r.hadley.nz/</a>.
</div>
<div id="ref-dplyr" class="csl-entry">
Wickham, Hadley, Romain François, Lionel Henry, and Kirill Müller. 2021. <em><span class="nocase">dplyr R package</span></em>. <a href="https://dplyr.tidyverse.org/">https://dplyr.tidyverse.org/</a>.
</div>
<div id="ref-wickham2016r" class="csl-entry">
Wickham, Hadley, and Garrett Grolemund. 2016. <em>R for Data Science: Import, Tidy, Transform, Visualize, and Model Data</em>. O’Reilly. <a href="https://r4ds.had.co.nz/">https://r4ds.had.co.nz/</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="reading.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="viz.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
