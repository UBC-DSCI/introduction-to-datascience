<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Classification I: training &amp; predicting |  Data Science</title>
  <meta name="description" content="This is a textbook for teaching a first introduction to data science." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Classification I: training &amp; predicting |  Data Science" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a textbook for teaching a first introduction to data science." />
  <meta name="github-repo" content="UBC-DSCI/introduction-to-datascience" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Classification I: training &amp; predicting |  Data Science" />
  
  <meta name="twitter:description" content="This is a textbook for teaching a first introduction to data science." />
  

<meta name="author" content="Tiffany Timbers, Trevor Campbell, and Melissa Lee" />


<meta name="date" content="2024-08-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="viz.html"/>
<link rel="next" href="classification2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.2/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-JJ9MD0LBF5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-JJ9MD0LBF5');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="source/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://datasciencebook.ca">Data Science: A First Introduction</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a></li>
<li class="chapter" data-level="" data-path="foreword.html"><a href="foreword.html"><i class="fa fa-check"></i>Foreword</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="acknowledgments.html"><a href="acknowledgments.html"><i class="fa fa-check"></i>Acknowledgments</a></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html"><i class="fa fa-check"></i>About the authors</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> R and the Tidyverse</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#overview"><i class="fa fa-check"></i><b>1.1</b> Overview</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#chapter-learning-objectives"><i class="fa fa-check"></i><b>1.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#canadian-languages-data-set"><i class="fa fa-check"></i><b>1.3</b> Canadian languages data set</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#asking-a-question"><i class="fa fa-check"></i><b>1.4</b> Asking a question</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#loading-a-tabular-data-set"><i class="fa fa-check"></i><b>1.5</b> Loading a tabular data set</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#naming-things-in-r"><i class="fa fa-check"></i><b>1.6</b> Naming things in R</a></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#creating-subsets-of-data-frames-with-filter-select"><i class="fa fa-check"></i><b>1.7</b> Creating subsets of data frames with <code>filter</code> &amp; <code>select</code></a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="intro.html"><a href="intro.html#using-filter-to-extract-rows"><i class="fa fa-check"></i><b>1.7.1</b> Using <code>filter</code> to extract rows</a></li>
<li class="chapter" data-level="1.7.2" data-path="intro.html"><a href="intro.html#using-select-to-extract-columns"><i class="fa fa-check"></i><b>1.7.2</b> Using <code>select</code> to extract columns</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="intro.html"><a href="intro.html#arrangesliceintro"><i class="fa fa-check"></i><b>1.8</b> Using <code>arrange</code> to order and <code>slice</code> to select rows by index number</a></li>
<li class="chapter" data-level="1.9" data-path="intro.html"><a href="intro.html#adding-and-modifying-columns-using-mutate"><i class="fa fa-check"></i><b>1.9</b> Adding and modifying columns using <code>mutate</code></a></li>
<li class="chapter" data-level="1.10" data-path="intro.html"><a href="intro.html#exploring-data-with-visualizations"><i class="fa fa-check"></i><b>1.10</b> Exploring data with visualizations</a>
<ul>
<li class="chapter" data-level="1.10.1" data-path="intro.html"><a href="intro.html#using-ggplot-to-create-a-bar-plot"><i class="fa fa-check"></i><b>1.10.1</b> Using <code>ggplot</code> to create a bar plot</a></li>
<li class="chapter" data-level="1.10.2" data-path="intro.html"><a href="intro.html#formatting-ggplot-objects"><i class="fa fa-check"></i><b>1.10.2</b> Formatting ggplot objects</a></li>
<li class="chapter" data-level="1.10.3" data-path="intro.html"><a href="intro.html#putting-it-all-together"><i class="fa fa-check"></i><b>1.10.3</b> Putting it all together</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="intro.html"><a href="intro.html#accessing-documentation"><i class="fa fa-check"></i><b>1.11</b> Accessing documentation</a></li>
<li class="chapter" data-level="1.12" data-path="intro.html"><a href="intro.html#exercises"><i class="fa fa-check"></i><b>1.12</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reading.html"><a href="reading.html"><i class="fa fa-check"></i><b>2</b> Reading in data locally and from the web</a>
<ul>
<li class="chapter" data-level="2.1" data-path="reading.html"><a href="reading.html#overview-1"><i class="fa fa-check"></i><b>2.1</b> Overview</a></li>
<li class="chapter" data-level="2.2" data-path="reading.html"><a href="reading.html#chapter-learning-objectives-1"><i class="fa fa-check"></i><b>2.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="2.3" data-path="reading.html"><a href="reading.html#absolute-and-relative-file-paths"><i class="fa fa-check"></i><b>2.3</b> Absolute and relative file paths</a></li>
<li class="chapter" data-level="2.4" data-path="reading.html"><a href="reading.html#reading-tabular-data-from-a-plain-text-file-into-r"><i class="fa fa-check"></i><b>2.4</b> Reading tabular data from a plain text file into R</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="reading.html"><a href="reading.html#readcsv"><i class="fa fa-check"></i><b>2.4.1</b> <code>read_csv</code> to read in comma-separated values files</a></li>
<li class="chapter" data-level="2.4.2" data-path="reading.html"><a href="reading.html#skipping-rows-when-reading-in-data"><i class="fa fa-check"></i><b>2.4.2</b> Skipping rows when reading in data</a></li>
<li class="chapter" data-level="2.4.3" data-path="reading.html"><a href="reading.html#read_tsv-to-read-in-tab-separated-values-files"><i class="fa fa-check"></i><b>2.4.3</b> <code>read_tsv</code> to read in tab-separated values files</a></li>
<li class="chapter" data-level="2.4.4" data-path="reading.html"><a href="reading.html#read_delim-as-a-more-flexible-method-to-get-tabular-data-into-r"><i class="fa fa-check"></i><b>2.4.4</b> <code>read_delim</code> as a more flexible method to get tabular data into R</a></li>
<li class="chapter" data-level="2.4.5" data-path="reading.html"><a href="reading.html#reading-tabular-data-directly-from-a-url"><i class="fa fa-check"></i><b>2.4.5</b> Reading tabular data directly from a URL</a></li>
<li class="chapter" data-level="2.4.6" data-path="reading.html"><a href="reading.html#downloading-data-from-a-url"><i class="fa fa-check"></i><b>2.4.6</b> Downloading data from a URL</a></li>
<li class="chapter" data-level="2.4.7" data-path="reading.html"><a href="reading.html#previewing-a-data-file-before-reading-it-into-r"><i class="fa fa-check"></i><b>2.4.7</b> Previewing a data file before reading it into R</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="reading.html"><a href="reading.html#reading-tabular-data-from-a-microsoft-excel-file"><i class="fa fa-check"></i><b>2.5</b> Reading tabular data from a Microsoft Excel file</a></li>
<li class="chapter" data-level="2.6" data-path="reading.html"><a href="reading.html#reading-data-from-a-database"><i class="fa fa-check"></i><b>2.6</b> Reading data from a database</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="reading.html"><a href="reading.html#reading-data-from-a-sqlite-database"><i class="fa fa-check"></i><b>2.6.1</b> Reading data from a SQLite database</a></li>
<li class="chapter" data-level="2.6.2" data-path="reading.html"><a href="reading.html#reading-data-from-a-postgresql-database"><i class="fa fa-check"></i><b>2.6.2</b> Reading data from a PostgreSQL database</a></li>
<li class="chapter" data-level="2.6.3" data-path="reading.html"><a href="reading.html#why-should-we-bother-with-databases-at-all"><i class="fa fa-check"></i><b>2.6.3</b> Why should we bother with databases at all?</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="reading.html"><a href="reading.html#writing-data-from-r-to-a-.csv-file"><i class="fa fa-check"></i><b>2.7</b> Writing data from R to a <code>.csv</code> file</a></li>
<li class="chapter" data-level="2.8" data-path="reading.html"><a href="reading.html#obtaining-data-from-the-web"><i class="fa fa-check"></i><b>2.8</b> Obtaining data from the web</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="reading.html"><a href="reading.html#web-scraping"><i class="fa fa-check"></i><b>2.8.1</b> Web scraping</a></li>
<li class="chapter" data-level="2.8.2" data-path="reading.html"><a href="reading.html#using-an-api"><i class="fa fa-check"></i><b>2.8.2</b> Using an API</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="reading.html"><a href="reading.html#exercises-1"><i class="fa fa-check"></i><b>2.9</b> Exercises</a></li>
<li class="chapter" data-level="2.10" data-path="reading.html"><a href="reading.html#additional-resources"><i class="fa fa-check"></i><b>2.10</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="wrangling.html"><a href="wrangling.html"><i class="fa fa-check"></i><b>3</b> Cleaning and wrangling data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="wrangling.html"><a href="wrangling.html#overview-2"><i class="fa fa-check"></i><b>3.1</b> Overview</a></li>
<li class="chapter" data-level="3.2" data-path="wrangling.html"><a href="wrangling.html#chapter-learning-objectives-2"><i class="fa fa-check"></i><b>3.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="3.3" data-path="wrangling.html"><a href="wrangling.html#data-frames-vectors-and-lists"><i class="fa fa-check"></i><b>3.3</b> Data frames, vectors, and lists</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="wrangling.html"><a href="wrangling.html#what-is-a-data-frame"><i class="fa fa-check"></i><b>3.3.1</b> What is a data frame?</a></li>
<li class="chapter" data-level="3.3.2" data-path="wrangling.html"><a href="wrangling.html#what-is-a-vector"><i class="fa fa-check"></i><b>3.3.2</b> What is a vector?</a></li>
<li class="chapter" data-level="3.3.3" data-path="wrangling.html"><a href="wrangling.html#what-is-a-list"><i class="fa fa-check"></i><b>3.3.3</b> What is a list?</a></li>
<li class="chapter" data-level="3.3.4" data-path="wrangling.html"><a href="wrangling.html#what-does-this-have-to-do-with-data-frames"><i class="fa fa-check"></i><b>3.3.4</b> What does this have to do with data frames?</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="wrangling.html"><a href="wrangling.html#tidy-data"><i class="fa fa-check"></i><b>3.4</b> Tidy data</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="wrangling.html"><a href="wrangling.html#tidying-up-going-from-wide-to-long-using-pivot_longer"><i class="fa fa-check"></i><b>3.4.1</b> Tidying up: going from wide to long using <code>pivot_longer</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="wrangling.html"><a href="wrangling.html#pivot-wider"><i class="fa fa-check"></i><b>3.4.2</b> Tidying up: going from long to wide using <code>pivot_wider</code></a></li>
<li class="chapter" data-level="3.4.3" data-path="wrangling.html"><a href="wrangling.html#separate"><i class="fa fa-check"></i><b>3.4.3</b> Tidying up: using <code>separate</code> to deal with multiple delimiters</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="wrangling.html"><a href="wrangling.html#using-select-to-extract-a-range-of-columns"><i class="fa fa-check"></i><b>3.5</b> Using <code>select</code> to extract a range of columns</a></li>
<li class="chapter" data-level="3.6" data-path="wrangling.html"><a href="wrangling.html#using-filter-to-extract-rows-1"><i class="fa fa-check"></i><b>3.6</b> Using <code>filter</code> to extract rows</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="wrangling.html"><a href="wrangling.html#extracting-rows-that-have-a-certain-value-with"><i class="fa fa-check"></i><b>3.6.1</b> Extracting rows that have a certain value with <code>==</code></a></li>
<li class="chapter" data-level="3.6.2" data-path="wrangling.html"><a href="wrangling.html#extracting-rows-that-do-not-have-a-certain-value-with"><i class="fa fa-check"></i><b>3.6.2</b> Extracting rows that do not have a certain value with <code>!=</code></a></li>
<li class="chapter" data-level="3.6.3" data-path="wrangling.html"><a href="wrangling.html#filter-and"><i class="fa fa-check"></i><b>3.6.3</b> Extracting rows satisfying multiple conditions using <code>,</code> or <code>&amp;</code></a></li>
<li class="chapter" data-level="3.6.4" data-path="wrangling.html"><a href="wrangling.html#extracting-rows-satisfying-at-least-one-condition-using"><i class="fa fa-check"></i><b>3.6.4</b> Extracting rows satisfying at least one condition using <code>|</code></a></li>
<li class="chapter" data-level="3.6.5" data-path="wrangling.html"><a href="wrangling.html#extracting-rows-with-values-in-a-vector-using-in"><i class="fa fa-check"></i><b>3.6.5</b> Extracting rows with values in a vector using <code>%in%</code></a></li>
<li class="chapter" data-level="3.6.6" data-path="wrangling.html"><a href="wrangling.html#extracting-rows-above-or-below-a-threshold-using-and"><i class="fa fa-check"></i><b>3.6.6</b> Extracting rows above or below a threshold using <code>&gt;</code> and <code>&lt;</code></a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="wrangling.html"><a href="wrangling.html#using-mutate-to-modify-or-add-columns"><i class="fa fa-check"></i><b>3.7</b> Using <code>mutate</code> to modify or add columns</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="wrangling.html"><a href="wrangling.html#using-mutate-to-modify-columns"><i class="fa fa-check"></i><b>3.7.1</b> Using <code>mutate</code> to modify columns</a></li>
<li class="chapter" data-level="3.7.2" data-path="wrangling.html"><a href="wrangling.html#using-mutate-to-create-new-columns"><i class="fa fa-check"></i><b>3.7.2</b> Using <code>mutate</code> to create new columns</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="wrangling.html"><a href="wrangling.html#combining-functions-using-the-pipe-operator"><i class="fa fa-check"></i><b>3.8</b> Combining functions using the pipe operator, <code>|&gt;</code></a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="wrangling.html"><a href="wrangling.html#using-to-combine-filter-and-select"><i class="fa fa-check"></i><b>3.8.1</b> Using <code>|&gt;</code> to combine <code>filter</code> and <code>select</code></a></li>
<li class="chapter" data-level="3.8.2" data-path="wrangling.html"><a href="wrangling.html#using-with-more-than-two-functions"><i class="fa fa-check"></i><b>3.8.2</b> Using <code>|&gt;</code> with more than two functions</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="wrangling.html"><a href="wrangling.html#aggregating-data-with-summarize-and-map"><i class="fa fa-check"></i><b>3.9</b> Aggregating data with <code>summarize</code> and <code>map</code></a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="wrangling.html"><a href="wrangling.html#calculating-summary-statistics-on-whole-columns"><i class="fa fa-check"></i><b>3.9.1</b> Calculating summary statistics on whole columns</a></li>
<li class="chapter" data-level="3.9.2" data-path="wrangling.html"><a href="wrangling.html#calculating-summary-statistics-when-there-are-nas"><i class="fa fa-check"></i><b>3.9.2</b> Calculating summary statistics when there are <code>NA</code>s</a></li>
<li class="chapter" data-level="3.9.3" data-path="wrangling.html"><a href="wrangling.html#calculating-summary-statistics-for-groups-of-rows"><i class="fa fa-check"></i><b>3.9.3</b> Calculating summary statistics for groups of rows</a></li>
<li class="chapter" data-level="3.9.4" data-path="wrangling.html"><a href="wrangling.html#calculating-summary-statistics-on-many-columns"><i class="fa fa-check"></i><b>3.9.4</b> Calculating summary statistics on many columns</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="wrangling.html"><a href="wrangling.html#apply-functions-across-many-columns-with-mutate-and-across"><i class="fa fa-check"></i><b>3.10</b> Apply functions across many columns with <code>mutate</code> and <code>across</code></a></li>
<li class="chapter" data-level="3.11" data-path="wrangling.html"><a href="wrangling.html#apply-functions-across-columns-within-one-row-with-rowwise-and-mutate"><i class="fa fa-check"></i><b>3.11</b> Apply functions across columns within one row with <code>rowwise</code> and <code>mutate</code></a></li>
<li class="chapter" data-level="3.12" data-path="wrangling.html"><a href="wrangling.html#summary"><i class="fa fa-check"></i><b>3.12</b> Summary</a></li>
<li class="chapter" data-level="3.13" data-path="wrangling.html"><a href="wrangling.html#exercises-2"><i class="fa fa-check"></i><b>3.13</b> Exercises</a></li>
<li class="chapter" data-level="3.14" data-path="wrangling.html"><a href="wrangling.html#additional-resources-1"><i class="fa fa-check"></i><b>3.14</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="viz.html"><a href="viz.html"><i class="fa fa-check"></i><b>4</b> Effective data visualization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="viz.html"><a href="viz.html#overview-3"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="viz.html"><a href="viz.html#chapter-learning-objectives-3"><i class="fa fa-check"></i><b>4.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="4.3" data-path="viz.html"><a href="viz.html#choosing-the-visualization"><i class="fa fa-check"></i><b>4.3</b> Choosing the visualization</a></li>
<li class="chapter" data-level="4.4" data-path="viz.html"><a href="viz.html#refining-the-visualization"><i class="fa fa-check"></i><b>4.4</b> Refining the visualization</a></li>
<li class="chapter" data-level="4.5" data-path="viz.html"><a href="viz.html#creating-visualizations-with-ggplot2"><i class="fa fa-check"></i><b>4.5</b> Creating visualizations with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="viz.html"><a href="viz.html#scatter-plots-and-line-plots-the-mauna-loa-co_text2-data-set"><i class="fa fa-check"></i><b>4.5.1</b> Scatter plots and line plots: the Mauna Loa CO<span class="math inline">\(_{\text{2}}\)</span> data set</a></li>
<li class="chapter" data-level="4.5.2" data-path="viz.html"><a href="viz.html#scatter-plots-the-old-faithful-eruption-time-data-set"><i class="fa fa-check"></i><b>4.5.2</b> Scatter plots: the Old Faithful eruption time data set</a></li>
<li class="chapter" data-level="4.5.3" data-path="viz.html"><a href="viz.html#axis-transformation-and-colored-scatter-plots-the-canadian-languages-data-set"><i class="fa fa-check"></i><b>4.5.3</b> Axis transformation and colored scatter plots: the Canadian languages data set</a></li>
<li class="chapter" data-level="4.5.4" data-path="viz.html"><a href="viz.html#bar-plots-the-island-landmass-data-set"><i class="fa fa-check"></i><b>4.5.4</b> Bar plots: the island landmass data set</a></li>
<li class="chapter" data-level="4.5.5" data-path="viz.html"><a href="viz.html#histogramsviz"><i class="fa fa-check"></i><b>4.5.5</b> Histograms: the Michelson speed of light data set</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="viz.html"><a href="viz.html#explaining-the-visualization"><i class="fa fa-check"></i><b>4.6</b> Explaining the visualization</a></li>
<li class="chapter" data-level="4.7" data-path="viz.html"><a href="viz.html#saving-the-visualization"><i class="fa fa-check"></i><b>4.7</b> Saving the visualization</a></li>
<li class="chapter" data-level="4.8" data-path="viz.html"><a href="viz.html#exercises-3"><i class="fa fa-check"></i><b>4.8</b> Exercises</a></li>
<li class="chapter" data-level="4.9" data-path="viz.html"><a href="viz.html#additional-resources-2"><i class="fa fa-check"></i><b>4.9</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="classification1.html"><a href="classification1.html"><i class="fa fa-check"></i><b>5</b> Classification I: training &amp; predicting</a>
<ul>
<li class="chapter" data-level="5.1" data-path="classification1.html"><a href="classification1.html#overview-4"><i class="fa fa-check"></i><b>5.1</b> Overview</a></li>
<li class="chapter" data-level="5.2" data-path="classification1.html"><a href="classification1.html#chapter-learning-objectives-4"><i class="fa fa-check"></i><b>5.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="5.3" data-path="classification1.html"><a href="classification1.html#the-classification-problem"><i class="fa fa-check"></i><b>5.3</b> The classification problem</a></li>
<li class="chapter" data-level="5.4" data-path="classification1.html"><a href="classification1.html#exploring-a-data-set"><i class="fa fa-check"></i><b>5.4</b> Exploring a data set</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="classification1.html"><a href="classification1.html#loading-the-cancer-data"><i class="fa fa-check"></i><b>5.4.1</b> Loading the cancer data</a></li>
<li class="chapter" data-level="5.4.2" data-path="classification1.html"><a href="classification1.html#describing-the-variables-in-the-cancer-data-set"><i class="fa fa-check"></i><b>5.4.2</b> Describing the variables in the cancer data set</a></li>
<li class="chapter" data-level="5.4.3" data-path="classification1.html"><a href="classification1.html#exploring-the-cancer-data"><i class="fa fa-check"></i><b>5.4.3</b> Exploring the cancer data</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="classification1.html"><a href="classification1.html#classification-with-k-nearest-neighbors"><i class="fa fa-check"></i><b>5.5</b> Classification with K-nearest neighbors</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="classification1.html"><a href="classification1.html#distance-between-points"><i class="fa fa-check"></i><b>5.5.1</b> Distance between points</a></li>
<li class="chapter" data-level="5.5.2" data-path="classification1.html"><a href="classification1.html#more-than-two-explanatory-variables"><i class="fa fa-check"></i><b>5.5.2</b> More than two explanatory variables</a></li>
<li class="chapter" data-level="5.5.3" data-path="classification1.html"><a href="classification1.html#summary-of-k-nearest-neighbors-algorithm"><i class="fa fa-check"></i><b>5.5.3</b> Summary of K-nearest neighbors algorithm</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="classification1.html"><a href="classification1.html#k-nearest-neighbors-with-tidymodels"><i class="fa fa-check"></i><b>5.6</b> K-nearest neighbors with <code>tidymodels</code></a></li>
<li class="chapter" data-level="5.7" data-path="classification1.html"><a href="classification1.html#data-preprocessing-with-tidymodels"><i class="fa fa-check"></i><b>5.7</b> Data preprocessing with <code>tidymodels</code></a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="classification1.html"><a href="classification1.html#centering-and-scaling"><i class="fa fa-check"></i><b>5.7.1</b> Centering and scaling</a></li>
<li class="chapter" data-level="5.7.2" data-path="classification1.html"><a href="classification1.html#balancing"><i class="fa fa-check"></i><b>5.7.2</b> Balancing</a></li>
<li class="chapter" data-level="5.7.3" data-path="classification1.html"><a href="classification1.html#missing-data"><i class="fa fa-check"></i><b>5.7.3</b> Missing data</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="classification1.html"><a href="classification1.html#puttingittogetherworkflow"><i class="fa fa-check"></i><b>5.8</b> Putting it together in a <code>workflow</code></a></li>
<li class="chapter" data-level="5.9" data-path="classification1.html"><a href="classification1.html#exercises-4"><i class="fa fa-check"></i><b>5.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="classification2.html"><a href="classification2.html"><i class="fa fa-check"></i><b>6</b> Classification II: evaluation &amp; tuning</a>
<ul>
<li class="chapter" data-level="6.1" data-path="classification2.html"><a href="classification2.html#overview-5"><i class="fa fa-check"></i><b>6.1</b> Overview</a></li>
<li class="chapter" data-level="6.2" data-path="classification2.html"><a href="classification2.html#chapter-learning-objectives-5"><i class="fa fa-check"></i><b>6.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="6.3" data-path="classification2.html"><a href="classification2.html#evaluating-performance"><i class="fa fa-check"></i><b>6.3</b> Evaluating performance</a></li>
<li class="chapter" data-level="6.4" data-path="classification2.html"><a href="classification2.html#randomseeds"><i class="fa fa-check"></i><b>6.4</b> Randomness and seeds</a></li>
<li class="chapter" data-level="6.5" data-path="classification2.html"><a href="classification2.html#evaluating-performance-with-tidymodels"><i class="fa fa-check"></i><b>6.5</b> Evaluating performance with <code>tidymodels</code></a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="classification2.html"><a href="classification2.html#create-the-train-test-split"><i class="fa fa-check"></i><b>6.5.1</b> Create the train / test split</a></li>
<li class="chapter" data-level="6.5.2" data-path="classification2.html"><a href="classification2.html#preprocess-the-data"><i class="fa fa-check"></i><b>6.5.2</b> Preprocess the data</a></li>
<li class="chapter" data-level="6.5.3" data-path="classification2.html"><a href="classification2.html#train-the-classifier"><i class="fa fa-check"></i><b>6.5.3</b> Train the classifier</a></li>
<li class="chapter" data-level="6.5.4" data-path="classification2.html"><a href="classification2.html#predict-the-labels-in-the-test-set"><i class="fa fa-check"></i><b>6.5.4</b> Predict the labels in the test set</a></li>
<li class="chapter" data-level="6.5.5" data-path="classification2.html"><a href="classification2.html#eval-performance-cls2"><i class="fa fa-check"></i><b>6.5.5</b> Evaluate performance</a></li>
<li class="chapter" data-level="6.5.6" data-path="classification2.html"><a href="classification2.html#critically-analyze-performance"><i class="fa fa-check"></i><b>6.5.6</b> Critically analyze performance</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="classification2.html"><a href="classification2.html#tuning-the-classifier"><i class="fa fa-check"></i><b>6.6</b> Tuning the classifier</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="classification2.html"><a href="classification2.html#cross-validation"><i class="fa fa-check"></i><b>6.6.1</b> Cross-validation</a></li>
<li class="chapter" data-level="6.6.2" data-path="classification2.html"><a href="classification2.html#parameter-value-selection"><i class="fa fa-check"></i><b>6.6.2</b> Parameter value selection</a></li>
<li class="chapter" data-level="6.6.3" data-path="classification2.html"><a href="classification2.html#underoverfitting"><i class="fa fa-check"></i><b>6.6.3</b> Under/Overfitting</a></li>
<li class="chapter" data-level="6.6.4" data-path="classification2.html"><a href="classification2.html#evaluating-on-the-test-set"><i class="fa fa-check"></i><b>6.6.4</b> Evaluating on the test set</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="classification2.html"><a href="classification2.html#summary-1"><i class="fa fa-check"></i><b>6.7</b> Summary</a></li>
<li class="chapter" data-level="6.8" data-path="classification2.html"><a href="classification2.html#predictor-variable-selection"><i class="fa fa-check"></i><b>6.8</b> Predictor variable selection</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="classification2.html"><a href="classification2.html#the-effect-of-irrelevant-predictors"><i class="fa fa-check"></i><b>6.8.1</b> The effect of irrelevant predictors</a></li>
<li class="chapter" data-level="6.8.2" data-path="classification2.html"><a href="classification2.html#finding-a-good-subset-of-predictors"><i class="fa fa-check"></i><b>6.8.2</b> Finding a good subset of predictors</a></li>
<li class="chapter" data-level="6.8.3" data-path="classification2.html"><a href="classification2.html#forward-selection-in-r"><i class="fa fa-check"></i><b>6.8.3</b> Forward selection in R</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="classification2.html"><a href="classification2.html#exercises-5"><i class="fa fa-check"></i><b>6.9</b> Exercises</a></li>
<li class="chapter" data-level="6.10" data-path="classification2.html"><a href="classification2.html#additional-resources-3"><i class="fa fa-check"></i><b>6.10</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="regression1.html"><a href="regression1.html"><i class="fa fa-check"></i><b>7</b> Regression I: K-nearest neighbors</a>
<ul>
<li class="chapter" data-level="7.1" data-path="regression1.html"><a href="regression1.html#overview-6"><i class="fa fa-check"></i><b>7.1</b> Overview</a></li>
<li class="chapter" data-level="7.2" data-path="regression1.html"><a href="regression1.html#chapter-learning-objectives-6"><i class="fa fa-check"></i><b>7.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="7.3" data-path="regression1.html"><a href="regression1.html#the-regression-problem"><i class="fa fa-check"></i><b>7.3</b> The regression problem</a></li>
<li class="chapter" data-level="7.4" data-path="regression1.html"><a href="regression1.html#exploring-a-data-set-1"><i class="fa fa-check"></i><b>7.4</b> Exploring a data set</a></li>
<li class="chapter" data-level="7.5" data-path="regression1.html"><a href="regression1.html#k-nearest-neighbors-regression"><i class="fa fa-check"></i><b>7.5</b> K-nearest neighbors regression</a></li>
<li class="chapter" data-level="7.6" data-path="regression1.html"><a href="regression1.html#training-evaluating-and-tuning-the-model"><i class="fa fa-check"></i><b>7.6</b> Training, evaluating, and tuning the model</a></li>
<li class="chapter" data-level="7.7" data-path="regression1.html"><a href="regression1.html#underfitting-and-overfitting"><i class="fa fa-check"></i><b>7.7</b> Underfitting and overfitting</a></li>
<li class="chapter" data-level="7.8" data-path="regression1.html"><a href="regression1.html#evaluating-on-the-test-set-1"><i class="fa fa-check"></i><b>7.8</b> Evaluating on the test set</a></li>
<li class="chapter" data-level="7.9" data-path="regression1.html"><a href="regression1.html#multivariable-k-nn-regression"><i class="fa fa-check"></i><b>7.9</b> Multivariable K-NN regression</a></li>
<li class="chapter" data-level="7.10" data-path="regression1.html"><a href="regression1.html#strengths-and-limitations-of-k-nn-regression"><i class="fa fa-check"></i><b>7.10</b> Strengths and limitations of K-NN regression</a></li>
<li class="chapter" data-level="7.11" data-path="regression1.html"><a href="regression1.html#exercises-6"><i class="fa fa-check"></i><b>7.11</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="regression2.html"><a href="regression2.html"><i class="fa fa-check"></i><b>8</b> Regression II: linear regression</a>
<ul>
<li class="chapter" data-level="8.1" data-path="regression2.html"><a href="regression2.html#overview-7"><i class="fa fa-check"></i><b>8.1</b> Overview</a></li>
<li class="chapter" data-level="8.2" data-path="regression2.html"><a href="regression2.html#chapter-learning-objectives-7"><i class="fa fa-check"></i><b>8.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="8.3" data-path="regression2.html"><a href="regression2.html#simple-linear-regression"><i class="fa fa-check"></i><b>8.3</b> Simple linear regression</a></li>
<li class="chapter" data-level="8.4" data-path="regression2.html"><a href="regression2.html#linear-regression-in-r"><i class="fa fa-check"></i><b>8.4</b> Linear regression in R</a></li>
<li class="chapter" data-level="8.5" data-path="regression2.html"><a href="regression2.html#comparing-simple-linear-and-k-nn-regression"><i class="fa fa-check"></i><b>8.5</b> Comparing simple linear and K-NN regression</a></li>
<li class="chapter" data-level="8.6" data-path="regression2.html"><a href="regression2.html#multivariable-linear-regression"><i class="fa fa-check"></i><b>8.6</b> Multivariable linear regression</a></li>
<li class="chapter" data-level="8.7" data-path="regression2.html"><a href="regression2.html#multicollinearity-and-outliers"><i class="fa fa-check"></i><b>8.7</b> Multicollinearity and outliers</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="regression2.html"><a href="regression2.html#outliers"><i class="fa fa-check"></i><b>8.7.1</b> Outliers</a></li>
<li class="chapter" data-level="8.7.2" data-path="regression2.html"><a href="regression2.html#multicollinearity"><i class="fa fa-check"></i><b>8.7.2</b> Multicollinearity</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="regression2.html"><a href="regression2.html#designing-new-predictors"><i class="fa fa-check"></i><b>8.8</b> Designing new predictors</a></li>
<li class="chapter" data-level="8.9" data-path="regression2.html"><a href="regression2.html#the-other-sides-of-regression"><i class="fa fa-check"></i><b>8.9</b> The other sides of regression</a></li>
<li class="chapter" data-level="8.10" data-path="regression2.html"><a href="regression2.html#exercises-7"><i class="fa fa-check"></i><b>8.10</b> Exercises</a></li>
<li class="chapter" data-level="8.11" data-path="regression2.html"><a href="regression2.html#additional-resources-4"><i class="fa fa-check"></i><b>8.11</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>9</b> Clustering</a>
<ul>
<li class="chapter" data-level="9.1" data-path="clustering.html"><a href="clustering.html#overview-8"><i class="fa fa-check"></i><b>9.1</b> Overview</a></li>
<li class="chapter" data-level="9.2" data-path="clustering.html"><a href="clustering.html#chapter-learning-objectives-8"><i class="fa fa-check"></i><b>9.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="9.3" data-path="clustering.html"><a href="clustering.html#clustering-1"><i class="fa fa-check"></i><b>9.3</b> Clustering</a></li>
<li class="chapter" data-level="9.4" data-path="clustering.html"><a href="clustering.html#an-illustrative-example"><i class="fa fa-check"></i><b>9.4</b> An illustrative example</a></li>
<li class="chapter" data-level="9.5" data-path="clustering.html"><a href="clustering.html#k-means"><i class="fa fa-check"></i><b>9.5</b> K-means</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="clustering.html"><a href="clustering.html#measuring-cluster-quality"><i class="fa fa-check"></i><b>9.5.1</b> Measuring cluster quality</a></li>
<li class="chapter" data-level="9.5.2" data-path="clustering.html"><a href="clustering.html#the-clustering-algorithm"><i class="fa fa-check"></i><b>9.5.2</b> The clustering algorithm</a></li>
<li class="chapter" data-level="9.5.3" data-path="clustering.html"><a href="clustering.html#random-restarts"><i class="fa fa-check"></i><b>9.5.3</b> Random restarts</a></li>
<li class="chapter" data-level="9.5.4" data-path="clustering.html"><a href="clustering.html#choosing-k"><i class="fa fa-check"></i><b>9.5.4</b> Choosing K</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="clustering.html"><a href="clustering.html#k-means-in-r"><i class="fa fa-check"></i><b>9.6</b> K-means in R</a></li>
<li class="chapter" data-level="9.7" data-path="clustering.html"><a href="clustering.html#exercises-8"><i class="fa fa-check"></i><b>9.7</b> Exercises</a></li>
<li class="chapter" data-level="9.8" data-path="clustering.html"><a href="clustering.html#additional-resources-5"><i class="fa fa-check"></i><b>9.8</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>10</b> Statistical inference</a>
<ul>
<li class="chapter" data-level="10.1" data-path="inference.html"><a href="inference.html#overview-9"><i class="fa fa-check"></i><b>10.1</b> Overview</a></li>
<li class="chapter" data-level="10.2" data-path="inference.html"><a href="inference.html#chapter-learning-objectives-9"><i class="fa fa-check"></i><b>10.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="10.3" data-path="inference.html"><a href="inference.html#why-do-we-need-sampling"><i class="fa fa-check"></i><b>10.3</b> Why do we need sampling?</a></li>
<li class="chapter" data-level="10.4" data-path="inference.html"><a href="inference.html#sampling-distributions"><i class="fa fa-check"></i><b>10.4</b> Sampling distributions</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="inference.html"><a href="inference.html#sampling-distributions-for-proportions"><i class="fa fa-check"></i><b>10.4.1</b> Sampling distributions for proportions</a></li>
<li class="chapter" data-level="10.4.2" data-path="inference.html"><a href="inference.html#sampling-distributions-for-means"><i class="fa fa-check"></i><b>10.4.2</b> Sampling distributions for means</a></li>
<li class="chapter" data-level="10.4.3" data-path="inference.html"><a href="inference.html#summary-2"><i class="fa fa-check"></i><b>10.4.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="inference.html"><a href="inference.html#bootstrapping"><i class="fa fa-check"></i><b>10.5</b> Bootstrapping</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="inference.html"><a href="inference.html#overview-10"><i class="fa fa-check"></i><b>10.5.1</b> Overview</a></li>
<li class="chapter" data-level="10.5.2" data-path="inference.html"><a href="inference.html#bootstrapping-in-r"><i class="fa fa-check"></i><b>10.5.2</b> Bootstrapping in R</a></li>
<li class="chapter" data-level="10.5.3" data-path="inference.html"><a href="inference.html#using-the-bootstrap-to-calculate-a-plausible-range"><i class="fa fa-check"></i><b>10.5.3</b> Using the bootstrap to calculate a plausible range</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="inference.html"><a href="inference.html#exercises-9"><i class="fa fa-check"></i><b>10.6</b> Exercises</a></li>
<li class="chapter" data-level="10.7" data-path="inference.html"><a href="inference.html#additional-resources-6"><i class="fa fa-check"></i><b>10.7</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="jupyter.html"><a href="jupyter.html"><i class="fa fa-check"></i><b>11</b> Combining code and text with Jupyter</a>
<ul>
<li class="chapter" data-level="11.1" data-path="jupyter.html"><a href="jupyter.html#overview-11"><i class="fa fa-check"></i><b>11.1</b> Overview</a></li>
<li class="chapter" data-level="11.2" data-path="jupyter.html"><a href="jupyter.html#chapter-learning-objectives-10"><i class="fa fa-check"></i><b>11.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="11.3" data-path="jupyter.html"><a href="jupyter.html#jupyter-1"><i class="fa fa-check"></i><b>11.3</b> Jupyter</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="jupyter.html"><a href="jupyter.html#accessing-jupyter"><i class="fa fa-check"></i><b>11.3.1</b> Accessing Jupyter</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="jupyter.html"><a href="jupyter.html#code-cells"><i class="fa fa-check"></i><b>11.4</b> Code cells</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="jupyter.html"><a href="jupyter.html#executing-code-cells"><i class="fa fa-check"></i><b>11.4.1</b> Executing code cells</a></li>
<li class="chapter" data-level="11.4.2" data-path="jupyter.html"><a href="jupyter.html#the-kernel"><i class="fa fa-check"></i><b>11.4.2</b> The Kernel</a></li>
<li class="chapter" data-level="11.4.3" data-path="jupyter.html"><a href="jupyter.html#creating-new-code-cells"><i class="fa fa-check"></i><b>11.4.3</b> Creating new code cells</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="jupyter.html"><a href="jupyter.html#markdown-cells"><i class="fa fa-check"></i><b>11.5</b> Markdown cells</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="jupyter.html"><a href="jupyter.html#editing-markdown-cells"><i class="fa fa-check"></i><b>11.5.1</b> Editing Markdown cells</a></li>
<li class="chapter" data-level="11.5.2" data-path="jupyter.html"><a href="jupyter.html#creating-new-markdown-cells"><i class="fa fa-check"></i><b>11.5.2</b> Creating new Markdown cells</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="jupyter.html"><a href="jupyter.html#saving-your-work"><i class="fa fa-check"></i><b>11.6</b> Saving your work</a></li>
<li class="chapter" data-level="11.7" data-path="jupyter.html"><a href="jupyter.html#best-practices-for-running-a-notebook"><i class="fa fa-check"></i><b>11.7</b> Best practices for running a notebook</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="jupyter.html"><a href="jupyter.html#best-practices-for-executing-code-cells"><i class="fa fa-check"></i><b>11.7.1</b> Best practices for executing code cells</a></li>
<li class="chapter" data-level="11.7.2" data-path="jupyter.html"><a href="jupyter.html#best-practices-for-including-r-packages-in-notebooks"><i class="fa fa-check"></i><b>11.7.2</b> Best practices for including R packages in notebooks</a></li>
<li class="chapter" data-level="11.7.3" data-path="jupyter.html"><a href="jupyter.html#summary-of-best-practices-for-running-a-notebook"><i class="fa fa-check"></i><b>11.7.3</b> Summary of best practices for running a notebook</a></li>
</ul></li>
<li class="chapter" data-level="11.8" data-path="jupyter.html"><a href="jupyter.html#exploring-data-files"><i class="fa fa-check"></i><b>11.8</b> Exploring data files</a></li>
<li class="chapter" data-level="11.9" data-path="jupyter.html"><a href="jupyter.html#exporting-to-a-different-file-format"><i class="fa fa-check"></i><b>11.9</b> Exporting to a different file format</a>
<ul>
<li class="chapter" data-level="11.9.1" data-path="jupyter.html"><a href="jupyter.html#exporting-to-html"><i class="fa fa-check"></i><b>11.9.1</b> Exporting to HTML</a></li>
<li class="chapter" data-level="11.9.2" data-path="jupyter.html"><a href="jupyter.html#exporting-to-pdf"><i class="fa fa-check"></i><b>11.9.2</b> Exporting to PDF</a></li>
</ul></li>
<li class="chapter" data-level="11.10" data-path="jupyter.html"><a href="jupyter.html#creating-a-new-jupyter-notebook"><i class="fa fa-check"></i><b>11.10</b> Creating a new Jupyter notebook</a></li>
<li class="chapter" data-level="11.11" data-path="jupyter.html"><a href="jupyter.html#additional-resources-7"><i class="fa fa-check"></i><b>11.11</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="version-control.html"><a href="version-control.html"><i class="fa fa-check"></i><b>12</b> Collaboration with version control</a>
<ul>
<li class="chapter" data-level="12.1" data-path="version-control.html"><a href="version-control.html#overview-12"><i class="fa fa-check"></i><b>12.1</b> Overview</a></li>
<li class="chapter" data-level="12.2" data-path="version-control.html"><a href="version-control.html#chapter-learning-objectives-11"><i class="fa fa-check"></i><b>12.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="12.3" data-path="version-control.html"><a href="version-control.html#what-is-version-control-and-why-should-i-use-it"><i class="fa fa-check"></i><b>12.3</b> What is version control, and why should I use it?</a></li>
<li class="chapter" data-level="12.4" data-path="version-control.html"><a href="version-control.html#version-control-repositories"><i class="fa fa-check"></i><b>12.4</b> Version control repositories</a></li>
<li class="chapter" data-level="12.5" data-path="version-control.html"><a href="version-control.html#version-control-workflows"><i class="fa fa-check"></i><b>12.5</b> Version control workflows</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="version-control.html"><a href="version-control.html#commit-changes"><i class="fa fa-check"></i><b>12.5.1</b> Committing changes to a local repository</a></li>
<li class="chapter" data-level="12.5.2" data-path="version-control.html"><a href="version-control.html#pushing-changes-to-a-remote-repository"><i class="fa fa-check"></i><b>12.5.2</b> Pushing changes to a remote repository</a></li>
<li class="chapter" data-level="12.5.3" data-path="version-control.html"><a href="version-control.html#pulling-changes-from-a-remote-repository"><i class="fa fa-check"></i><b>12.5.3</b> Pulling changes from a remote repository</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="version-control.html"><a href="version-control.html#working-with-remote-repositories-using-github"><i class="fa fa-check"></i><b>12.6</b> Working with remote repositories using GitHub</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="version-control.html"><a href="version-control.html#creating-a-remote-repository-on-github"><i class="fa fa-check"></i><b>12.6.1</b> Creating a remote repository on GitHub</a></li>
<li class="chapter" data-level="12.6.2" data-path="version-control.html"><a href="version-control.html#editing-files-on-github-with-the-pen-tool"><i class="fa fa-check"></i><b>12.6.2</b> Editing files on GitHub with the pen tool</a></li>
<li class="chapter" data-level="12.6.3" data-path="version-control.html"><a href="version-control.html#creating-files-on-github-with-the-add-file-menu"><i class="fa fa-check"></i><b>12.6.3</b> Creating files on GitHub with the “Add file” menu</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="version-control.html"><a href="version-control.html#local-repo-jupyter"><i class="fa fa-check"></i><b>12.7</b> Working with local repositories using Jupyter</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="version-control.html"><a href="version-control.html#generating-a-github-personal-access-token"><i class="fa fa-check"></i><b>12.7.1</b> Generating a GitHub personal access token</a></li>
<li class="chapter" data-level="12.7.2" data-path="version-control.html"><a href="version-control.html#cloning-a-repository-using-jupyter"><i class="fa fa-check"></i><b>12.7.2</b> Cloning a repository using Jupyter</a></li>
<li class="chapter" data-level="12.7.3" data-path="version-control.html"><a href="version-control.html#specifying-files-to-commit"><i class="fa fa-check"></i><b>12.7.3</b> Specifying files to commit</a></li>
<li class="chapter" data-level="12.7.4" data-path="version-control.html"><a href="version-control.html#making-the-commit"><i class="fa fa-check"></i><b>12.7.4</b> Making the commit</a></li>
<li class="chapter" data-level="12.7.5" data-path="version-control.html"><a href="version-control.html#pushing-the-commits-to-github"><i class="fa fa-check"></i><b>12.7.5</b> Pushing the commits to GitHub</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="version-control.html"><a href="version-control.html#collaboration"><i class="fa fa-check"></i><b>12.8</b> Collaboration</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="version-control.html"><a href="version-control.html#giving-collaborators-access-to-your-project"><i class="fa fa-check"></i><b>12.8.1</b> Giving collaborators access to your project</a></li>
<li class="chapter" data-level="12.8.2" data-path="version-control.html"><a href="version-control.html#pulling-changes-from-github-using-jupyter"><i class="fa fa-check"></i><b>12.8.2</b> Pulling changes from GitHub using Jupyter</a></li>
<li class="chapter" data-level="12.8.3" data-path="version-control.html"><a href="version-control.html#handling-merge-conflicts"><i class="fa fa-check"></i><b>12.8.3</b> Handling merge conflicts</a></li>
<li class="chapter" data-level="12.8.4" data-path="version-control.html"><a href="version-control.html#communicating-using-github-issues"><i class="fa fa-check"></i><b>12.8.4</b> Communicating using GitHub issues</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="version-control.html"><a href="version-control.html#exercises-10"><i class="fa fa-check"></i><b>12.9</b> Exercises</a></li>
<li class="chapter" data-level="12.10" data-path="version-control.html"><a href="version-control.html#vc-add-res"><i class="fa fa-check"></i><b>12.10</b> Additional resources</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="setup.html"><a href="setup.html"><i class="fa fa-check"></i><b>13</b> Setting up your computer</a>
<ul>
<li class="chapter" data-level="13.1" data-path="setup.html"><a href="setup.html#overview-13"><i class="fa fa-check"></i><b>13.1</b> Overview</a></li>
<li class="chapter" data-level="13.2" data-path="setup.html"><a href="setup.html#chapter-learning-objectives-12"><i class="fa fa-check"></i><b>13.2</b> Chapter learning objectives</a></li>
<li class="chapter" data-level="13.3" data-path="setup.html"><a href="setup.html#obtaining-the-worksheets-for-this-book"><i class="fa fa-check"></i><b>13.3</b> Obtaining the worksheets for this book</a></li>
<li class="chapter" data-level="13.4" data-path="setup.html"><a href="setup.html#working-with-docker"><i class="fa fa-check"></i><b>13.4</b> Working with Docker</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="setup.html"><a href="setup.html#windows"><i class="fa fa-check"></i><b>13.4.1</b> Windows</a></li>
<li class="chapter" data-level="13.4.2" data-path="setup.html"><a href="setup.html#macos"><i class="fa fa-check"></i><b>13.4.2</b> MacOS</a></li>
<li class="chapter" data-level="13.4.3" data-path="setup.html"><a href="setup.html#ubuntu"><i class="fa fa-check"></i><b>13.4.3</b> Ubuntu</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="setup.html"><a href="setup.html#working-with-jupyterlab-desktop"><i class="fa fa-check"></i><b>13.5</b> Working with JupyterLab Desktop</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="setup.html"><a href="setup.html#windows-1"><i class="fa fa-check"></i><b>13.5.1</b> Windows</a></li>
<li class="chapter" data-level="13.5.2" data-path="setup.html"><a href="setup.html#macos-1"><i class="fa fa-check"></i><b>13.5.2</b> MacOS</a></li>
<li class="chapter" data-level="13.5.3" data-path="setup.html"><a href="setup.html#ubuntu-1"><i class="fa fa-check"></i><b>13.5.3</b> Ubuntu</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><p><img src="img/frontmatter/ds-a-first-intro-graphic.jpg" />
Data Science</p></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="classification1" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Classification I: training &amp; predicting<a href="classification1.html#classification1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="overview-4" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Overview<a href="classification1.html#overview-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In previous chapters, we focused solely on descriptive and exploratory
data analysis questions.
This chapter and the next together serve as our first
foray into answering <em>predictive</em> questions about data. In particular, we will
focus on <em>classification</em>, i.e., using one or more
variables to predict the value of a categorical variable of interest. This chapter
will cover the basics of classification, how to preprocess data to make it
suitable for use in a classifier, and how to use our observed data to make
predictions. The next chapter will focus on how to evaluate how accurate the
predictions from our classifier are, as well as how to improve our classifier
(where possible) to maximize its accuracy.</p>
</div>
<div id="chapter-learning-objectives-4" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Chapter learning objectives<a href="classification1.html#chapter-learning-objectives-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>By the end of the chapter, readers will be able to do the following:</p>
<ul>
<li>Recognize situations where a classifier would be appropriate for making predictions.</li>
<li>Describe what a training data set is and how it is used in classification.</li>
<li>Interpret the output of a classifier.</li>
<li>Compute, by hand, the straight-line (Euclidean) distance between points on a graph when there are two predictor variables.</li>
<li>Explain the K-nearest neighbors classification algorithm.</li>
<li>Perform K-nearest neighbors classification in R using <code>tidymodels</code>.</li>
<li>Use a <code>recipe</code> to center, scale, balance, and impute data as a preprocessing step.</li>
<li>Combine preprocessing and model training using a <code>workflow</code>.</li>
</ul>
</div>
<div id="the-classification-problem" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> The classification problem<a href="classification1.html#the-classification-problem" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In many situations, we want to make predictions based on the current situation
as well as past experiences. For instance, a doctor may want to diagnose a
patient as either diseased or healthy based on their symptoms and the doctor’s
past experience with patients; an email provider might want to tag a given
email as “spam” or “not spam” based on the email’s text and past email text data;
or a credit card company may want to predict whether a purchase is fraudulent based
on the current purchase item, amount, and location as well as past purchases.
These tasks are all examples of <strong>classification</strong>, i.e., predicting a
categorical class (sometimes called a <em>label</em>) for an observation given its
other variables (sometimes called <em>features</em>). </p>
<p>Generally, a classifier assigns an observation without a known class (e.g., a new patient)
to a class (e.g., diseased or healthy) on the basis of how similar it is to other observations
for which we do know the class (e.g., previous patients with known diseases and
symptoms). These observations with known classes that we use as a basis for
prediction are called a <strong>training set</strong>; this name comes from the fact that
we use these data to train, or teach, our classifier. Once taught, we can use
the classifier to make predictions on new data for which we do not know the class.</p>
<p>There are many possible methods that we could use to predict
a categorical class/label for an observation. In this book, we will
focus on the widely used <strong>K-nearest neighbors</strong> algorithm <span class="citation">(<a href="#ref-knnfix">Fix and Hodges 1951</a>; <a href="#ref-knncover">Cover and Hart 1967</a>)</span>.
In your future studies, you might encounter decision trees, support vector machines (SVMs),
logistic regression, neural networks, and more; see the additional resources
section at the end of the next chapter for where to begin learning more about
these other methods. It is also worth mentioning that there are many
variations on the basic classification problem. For example,
we focus on the setting of <strong>binary classification</strong> where only two
classes are involved (e.g., a diagnosis of either healthy or diseased), but you may
also run into multiclass classification problems with more than two
categories (e.g., a diagnosis of healthy, bronchitis, pneumonia, or a common cold).</p>
</div>
<div id="exploring-a-data-set" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Exploring a data set<a href="classification1.html#exploring-a-data-set" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this chapter and the next, we will study a data set of
<a href="https://archive.ics.uci.edu/ml/datasets/Breast+Cancer+Wisconsin+%28Diagnostic%29">digitized breast cancer image features</a>,
created by Dr. William H. Wolberg, W. Nick Street, and Olvi L. Mangasarian <span class="citation">(<a href="#ref-streetbreastcancer">Street, Wolberg, and Mangasarian 1993</a>)</span>.
Each row in the data set represents an
image of a tumor sample, including the diagnosis (benign or malignant) and
several other measurements (nucleus texture, perimeter, area, and more).
Diagnosis for each image was conducted by physicians.</p>
<p>As with all data analyses, we first need to formulate a precise question that
we want to answer. Here, the question is <em>predictive</em>: can
we use the tumor
image measurements available to us to predict whether a future tumor image
(with unknown diagnosis) shows a benign or malignant tumor? Answering this
question is important because traditional, non-data-driven methods for tumor
diagnosis are quite subjective and dependent upon how skilled and experienced
the diagnosing physician is. Furthermore, benign tumors are not normally
dangerous; the cells stay in the same place, and the tumor stops growing before
it gets very large. By contrast, in malignant tumors, the cells invade the
surrounding tissue and spread into nearby organs, where they can cause serious
damage <span class="citation">(<a href="#ref-stanfordhealthcare">Stanford Health Care 2021</a>)</span>.
Thus, it is important to quickly and accurately diagnose the tumor type to
guide patient treatment.</p>
<div id="loading-the-cancer-data" class="section level3 hasAnchor" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Loading the cancer data<a href="classification1.html#loading-the-cancer-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Our first step is to load, wrangle, and explore the data using visualizations
in order to better understand the data we are working with. We start by
loading the <code>tidyverse</code> package needed for our analysis.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="classification1.html#cb259-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>In this case, the file containing the breast cancer data set is a <code>.csv</code>
file with headers. We’ll use the <code>read_csv</code> function with no additional
arguments, and then inspect its contents:</p>
<p></p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="classification1.html#cb260-1" tabindex="-1"></a>cancer <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/wdbc.csv&quot;</span>)</span>
<span id="cb260-2"><a href="classification1.html#cb260-2" tabindex="-1"></a>cancer</span></code></pre></div>
<pre><code>## # A tibble: 569 × 12
##        ID Class Radius Texture Perimeter   Area Smoothness Compactness Concavity
##     &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;
##  1 8.42e5 M      1.10   -2.07     1.27    0.984      1.57       3.28      2.65  
##  2 8.43e5 M      1.83   -0.353    1.68    1.91      -0.826     -0.487    -0.0238
##  3 8.43e7 M      1.58    0.456    1.57    1.56       0.941      1.05      1.36  
##  4 8.43e7 M     -0.768   0.254   -0.592  -0.764      3.28       3.40      1.91  
##  5 8.44e7 M      1.75   -1.15     1.78    1.82       0.280      0.539     1.37  
##  6 8.44e5 M     -0.476  -0.835   -0.387  -0.505      2.24       1.24      0.866 
##  7 8.44e5 M      1.17    0.161    1.14    1.09      -0.123      0.0882    0.300 
##  8 8.45e7 M     -0.118   0.358   -0.0728 -0.219      1.60       1.14      0.0610
##  9 8.45e5 M     -0.320   0.588   -0.184  -0.384      2.20       1.68      1.22  
## 10 8.45e7 M     -0.473   1.10    -0.329  -0.509      1.58       2.56      1.74  
## # ℹ 559 more rows
## # ℹ 3 more variables: Concave_Points &lt;dbl&gt;, Symmetry &lt;dbl&gt;,
## #   Fractal_Dimension &lt;dbl&gt;</code></pre>
</div>
<div id="describing-the-variables-in-the-cancer-data-set" class="section level3 hasAnchor" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Describing the variables in the cancer data set<a href="classification1.html#describing-the-variables-in-the-cancer-data-set" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Breast tumors can be diagnosed by performing a <em>biopsy</em>, a process where
tissue is removed from the body and examined for the presence of disease.
Traditionally these procedures were quite invasive; modern methods such as fine
needle aspiration, used to collect the present data set, extract only a small
amount of tissue and are less invasive. Based on a digital image of each breast
tissue sample collected for this data set, ten different variables were measured
for each cell nucleus in the image (items 3–12 of the list of variables below), and then the mean
for each variable across the nuclei was recorded. As part of the
data preparation, these values have been <em>standardized (centered and scaled)</em>; we will discuss what this
means and why we do it later in this chapter. Each image additionally was given
a unique ID and a diagnosis by a physician. Therefore, the
total set of variables per image in this data set is:</p>
<ol style="list-style-type: decimal">
<li>ID: identification number</li>
<li>Class: the diagnosis (M = malignant or B = benign)</li>
<li>Radius: the mean of distances from center to points on the perimeter</li>
<li>Texture: the standard deviation of gray-scale values</li>
<li>Perimeter: the length of the surrounding contour</li>
<li>Area: the area inside the contour</li>
<li>Smoothness: the local variation in radius lengths</li>
<li>Compactness: the ratio of squared perimeter and area</li>
<li>Concavity: severity of concave portions of the contour</li>
<li>Concave Points: the number of concave portions of the contour</li>
<li>Symmetry: how similar the nucleus is when mirrored</li>
<li>Fractal Dimension: a measurement of how “rough” the perimeter is</li>
</ol>
<div style="page-break-after: always;"></div>
<p>Below we use <code>glimpse</code> to preview the data frame. This function can
make it easier to inspect the data when we have a lot of columns,
as it prints the data such that the columns go down
the page (instead of across).</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="classification1.html#cb262-1" tabindex="-1"></a><span class="fu">glimpse</span>(cancer)</span></code></pre></div>
<pre><code>## Rows: 569
## Columns: 12
## $ ID                &lt;dbl&gt; 842302, 842517, 84300903, 84348301, 84358402, 843786…
## $ Class             &lt;chr&gt; &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M…
## $ Radius            &lt;dbl&gt; 1.0960995, 1.8282120, 1.5784992, -0.7682333, 1.74875…
## $ Texture           &lt;dbl&gt; -2.0715123, -0.3533215, 0.4557859, 0.2535091, -1.150…
## $ Perimeter         &lt;dbl&gt; 1.26881726, 1.68447255, 1.56512598, -0.59216612, 1.7…
## $ Area              &lt;dbl&gt; 0.98350952, 1.90703027, 1.55751319, -0.76379174, 1.8…
## $ Smoothness        &lt;dbl&gt; 1.56708746, -0.82623545, 0.94138212, 3.28066684, 0.2…
## $ Compactness       &lt;dbl&gt; 3.28062806, -0.48664348, 1.05199990, 3.39991742, 0.5…
## $ Concavity         &lt;dbl&gt; 2.65054179, -0.02382489, 1.36227979, 1.91421287, 1.3…
## $ Concave_Points    &lt;dbl&gt; 2.53024886, 0.54766227, 2.03543978, 1.45043113, 1.42…
## $ Symmetry          &lt;dbl&gt; 2.215565542, 0.001391139, 0.938858720, 2.864862154, …
## $ Fractal_Dimension &lt;dbl&gt; 2.25376381, -0.86788881, -0.39765801, 4.90660199, -0…</code></pre>
<p>From the summary of the data above, we can see that <code>Class</code> is of type character
(denoted by <code>&lt;chr&gt;</code>). We can use the <code>distinct</code> function to see all the unique
values present in that column. We see that there are two diagnoses: benign, represented by “B”,
and malignant, represented by “M”.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="classification1.html#cb264-1" tabindex="-1"></a>cancer <span class="sc">|&gt;</span></span>
<span id="cb264-2"><a href="classification1.html#cb264-2" tabindex="-1"></a>  <span class="fu">distinct</span>(Class)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 1
##   Class
##   &lt;chr&gt;
## 1 M    
## 2 B</code></pre>
<p>Since we will be working with <code>Class</code> as a categorical
variable, it is a good idea to convert it to a factor type using the <code>as_factor</code> function.
We will also improve the readability of our analysis by renaming “M” to
“Malignant” and “B” to “Benign” using the <code>fct_recode</code> method. The <code>fct_recode</code> method
is used to replace the names of factor values with other names. The arguments of <code>fct_recode</code> are the column that you
want to modify, followed any number of arguments of the form <code>"new name" = "old name"</code> to specify the renaming scheme.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="classification1.html#cb266-1" tabindex="-1"></a>cancer <span class="ot">&lt;-</span> cancer <span class="sc">|&gt;</span></span>
<span id="cb266-2"><a href="classification1.html#cb266-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">as_factor</span>(Class)) <span class="sc">|&gt;</span></span>
<span id="cb266-3"><a href="classification1.html#cb266-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">fct_recode</span>(Class, <span class="st">&quot;Malignant&quot;</span> <span class="ot">=</span> <span class="st">&quot;M&quot;</span>, <span class="st">&quot;Benign&quot;</span> <span class="ot">=</span> <span class="st">&quot;B&quot;</span>))</span>
<span id="cb266-4"><a href="classification1.html#cb266-4" tabindex="-1"></a><span class="fu">glimpse</span>(cancer)</span></code></pre></div>
<pre><code>## Rows: 569
## Columns: 12
## $ ID                &lt;dbl&gt; 842302, 842517, 84300903, 84348301, 84358402, 843786…
## $ Class             &lt;fct&gt; Malignant, Malignant, Malignant, Malignant, Malignan…
## $ Radius            &lt;dbl&gt; 1.0960995, 1.8282120, 1.5784992, -0.7682333, 1.74875…
## $ Texture           &lt;dbl&gt; -2.0715123, -0.3533215, 0.4557859, 0.2535091, -1.150…
## $ Perimeter         &lt;dbl&gt; 1.26881726, 1.68447255, 1.56512598, -0.59216612, 1.7…
## $ Area              &lt;dbl&gt; 0.98350952, 1.90703027, 1.55751319, -0.76379174, 1.8…
## $ Smoothness        &lt;dbl&gt; 1.56708746, -0.82623545, 0.94138212, 3.28066684, 0.2…
## $ Compactness       &lt;dbl&gt; 3.28062806, -0.48664348, 1.05199990, 3.39991742, 0.5…
## $ Concavity         &lt;dbl&gt; 2.65054179, -0.02382489, 1.36227979, 1.91421287, 1.3…
## $ Concave_Points    &lt;dbl&gt; 2.53024886, 0.54766227, 2.03543978, 1.45043113, 1.42…
## $ Symmetry          &lt;dbl&gt; 2.215565542, 0.001391139, 0.938858720, 2.864862154, …
## $ Fractal_Dimension &lt;dbl&gt; 2.25376381, -0.86788881, -0.39765801, 4.90660199, -0…</code></pre>
<p>Let’s verify that we have successfully converted the <code>Class</code> column to a factor variable
and renamed its values to “Benign” and “Malignant” using the <code>distinct</code> function once more.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="classification1.html#cb268-1" tabindex="-1"></a>cancer <span class="sc">|&gt;</span></span>
<span id="cb268-2"><a href="classification1.html#cb268-2" tabindex="-1"></a>  <span class="fu">distinct</span>(Class)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 1
##   Class    
##   &lt;fct&gt;    
## 1 Malignant
## 2 Benign</code></pre>
</div>
<div id="exploring-the-cancer-data" class="section level3 hasAnchor" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> Exploring the cancer data<a href="classification1.html#exploring-the-cancer-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before we start doing any modeling, let’s explore our data set. Below we use
the <code>group_by</code>, <code>summarize</code> and <code>n</code> functions to find the number and percentage
of benign and malignant tumor observations in our data set. The <code>n</code> function within
<code>summarize</code>, when paired with <code>group_by</code>, counts the number of observations in each <code>Class</code> group.
Then we calculate the percentage in each group by dividing by the total number of observations
and multiplying by 100. We have 357 (63%) benign and 212 (37%) malignant tumor observations.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="classification1.html#cb270-1" tabindex="-1"></a>num_obs <span class="ot">&lt;-</span> <span class="fu">nrow</span>(cancer)</span>
<span id="cb270-2"><a href="classification1.html#cb270-2" tabindex="-1"></a>cancer <span class="sc">|&gt;</span></span>
<span id="cb270-3"><a href="classification1.html#cb270-3" tabindex="-1"></a>  <span class="fu">group_by</span>(Class) <span class="sc">|&gt;</span></span>
<span id="cb270-4"><a href="classification1.html#cb270-4" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb270-5"><a href="classification1.html#cb270-5" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb270-6"><a href="classification1.html#cb270-6" tabindex="-1"></a>    <span class="at">percentage =</span> <span class="fu">n</span>() <span class="sc">/</span> num_obs <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb270-7"><a href="classification1.html#cb270-7" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   Class     count percentage
##   &lt;fct&gt;     &lt;int&gt;      &lt;dbl&gt;
## 1 Malignant   212       37.3
## 2 Benign      357       62.7</code></pre>
<p>Next, let’s draw a scatter plot to visualize the relationship between the
perimeter and concavity variables. Rather than use <code>ggplot's</code> default palette,
we select our own colorblind-friendly colors—<code>"darkorange"</code>
for orange and <code>"steelblue"</code> for blue—and
pass them as the <code>values</code> argument to the <code>scale_color_manual</code> function.</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="classification1.html#cb272-1" tabindex="-1"></a>perim_concav <span class="ot">&lt;-</span> cancer <span class="sc">|&gt;</span></span>
<span id="cb272-2"><a href="classification1.html#cb272-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Perimeter, <span class="at">y =</span> Concavity, <span class="at">color =</span> Class)) <span class="sc">+</span></span>
<span id="cb272-3"><a href="classification1.html#cb272-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb272-4"><a href="classification1.html#cb272-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Perimeter (standardized)&quot;</span>,</span>
<span id="cb272-5"><a href="classification1.html#cb272-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Concavity (standardized)&quot;</span>,</span>
<span id="cb272-6"><a href="classification1.html#cb272-6" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Diagnosis&quot;</span>) <span class="sc">+</span></span>
<span id="cb272-7"><a href="classification1.html#cb272-7" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;steelblue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb272-8"><a href="classification1.html#cb272-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb272-9"><a href="classification1.html#cb272-9" tabindex="-1"></a>perim_concav</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:05-scatter"></span>
<img src="_main_files/figure-html/05-scatter-1.png" alt="Scatter plot of concavity versus perimeter colored by diagnosis label." width="432" />
<p class="caption">
Figure 5.1: Scatter plot of concavity versus perimeter colored by diagnosis label.
</p>
</div>
<p>In Figure <a href="classification1.html#fig:05-scatter">5.1</a>, we can see that malignant observations typically fall in
the upper right-hand corner of the plot area. By contrast, benign
observations typically fall in the lower left-hand corner of the plot. In other words,
benign observations tend to have lower concavity and perimeter values, and malignant
ones tend to have larger values. Suppose we
obtain a new observation not in the current data set that has all the variables
measured <em>except</em> the label (i.e., an image without the physician’s diagnosis
for the tumor class). We could compute the standardized perimeter and concavity values,
resulting in values of, say, 1 and 1. Could we use this information to classify
that observation as benign or malignant? Based on the scatter plot, how might
you classify that new observation? If the standardized concavity and perimeter
values are 1 and 1 respectively, the point would lie in the middle of the
orange cloud of malignant points and thus we could probably classify it as
malignant. Based on our visualization, it seems like it may be possible
to make accurate predictions of the <code>Class</code> variable (i.e., a diagnosis) for
tumor images with unknown diagnoses.</p>
</div>
</div>
<div id="classification-with-k-nearest-neighbors" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Classification with K-nearest neighbors<a href="classification1.html#classification-with-k-nearest-neighbors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In order to actually make predictions for new observations in practice, we
will need a classification algorithm.
In this book, we will use the K-nearest neighbors classification algorithm.
To predict the label of a new observation (here, classify it as either benign
or malignant), the K-nearest neighbors classifier generally finds the <span class="math inline">\(K\)</span>
“nearest” or “most similar” observations in our training set, and then uses
their diagnoses to make a prediction for the new observation’s diagnosis. <span class="math inline">\(K\)</span>
is a number that we must choose in advance; for now, we will assume that someone has chosen
<span class="math inline">\(K\)</span> for us. We will cover how to choose <span class="math inline">\(K\)</span> ourselves in the next chapter.</p>
<p>To illustrate the concept of K-nearest neighbors classification, we
will walk through an example. Suppose we have a
new observation, with standardized perimeter of 2 and standardized concavity of 4, whose
diagnosis “Class” is unknown. This new observation is depicted by the red, diamond point in
Figure <a href="classification1.html#fig:05-knn-1">5.2</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:05-knn-1"></span>
<img src="_main_files/figure-html/05-knn-1-1.png" alt="Scatter plot of concavity versus perimeter with new observation represented as a red diamond." width="432" />
<p class="caption">
Figure 5.2: Scatter plot of concavity versus perimeter with new observation represented as a red diamond.
</p>
</div>
<p>Figure <a href="classification1.html#fig:05-knn-2">5.3</a> shows that the nearest point to this new observation is <strong>malignant</strong> and
located at the coordinates (2.1, 3.6). The idea here is that if a point is close to another in the scatter plot,
then the perimeter and concavity values are similar, and so we may expect that
they would have the same diagnosis.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:05-knn-2"></span>
<img src="_main_files/figure-html/05-knn-2-1.png" alt="Scatter plot of concavity versus perimeter. The new observation is represented as a red diamond with a line to the one nearest neighbor, which has a malignant label." width="432" />
<p class="caption">
Figure 5.3: Scatter plot of concavity versus perimeter. The new observation is represented as a red diamond with a line to the one nearest neighbor, which has a malignant label.
</p>
</div>
<p>Suppose we have another new observation with standardized perimeter 0.2 and
concavity of 3.3. Looking at the scatter plot in Figure <a href="classification1.html#fig:05-knn-4">5.4</a>, how would you
classify this red, diamond observation? The nearest neighbor to this new point is a
<strong>benign</strong> observation at (0.2, 2.7).
Does this seem like the right prediction to make for this observation? Probably
not, if you consider the other nearby points.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:05-knn-4"></span>
<img src="_main_files/figure-html/05-knn-4-1.png" alt="Scatter plot of concavity versus perimeter. The new observation is represented as a red diamond with a line to the one nearest neighbor, which has a benign label." width="432" />
<p class="caption">
Figure 5.4: Scatter plot of concavity versus perimeter. The new observation is represented as a red diamond with a line to the one nearest neighbor, which has a benign label.
</p>
</div>
<p>To improve the prediction we can consider several
neighboring points, say <span class="math inline">\(K = 3\)</span>, that are closest to the new observation
to predict its diagnosis class. Among those 3 closest points, we use the
<em>majority class</em> as our prediction for the new observation. As shown in Figure <a href="classification1.html#fig:05-knn-5">5.5</a>, we
see that the diagnoses of 2 of the 3 nearest neighbors to our new observation
are malignant. Therefore we take majority vote and classify our new red, diamond
observation as malignant.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:05-knn-5"></span>
<img src="_main_files/figure-html/05-knn-5-1.png" alt="Scatter plot of concavity versus perimeter with three nearest neighbors." width="432" />
<p class="caption">
Figure 5.5: Scatter plot of concavity versus perimeter with three nearest neighbors.
</p>
</div>
<p>Here we chose the <span class="math inline">\(K=3\)</span> nearest observations, but there is nothing special
about <span class="math inline">\(K=3\)</span>. We could have used <span class="math inline">\(K=4, 5\)</span> or more (though we may want to choose
an odd number to avoid ties). We will discuss more about choosing <span class="math inline">\(K\)</span> in the
next chapter.</p>
<div id="distance-between-points" class="section level3 hasAnchor" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Distance between points<a href="classification1.html#distance-between-points" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We decide which points are the <span class="math inline">\(K\)</span> “nearest” to our new observation
using the <em>straight-line distance</em> (we will often just refer to this as <em>distance</em>).
Suppose we have two observations <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>, each having two predictor variables, <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.
Denote <span class="math inline">\(a_x\)</span> and <span class="math inline">\(a_y\)</span> to be the values of variables <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> for observation <span class="math inline">\(a\)</span>;
<span class="math inline">\(b_x\)</span> and <span class="math inline">\(b_y\)</span> have similar definitions for observation <span class="math inline">\(b\)</span>.
Then the straight-line distance between observation <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> on the x-y plane can
be computed using the following formula:</p>
<p><span class="math display">\[\mathrm{Distance} = \sqrt{(a_x -b_x)^2 + (a_y - b_y)^2}\]</span></p>
<p>To find the <span class="math inline">\(K\)</span> nearest neighbors to our new observation, we compute the distance
from that new observation to each observation in our training data, and select the <span class="math inline">\(K\)</span> observations corresponding to the
<span class="math inline">\(K\)</span> <em>smallest</em> distance values. For example, suppose we want to use <span class="math inline">\(K=5\)</span> neighbors to classify a new
observation with perimeter of 0 and
concavity of 3.5, shown as a red diamond in Figure <a href="classification1.html#fig:05-multiknn-1">5.6</a>. Let’s calculate the distances
between our new point and each of the observations in the training set to find
the <span class="math inline">\(K=5\)</span> neighbors that are nearest to our new point.
You will see in the <code>mutate</code> step below, we compute the straight-line
distance using the formula above: we square the differences between the two observations’ perimeter
and concavity coordinates, add the squared differences, and then take the square root.
In order to find the <span class="math inline">\(K=5\)</span> nearest neighbors, we will use the <code>slice_min</code> function. </p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:05-multiknn-1"></span>
<img src="_main_files/figure-html/05-multiknn-1-1.png" alt="Scatter plot of concavity versus perimeter with new observation represented as a red diamond." width="432"  />
<p class="caption">
Figure 5.6: Scatter plot of concavity versus perimeter with new observation represented as a red diamond.
</p>
</div>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="classification1.html#cb273-1" tabindex="-1"></a>new_obs_Perimeter <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb273-2"><a href="classification1.html#cb273-2" tabindex="-1"></a>new_obs_Concavity <span class="ot">&lt;-</span> <span class="fl">3.5</span></span>
<span id="cb273-3"><a href="classification1.html#cb273-3" tabindex="-1"></a>cancer <span class="sc">|&gt;</span></span>
<span id="cb273-4"><a href="classification1.html#cb273-4" tabindex="-1"></a>  <span class="fu">select</span>(ID, Perimeter, Concavity, Class) <span class="sc">|&gt;</span></span>
<span id="cb273-5"><a href="classification1.html#cb273-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_from_new =</span> <span class="fu">sqrt</span>((Perimeter <span class="sc">-</span> new_obs_Perimeter)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb273-6"><a href="classification1.html#cb273-6" tabindex="-1"></a>                              (Concavity <span class="sc">-</span> new_obs_Concavity)<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">|&gt;</span></span>
<span id="cb273-7"><a href="classification1.html#cb273-7" tabindex="-1"></a>  <span class="fu">slice_min</span>(dist_from_new, <span class="at">n =</span> <span class="dv">5</span>) <span class="co"># take the 5 rows of minimum distance</span></span></code></pre></div>
<pre><code>## # A tibble: 5 × 5
##        ID Perimeter Concavity Class     dist_from_new
##     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt;             &lt;dbl&gt;
## 1   86409     0.241      2.65 Benign            0.881
## 2  887181     0.750      2.87 Malignant         0.980
## 3  899667     0.623      2.54 Malignant         1.14 
## 4  907914     0.417      2.31 Malignant         1.26 
## 5 8710441    -1.16       4.04 Benign            1.28</code></pre>
<p>In Table <a href="classification1.html#tab:05-multiknn-mathtable">5.1</a> we show in mathematical detail how
the <code>mutate</code> step was used to compute the <code>dist_from_new</code> variable (the
distance to the new observation) for each of the 5 nearest neighbors in the
training data.</p>
<table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:05-multiknn-mathtable">Table 5.1: </span>Evaluating the distances from the new observation to each of its 5 nearest neighbors
</caption>
<thead>
<tr>
<th style="text-align:right;">
Perimeter
</th>
<th style="text-align:right;">
Concavity
</th>
<th style="text-align:left;">
Distance
</th>
<th style="text-align:left;">
Class
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
2.65
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{(0 - 0.24)^2 + (3.5 - 2.65)^2} = 0.88\)</span>
</td>
<td style="text-align:left;">
Benign
</td>
</tr>
<tr>
<td style="text-align:right;">
0.75
</td>
<td style="text-align:right;">
2.87
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{(0 - 0.75)^2 + (3.5 - 2.87)^2} = 0.98\)</span>
</td>
<td style="text-align:left;">
Malignant
</td>
</tr>
<tr>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;">
2.54
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{(0 - 0.62)^2 + (3.5 - 2.54)^2} = 1.14\)</span>
</td>
<td style="text-align:left;">
Malignant
</td>
</tr>
<tr>
<td style="text-align:right;">
0.42
</td>
<td style="text-align:right;">
2.31
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{(0 - 0.42)^2 + (3.5 - 2.31)^2} = 1.26\)</span>
</td>
<td style="text-align:left;">
Malignant
</td>
</tr>
<tr>
<td style="text-align:right;">
-1.16
</td>
<td style="text-align:right;">
4.04
</td>
<td style="text-align:left;">
<span class="math inline">\(\sqrt{(0 - (-1.16))^2 + (3.5 - 4.04)^2} = 1.28\)</span>
</td>
<td style="text-align:left;">
Benign
</td>
</tr>
</tbody>
</table>
<p>The result of this computation shows that 3 of the 5 nearest neighbors to our new observation are
malignant; since this is the majority, we classify our new observation as malignant.
These 5 neighbors are circled in Figure <a href="classification1.html#fig:05-multiknn-3">5.7</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:05-multiknn-3"></span>
<img src="_main_files/figure-html/05-multiknn-3-1.png" alt="Scatter plot of concavity versus perimeter with 5 nearest neighbors circled." width="432" />
<p class="caption">
Figure 5.7: Scatter plot of concavity versus perimeter with 5 nearest neighbors circled.
</p>
</div>
</div>
<div id="more-than-two-explanatory-variables" class="section level3 hasAnchor" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> More than two explanatory variables<a href="classification1.html#more-than-two-explanatory-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Although the above description is directed toward two predictor variables,
exactly the same K-nearest neighbors algorithm applies when you
have a higher number of predictor variables. Each predictor variable may give us new
information to help create our classifier. The only difference is the formula
for the distance between points. Suppose we have <span class="math inline">\(m\)</span> predictor
variables for two observations <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>, i.e.,
<span class="math inline">\(a = (a_{1}, a_{2}, \dots, a_{m})\)</span> and
<span class="math inline">\(b = (b_{1}, b_{2}, \dots, b_{m})\)</span>.</p>
<p>The distance formula becomes </p>
<p><span class="math display">\[\mathrm{Distance} = \sqrt{(a_{1} -b_{1})^2 + (a_{2} - b_{2})^2 + \dots + (a_{m} - b_{m})^2}.\]</span></p>
<p>This formula still corresponds to a straight-line distance, just in a space
with more dimensions. Suppose we want to calculate the distance between a new
observation with a perimeter of 0, concavity of 3.5, and symmetry of 1, and
another observation with a perimeter, concavity, and symmetry of 0.417, 2.31, and
0.837 respectively. We have two observations with three predictor variables:
perimeter, concavity, and symmetry. Previously, when we had two variables, we
added up the squared difference between each of our (two) variables, and then
took the square root. Now we will do the same, except for our three variables.
We calculate the distance as follows</p>
<p><span class="math display">\[\mathrm{Distance} =\sqrt{(0 - 0.417)^2 + (3.5 - 2.31)^2 + (1 - 0.837)^2} = 1.27.\]</span></p>
<p>Let’s calculate the distances between our new observation and each of the
observations in the training set to find the <span class="math inline">\(K=5\)</span> neighbors when we have these
three predictors.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="classification1.html#cb275-1" tabindex="-1"></a>new_obs_Perimeter <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb275-2"><a href="classification1.html#cb275-2" tabindex="-1"></a>new_obs_Concavity <span class="ot">&lt;-</span> <span class="fl">3.5</span></span>
<span id="cb275-3"><a href="classification1.html#cb275-3" tabindex="-1"></a>new_obs_Symmetry <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb275-4"><a href="classification1.html#cb275-4" tabindex="-1"></a>cancer <span class="sc">|&gt;</span></span>
<span id="cb275-5"><a href="classification1.html#cb275-5" tabindex="-1"></a>  <span class="fu">select</span>(ID, Perimeter, Concavity, Symmetry, Class) <span class="sc">|&gt;</span></span>
<span id="cb275-6"><a href="classification1.html#cb275-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dist_from_new =</span> <span class="fu">sqrt</span>((Perimeter <span class="sc">-</span> new_obs_Perimeter)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb275-7"><a href="classification1.html#cb275-7" tabindex="-1"></a>                              (Concavity <span class="sc">-</span> new_obs_Concavity)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span></span>
<span id="cb275-8"><a href="classification1.html#cb275-8" tabindex="-1"></a>                                (Symmetry <span class="sc">-</span> new_obs_Symmetry)<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">|&gt;</span></span>
<span id="cb275-9"><a href="classification1.html#cb275-9" tabindex="-1"></a>  <span class="fu">slice_min</span>(dist_from_new, <span class="at">n =</span> <span class="dv">5</span>) <span class="co"># take the 5 rows of minimum distance</span></span></code></pre></div>
<pre><code>## # A tibble: 5 × 6
##         ID Perimeter Concavity Symmetry Class     dist_from_new
##      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;             &lt;dbl&gt;
## 1   907914     0.417      2.31    0.837 Malignant          1.27
## 2 90439701     1.33       2.89    1.10  Malignant          1.47
## 3   925622     0.470      2.08    1.15  Malignant          1.50
## 4   859471    -1.37       2.81    1.09  Benign             1.53
## 5   899667     0.623      2.54    2.06  Malignant          1.56</code></pre>
<p>Based on <span class="math inline">\(K=5\)</span> nearest neighbors with these three predictors, we would classify
the new observation as malignant since 4 out of 5 of the nearest neighbors are from the malignant class.
Figure <a href="classification1.html#fig:05-more">5.8</a> shows what the data look like when we visualize them
as a 3-dimensional scatter with lines from the new observation to its five nearest neighbors.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:05-more"></span>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-467f3ada599dec390e71" style="width:100%;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-467f3ada599dec390e71">{"x":{"visdat":{"154ec6c41":["function () ","plotlyVisDat"]},"cur_data":"154ec6c41","attrs":{"154ec6c41":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":{},"y":{},"z":{},"color":{},"opacity":0.40000000000000002,"size":2,"colors":["steelblue","darkorange","red"],"symbol":{},"symbols":["circle","circle","diamond"],"inherit":true},"154ec6c41.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,0.41692968902384292],"y":[3.5,2.3143643615455431],"z":[1,0.83672217416289252],"type":"scatter3d","mode":"lines","name":"lines","showlegend":false,"color":["darkorange"],"inherit":true},"154ec6c41.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1.3346636452104552],"y":[3.5,2.8863677411206989],"z":[1,1.0993590061025895],"type":"scatter3d","mode":"lines","name":"lines","showlegend":false,"color":["darkorange"],"inherit":true},"154ec6c41.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,0.47042987481050685],"y":[3.5,2.0848103736897245],"z":[1,1.1540750127566932],"type":"scatter3d","mode":"lines","name":"lines","showlegend":false,"color":["darkorange"],"inherit":true},"154ec6c41.4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,-1.3654495774533837],"y":[3.5,2.8123585319212818],"z":[1,1.0920635385487101],"type":"scatter3d","mode":"lines","name":"lines","showlegend":false,"color":["steelblue"],"inherit":true},"154ec6c41.5":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,0.62269963435716391],"y":[3.5,2.5414095626488402],"z":[1,2.0550652556609337],"type":"scatter3d","mode":"lines","name":"lines","showlegend":false,"color":["darkorange"],"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Perimeter","titlefont":{"size":14}},"yaxis":{"title":"Concavity","titlefont":{"size":14}},"zaxis":{"title":"Symmetry","titlefont":{"size":14}}},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[-0.18556471091212109,-0.26087651090411651,-1.3016608944000541,-0.38516155788544226,-1.6568198200453661,-0.57323528792009737,-0.2081994048987863,-0.70986653162142288,-0.19585320817878715,-0.66912408244542554,-0.76665903653341927,-0.38516155788544226,-1.5485848288000392,-1.1284026004293981,-1.535415552298707,-1.3485764419360513,-1.3111263118853869,-0.83003617969608245,-1.3654495774533837,-0.43619250432810569,-1.3654495774533837,-0.5259082004934339,-0.1670454158321221,-0.36129224422677708,-0.74731666167208721,-0.22548408030678532,-0.6180931360027615,-0.50162734694410194,0.15642493823185857,0.1070401513518614,-0.29750356117344767,-0.22095714150945228,-0.58352378518676351,-1.2288183337520586,-0.72550504746675515,-1.9827594134533468,-0.60698155895476236,-1.1530949938693962,-1.0107021916987384,-0.69134723654142383,-0.53331591852543314,-0.80205146713075048,-1.2127682780160594,-0.40409239285610754,0.24120215570918691,-0.96008278514674117,-1.4868538452000428,-0.63537781141076055,-1.3675072769067167,-0.76665903653341927,0.095105494522529102,-0.2415341360427844,-0.14523380162679,0.31322163657584928,-0.53043513929076691,0.41281429011717674,-0.70986653162142288,-0.7781821534720853,-0.78065139281608531,-1.2646223042400562,-0.75348976003208701,-0.3386575502401119,-0.97572130099207344,-0.57035450868543125,0.24161369559985377,0.082347757911863106,-0.15840307812812229,-0.34812296772544427,-1.5926195971013699,-1.1600911720107292,-0.8683093895280799,-0.27404578740544877,-0.56376987043476512,0.67619982014382785,-0.62262007480009463,-0.95802508569340805,-0.65307402670942649,-0.49874656770943571,0.14531336118385935,-0.95473276656807504,0.17494423331185757,-0.53990055677609994,-0.89547102231207865,-1.0074098725734053,-1.5452925096747061,-1.1263449009760649,-0.40985395132544056,-0.4394848234534387,-0.75883977861075325,-1.1609142517920623,-0.71151269118408911,-0.6872318376347577,-0.54072363655743305,-0.40944241143477428,-1.2856108386640552,-0.38845387701077538,-0.55265829338676531,-0.44771562126677172,-1.1954836026080604,-0.20367246610145329,0.25519451199185289,-0.6773548802587579,-0.60286616004809623,-1.1078256058960658,-0.16828003550412207,-0.13906070326679015,-1.104944826661399,-0.30532281909611381,0.022262933874533611,-1.0432138430614026,0.22556363986385469,-0.43701558410943936,-0.83168233925874868,-0.87160170865341291,-1.3070109129787204,-0.089675916386792981,0.023909093437199859,-0.18885703003745416,-0.54977751415209908,-0.74237818298408731,-0.14111840272012324,-1.0390984441547366,-0.32260749450411286,-0.28886122346944787,-0.98600979825873958,-0.74484742232808721,-0.76912827587741928,-0.93374423214407598,-0.19791090763212024,-0.39462697537077518,-0.92469035454940995,-0.068687381962794614,-0.81233996439741651,-1.2539222670827237,-0.6489586278027597,-0.83044771958674868,-0.23577257757345135,-0.1225991076401248,-0.72962044637342183,-0.32466519395744592,-0.49956964749076882,-0.58023146606143039,-0.41479243001344046,-0.75102052068808711,-0.81480920374141652,0.16712497538919149,0.20827896445585567,-0.3633499436801102,-0.67612026058675789,-0.41931936881077347,-0.16087231747212222,-0.93950579061340922,-0.030825712021463461,-1.0337484255760705,-0.47487725405076991,-1.0333368856854035,-0.75637053926675324,-0.73003198626408816,-0.32507673384811281,-1.4654537708853776,-0.25840727156011656,-0.38104615897877608,-0.72591658735742193,0.0292591120158666,-0.39833083438677452,-0.75060898079742022,-1.5588733260667054,-0.5259082004934339,-0.60574693928276235,-1.3127724714480535,-0.55018905404276597,-1.0473292419680695,-0.37651922018144302,-0.57446990759209737,-0.44113098301610554,-0.079798959010793785,-0.65348556660009272,-0.30655743876811375,-0.82427462122674944,-0.84732085510408151,-0.57981992617076417,-0.32466519395744592,-1.134164158898731,0.089755475943862933,-1.2481607086133906,-0.84279391630674849,-0.69710879501075684,-1.0604985184694018,-0.63002779283209442,0.11938634807186112,-0.7798283130347522,-0.60657001906409547,-0.75184360046942023,-0.85308241357341452,-0.41355781034144046,-0.28309966500011485,-0.14194148250145694,-1.4498152550400452,-1.3230609687147197,-0.51644278300810098,-0.27692656664011561,-0.41561550979477357,0.60212263982383185,-0.26704960926411581,-0.56212371087209823,0.23379443767718769,-0.1699261950667883,0.5897764431038327,-0.89794026165607799,-0.25017647374678365,-0.152229979768123,-0.77406675456541918,-0.87654018734141281,-0.54401595568276606,-0.46623491634677072,-0.25429187265344982,-0.54278133601076606,-0.14811458086145624,-0.76501287697075304,-1.0790178135494009,-1.5103116189680414,-0.57200066824809803,-0.091322075949459805,-0.15922615790945599,-0.3670538026961101,-0.89135562340541186,-0.68764337752542393,-0.6514278671467596,-0.32054979505077918,-0.36170378411744336,-0.56294679065343134,-0.88806330428007885,0.50746846497050424,-0.38433847810410909,-0.5580083119654321,-0.80163992724008426,-0.86625169007474678,-1.325941747949386,0.22885595898918781,-0.64113936988009357,-1.3321148463093857,-0.45635795897077153,-0.86501707040274678,-0.73126660593608805,0.25725221144518601,-0.67941257971209157,-0.10325673277879267,-1.236226051784058,-1.1843720255600612,-1.0074098725734053,-0.95390968678674137,-0.88477098515474573,-0.45224256006410474,-0.43207710542143951,0.12020942785319425,-0.38269231854144231,-0.090087456277459843,-0.13535684425079025,-0.097906714200125936,-0.83291695893074869,-0.14811458086145624,-1.0349830452480704,-0.59093150321876331,0.16095187702919159,0.093870874850529126,-0.6230316146907614,-0.62550085403476141,0.077820819114530065,-0.46705799612810384,-0.23165717866678465,-0.70369343326142297,-0.32384211417611281,-0.38516155788544226,-1.2465145490507239,0.01156289671720071,-0.74443588243742098,-0.31643439614411295,-0.20984556446145253,-0.24647261473078369,-1.2720300222720555,-0.64155090977076046,-1.2543338069733905,-0.62220853490942829,0.18440965079719049,-0.59875076114142944,-0.88724022449874573,-0.37363844094677623,0.018147534967866839,-0.12342218742145794,-0.73990894364008797,-0.56294679065343134,-0.13329914479745714,-0.19132626938145411,-0.17321851419212136,0.445737481370508,-0.37528460050944307,0.092224715287862302,-0.67817796004009157,-0.56747372945076435,0.93135455235714559,-0.54072363655743305,-0.32548827373877903,0.17082883440519139,-0.3818692387601092,-0.4740541742694368,0.27824074586918496,-0.44113098301610554,-1.2543338069733905,-1.1460988157280632,-0.51438508355476786,-0.85267087368274763,0.52393006059717018,-0.64443168900542669,0.11074401036786131,0.095517034413195964,-0.79052835019208445,-0.30943821800277999,-0.3892769567921085,-1.3172994102453863,-0.85061317422941451,-0.13329914479745714,-1.1921912834827273,-1.5407655708773731,-0.18638779069345421,-0.53619669776009993,-0.068275842072127751,-0.58187762562409717,-0.66171636441342574,-0.6897010769787576,-0.17321851419212136,-0.87160170865341291,-0.64196244966142668,-1.810324199264024,-1.7955087632000244,-0.71274731085608911,0.15807109779452538,0.11239016993052814,-0.29174200270411466,-0.090498996168126677,-0.19667628796012027,-1.0971255687387329,-1.0749024146427346,-1.2724415621627228,-0.94979428788007525,-0.96543280372540741,-0.84279391630674849,-0.43701558410943936,-1.3563956998587177,-0.38968849668277539,-1.0823101326747335,-1.1209948823973981,-1.3461072025920515,0.18194041145319056,-0.71809732943475579,-0.024241073770797331,-0.87654018734141281,-1.8127934386080236],"y":[-0.27796498983607215,-0.54088584150044183,-0.74309405375376436,-0.7925171527784598,-0.91469506762631103,-0.28699662214515337,-0.51793044271485988,-0.906039753330108,-0.88095188580488193,-0.86652636197787691,-0.73305890674367391,-1.1052123336128783,-0.85536226092915124,-0.97791649378988077,-0.73757472289821469,-0.36276198207133642,-0.84143849445265073,-0.64863823252128805,2.8123585319212818,-0.65566283542835135,-0.034361796166126411,-0.69091128930129408,-0.25124641092170624,-0.62605915174858451,-0.53800073673504079,0.35249312107286052,-0.59319404529053821,-0.35937511995543081,0.13623570300541124,-0.72477991046034929,-0.70483505577779448,-0.61539680805036345,-0.80154878508754113,-1.0282302121117219,-0.58754927509736232,-1.1138927357766064,-0.81497079421353713,-0.3419390520253987,-0.73820191958634518,-0.22703661875986303,-0.78235656643074325,-0.47001261574167807,-0.57023864650495637,0.22203620994168455,2.6530505731360963,-0.30154758530978459,-0.59557739270543486,-0.69643062015684376,0.048051848654241308,-0.67334978203363571,-0.0047581124863595699,-0.098837615705957435,-0.93576887634750083,0.31360692640875992,-0.75576342685400355,-0.21888306181416456,-0.66331463502354526,-0.67447873607227093,-0.532481405879491,-1.1138927357766064,-0.85912544105793531,-0.49999261743432327,-0.83152878678018638,-0.64851279318366184,0.021333269739875569,-0.049289077343635912,-0.7525020040757241,-0.72051497298106082,0.54316091426457891,4.0391552539048394,-0.86527196860161559,0.051815028783025338,-0.62656090909908901,-0.46788014700203384,-0.86652636197787691,-1.0751319804501325,-0.25551134840099476,-0.44028349272428507,-0.86966234541853016,-0.79640577224486986,-0.78749957927341463,-0.61376609666122373,-0.81747958096605988,-1.1138927357766064,-1.1138927357766064,0.52559940699692087,-1.0938851614252387,-0.99857635269690437,-0.3385521899094931,-1.0938600735577133,-0.63609429875867496,-0.8187339743423212,-0.63170392194176039,-0.72352551708408808,-1.1138927357766064,-0.62806618115060264,-0.58867822913599765,-0.10975083807943094,-0.89362125890512123,-0.021943301741139419,-0.37480415848344478,-0.77909514365246391,-0.28147729128960369,-0.38960600032332832,-0.62618459108621072,-0.12793954203521979,-0.89211598685360749,-0.66808132985333835,-0.39587796720463481,-1.030563383791568,-0.29790984451862684,-0.4317536177657082,-0.90905029743313515,-1.0515870167777075,-0.9066669500182386,-0.93050042416720358,0.26970315823961416,-0.52370065224566187,-0.98180511325629083,0.82790821067589537,-0.52470416694667099,-0.50789529570476943,-0.56998776782970406,0.6096437632064281,-0.81547255156404164,-0.57099128253071318,-0.78298376311887385,-0.3127116863585101,-0.60310375296300256,-0.62467931903469709,-0.054181211511055018,-1.0229492159976616,-0.70433329842728998,-0.97553314637498445,-0.37016290299127808,-1.0952399062716007,-0.86339037853722367,-0.5520499425491675,-0.83228142280594331,0.28475587875474995,-1.0905610189781465,-0.28925453022242387,-0.83039983274155138,0.049431681368128907,-0.81296376481151911,0.59459104269129237,-0.3687830702773906,-0.34181361268777249,-0.77671179623756736,-0.95232686891415019,-0.98055071988002962,-0.95884971447070921,-0.80343037515193327,-0.80092158839941063,-0.25714205979013438,-0.82575857724938462,-0.69442359075482574,-0.86627548330262449,-1.0955660485494287,-1.0677185155964275,-1.0792965664593197,-1.0567049417528531,-0.91532226431444164,-0.93238201423159561,-0.6056125397155252,-0.94241716124168595,-1.1138927357766064,-1.0577837200564382,-0.97302435962246159,1.3635341823394731,-0.9455531446823392,-0.27018775090325192,-0.63722325279731018,-0.86376669655010208,-0.71336493073637142,-0.8924923048664859,-1.0944998141796063,-0.22239536326769607,-1.0510978033609657,-1.1016787074719503,-1.0166019855137796,-0.64500049173013019,-0.79891455899739261,-0.1094999594041786,-0.057442634289334368,-0.43689663060837947,-0.61138274924632718,-0.66469446773743268,-1.0196877932193824,-0.53586826799539655,-0.78938116933780655,-0.96700327141640763,-1.0097028219443422,-0.54878851977088805,0.17813244177253898,0.090701223447125723,-0.92548285066215819,-0.52169362284364384,-0.77395213080979253,-1.0989152788640464,-0.69442359075482574,-0.77671179623756736,-0.37856733861222874,-0.84030954041401562,-0.56296316492264076,-0.68827706321114523,-0.79326978880421661,-0.27959570122521177,1.7461241620991717,-0.95445933765379443,-0.58090099020317754,-0.12292196853017461,-0.66908484455434725,-0.11752807701225096,-0.37480415848344478,-0.47703721864874138,-0.25601310575149927,-0.85736929033116938,0.14928139411852881,-0.8726728895215573,-1.1138927357766064,-0.51391638391082373,-0.77758987160095028,-0.037623218944405762,-0.18689603071950128,-0.77370125213454022,-0.75601430552925586,-0.78699782192291012,-0.60498534302739448,-0.70044467896087992,-0.84934117272309706,-0.49372065055301673,-0.42397637883288808,-0.3454513534789303,-0.71110702265910108,-0.76479505916308499,-0.73180451336741259,-0.64537680974300859,-0.25350431899897657,-0.79339522814184271,-0.85711841165591707,-0.81785589897893829,-1.0015618089324063,-0.42585796889728,0.70497765980228733,-0.22364975664395745,0.097474947678936941,-1.0018252315414211,-1.0829092193829519,-0.31923453191506895,-0.66055496959577042,-0.94216628256643364,-0.93802678442477117,-0.14286682321272928,-0.69417271207957343,-0.88847824606244974,-0.67059011660586088,-0.9455531446823392,-0.8521008381508719,0.072387080153710787,-0.98155423458103863,-0.86389213588772806,-0.43137729975282979,-0.60348007097588108,-0.00789409592701284,-0.012911669432058031,-0.60523622170264679,-0.24898850284443591,-0.74183966037750304,-0.76027924300854433,-0.21574707837351129,-0.76617489187697252,-0.96261289459949295,-0.92059071649473923,-0.67786559818817649,-0.69153848598942469,-0.50438299425123789,0.15304457424731266,0.2471240774669107,-0.92836795542755923,0.16558850800992575,-0.74409756845477337,-0.81697782361555538,-0.41908424466546906,-1.1138927357766064,-0.4722705238189483,-0.3819542007281343,-0.47879336937550709,-0.83491564889609204,-0.44806073165710519,-0.74811162725880953,-0.73820191958634518,-0.38810072827181469,-0.54339462825296447,0.38008977535060923,0.82289063717085043,-0.4626116948217362,-0.57713781007439369,-0.8988897110854186,-0.55631488002845586,-1.0239150988973831,-0.88810192804957133,-0.2578946958158912,-0.10824556602791724,-0.66118216628390114,-0.14537560996525198,-0.37028834232890429,0.10663201932564439,0.37632659522182532,-0.088426150682988633,-0.60423270700163778,-0.42071495605460862,-0.27018775090325192,-0.6853919584457443,-0.082530501814560522,-0.57425270530899264,-0.50864793173052625,-0.62718810578721962,-0.69592886280633937,-1.0503326234014461,-0.43840190265989309,-0.82161907910772214,-0.79214083476558139,-0.58692207840923172,-0.74284317507851205,0.15304457424731266,-0.63960660021220661,-0.45132215443538448,-0.58704751774685782,-0.89412301625562574,-0.45370550185028108,-0.54753412639462673,-1.1138927357766064,0.046672015940354063,-0.2688079181893645,0.15179018087105151,-0.5989642548213403,-0.73920543428735441,-0.65127245861143668,-0.74083614567649403,-0.98694812609896221,-0.56722810240192922,-0.82074100374433923,-0.91971264113135642,-1.1138927357766064,-0.50877337106815235,-0.86339037853722367,-0.6126371426225885,-0.33679603918272732,-0.36138214935744895,-1.0508594686194761,-1.1138927357766064,0.17687804839627766,0.28099269862596593,-0.55418241128881163,-1.1138927357766064,-1.1138927357766064],"z":[0.26767570496021426,0.56678987466931474,0.01233434057439692,-1.2570770138008081,-0.15546141316485407,-0.49834838819723681,-0.0095520620872441495,-1.1549404680464814,-1.6729186643719958,0.20566423075222989,0.39534638715312292,0.026925275682158321,-0.46916651798171499,3.3974312855749438,0.059754879674619947,1.9310423072449656,-0.34514356956574715,-1.0783380587307356,1.0920635385487101,-0.80840575923715785,0.32968717916819867,-0.3342003682349266,2.1572018014152614,-0.34149583578880627,0.11082315255178382,0.47559653024580861,0.97533605768662157,0.43182372492252541,1.110302207433411,-0.46187105042783427,-1.5525434497329678,-0.63331453794402615,0.32239171161431801,-1.6838618657028162,-0.69897374592895034,0.43182372492252541,-0.26489342647306152,0.48653973157662911,1.4787233189043758,-0.038733932302765929,-0.76463295391387465,-1.1841223382620032,-0.83029216189879884,-0.2794843615808229,-0.39256410866597019,0.4026418547070037,-0.59318946639768377,-0.45092784909701372,-1.8480098856651277,-0.52753025841275958,0.16189142542894669,-1.4212250337631191,-0.72086014859059244,0.69081282308528258,0.24943703607551304,0.015982074351337781,-1.7239869372491596,-0.28313209535776274,-0.14816594561097338,0.33333491294513851,-0.60778040150544421,-0.12263180917239144,-1.5051229106327446,0.66892642042364148,-0.24665475758836025,-0.31960943312716522,-1.2351906111391671,2.6569413288560746,1.496961987789077,2.6861231990715972,0.067050347228500645,0.037868477012978859,0.57773307600013435,0.11811862010566453,-0.80840575923715785,-1.3482703582243143,0.66163095286976081,-0.95066737653782785,-1.0819857925076763,-1.5707821186176689,-0.11533634161851072,0.53760800445379198,-0.89595136988372415,0.42452825736864475,-0.32690490068104588,-0.5202347908588788,-1.5197138457405051,-1.2607247475777481,-2.3513971468828818,-0.39621184244291002,-1.0783380587307356,-0.34149583578880627,-0.52753025841275958,-0.42904144643537262,-0.57859853128992245,0.063402613451560799,0.61056267999259695,0.41358505603782419,0.44641466003028579,0.14000502276730559,-1.6510322617103546,-1.016326584522752,0.56678987466931474,0.55584667333849325,-1.6473845279334138,0.54855120578461358,0.35886904938372044,-1.1512927342695405,0.96074512257886036,-0.086154471402989957,0.25308476985245287,-1.0856335262846162,0.20931196452917072,0.12176635388260436,-0.95066737653782785,-1.0746903249537958,-1.7130437359183379,-0.34514356956574715,-0.96890604542252923,0.88414271326311555,-0.14087047805709266,-0.27218889402694219,-1.1841223382620032,-0.78651935657551675,0.31144851028349746,0.26038023740633359,0.081641282336262042,0.4026418547070037,-0.64425773927484664,0.72364242707774529,-0.52388252463581864,-1.1075199289462585,-0.15546141316485407,0.98263152524050235,0.74188109596244645,0.51936933556909071,-0.87041723344514221,1.08841580477177,1.0555862007793071,-1.3847476959937168,-0.41809824510455212,-0.81570122679103851,-1.7312824048030393,2.8575666865877878,0.73458562840856578,-0.35608677089656771,0.24578930229857321,-0.29772303046552312,0.2311983671908118,-0.63331453794402615,-0.80111029168327708,-1.3227362217857324,-0.64425773927484664,-0.42539371265843179,-0.11168860784157088,-1.2023610071467044,-1.4613501053094615,0.45006239380722668,-0.65520094060566725,-0.086154471402989957,-1.6291458590487125,-1.308145286677971,0.45371012758416651,-0.65520094060566725,-0.76828068769081548,0.077993548559321182,1.281745694949602,-2.1763059255897499,-0.50564385575111748,1.8909172356986237,-1.2388383449161069,-0.25030249136530008,-0.97984924675334961,-0.63331453794402615,-0.38162090733514958,-1.5999639888331909,-1.5671343848407291,-0.18464328338037583,0.46830106269192689,-0.14087047805709266,-0.99444018186111005,-0.58224626506686228,0.28591437384491453,0.3661645169376011,0.81848350527819125,-0.12992727672627211,0.71999469330080434,-0.6515532068287273,-0.93607644143006641,-1.0600993898460342,-0.64790547305178747,2.3614748929239147,-0.51293932330499814,-0.44363238154313406,-1.016326584522752,0.81483577150125042,-1.4139295662092386,0.43182372492252541,-1.1148153965001379,-1.0345652534074534,0.01233434057439692,-0.19193875093425655,-1.1549404680464814,-0.58954173262074294,-0.42539371265843179,-0.33055263445798577,0.22025516585999125,0.65068775153893932,1.3729390393731082,-1.424872767540059,-0.071563536295228561,0.75282429729326705,0.69810829063916335,-2.2200787309130323,-0.11898407539545158,-0.70991694725977095,-0.60413266772850438,-0.74639428502917338,-0.0059043283103032904,-0.042381666079706788,0.63244908265423905,0.45735786136110734,-0.62237133661320554,-0.02049526341806469,-0.86676949966820138,-1.0090311169688717,0.12906182143648506,-0.76828068769081548,0.22755063341387191,-0.2794843615808229,-0.87771270099902288,-1.187770072038943,-0.2794843615808229,-0.84488309700656028,0.56314214089237391,-0.76828068769081548,-0.35608677089656771,-1.9610896327502747,0.48289199779968828,0.75647203107020689,0.77835843373184899,-0.83393989567573978,-0.71721241481365161,0.80024483639349009,1.0008701941252036,0.27132343873715409,0.1327095552134249,2.6496458613021949,-0.66249640815954791,0.41358505603782419,0.74552882973938628,-1.0965767276154368,-1.2862588840163298,-0.00225659453336345,-0.87041723344514221,0.18013009431364793,-0.35608677089656771,-0.93607644143006641,-0.81205349301409768,-1.1768268707081224,-1.4832365079711027,2.0441220543301131,0.03057300945909816,0.29685757517573608,-1.2351906111391671,-1.6875095994797571,-0.71721241481365161,-0.58954173262074294,-0.046029399856646627,-1.5926685212793099,-0.046029399856646627,-0.70262147970589128,-0.52753025841275958,-0.69532601215201051,-0.38162090733514958,-1.0783380587307356,-1.3044975529010312,-0.76828068769081548,-0.91054230499148459,-0.48010971931253549,0.53031253689991231,1.5553257282201205,0.154595957875067,-0.45457558287395461,-0.40350730999679069,0.18013009431364793,-0.3889163748890293,-1.1148153965001379,0.0050388730205162303,-0.11898407539545158,-1.2680202151316289,-0.84853083078350011,-0.11898407539545158,-0.29042756291164346,-0.10074540651075034,0.9862792590174424,-1.4686455728633423,0.15094822409812614,-0.97620151297640878,-2.1580672567050483,-0.72450788236753227,-0.35973450467350754,-1.1841223382620032,-0.62237133661320554,-1.0418607209613331,-0.52388252463581864,0.4792442640227485,2.0660084569917552,0.89508591459393605,1.1394840776489328,0.51936933556909071,-0.36702997222738826,-1.1403495329387201,-0.55671212862828134,-0.26489342647306152,0.42088052359170486,-0.37432543978126892,1.1248931425411717,1.4057686433655707,-0.63696227172096598,-0.35608677089656771,-1.5488957159560279,-0.48740518686641621,-0.32325716690410505,-0.44728011532007389,0.59961947866177645,-0.56400759618216201,-0.77922388902163597,0.17283462675976824,-0.65884867438260808,-0.70262147970589128,1.1650182140875147,0.21295969830611056,0.82213123905513108,0.023277541905217469,0.22025516585999125,0.10352768499790312,-0.66979187571342857,-0.69897374592895034,-0.53847345974358007,0.26767570496021426,-0.5202347908588788,-0.84488309700656028,0.59961947866177645,-0.54941666107440057,0.79659710261655015,-0.99444018186111005,-0.43633691398925334,-0.89595136988372415,-0.79746255790633724,-0.075211270072168407,-0.25395022514224097,-1.3044975529010312,-1.545247982179087,-1.0017356494149907,-2.7417046610154876,-0.81934896056797835],"opacity":0.40000000000000002,"type":"scatter3d","mode":"markers","name":"Benign","marker":{"color":"rgba(70,130,180,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","symbol":"circle","line":{"color":"rgba(70,130,180,1)"}},"textfont":{"color":"rgba(70,130,180,1)","size":55},"error_y":{"color":"rgba(70,130,180,1)","width":55},"error_x":{"color":"rgba(70,130,180,1)","width":55},"line":{"color":"rgba(70,130,180,1)","width":55},"frame":null},{"x":[1.2688172627037919,1.6844725522771009,1.5651259839837746,-0.59216612289076331,1.7750113282237618,-0.3868077174481091,1.1371244976904666,-0.072802780869460793,-0.18391855134945428,-0.32919213275477899,0.44162208246384177,0.47866067262383921,1.6638955577437688,0.482776071530506,0.067120781957197159,0.19593276773585652,0.11403632949319438,0.66385362342382814,1.5651259839837746,0.43339128465050886,1.8614347052637563,0.74204620265049037,0.98897013705047565,0.22391748030118788,1.2400094703571272,0.42927588574384262,0.94781614798381142,1.3511252408371206,-0.57776222671743049,0.85727737203715004,1.4787026069437801,0.61858423545049779,0.74616160155715661,0.068355401629197135,0.14695952074652621,-0.14687996118945626,-0.23824181691745075,-0.82592078078941566,1.4951642025704459,-0.19132626938145411,-0.26951884860811576,1.3058558528637902,-0.24647261473078369,1.1659322900371316,0.21774438194118859,1.3799330331837856,0.14737106063719249,0.18317503112519051,-0.3818692387601092,0.2235059404105216,1.3017404539571231,0.91489295673048021,-0.063337363384127862,0.49923766715717133,1.1618168911304654,2.1289356341970738,3.2730165302503393,1.5280873938237765,1.1988554812904628,0.093870874850529126,1.2358940714504609,0.3387371097971813,0.34285250870384748,1.6638955577437688,0.10333629233586206,-0.16128385736278908,-0.19585320817878715,2.5034369347037191,0.274536886853185,0.56508404966383441,0.91489295673048021,1.2112016780104626,3.0549003881970185,-0.17321851419212136,1.2935096561437911,1.5815875796104404,0.40046809339717759,0.58566104419716647,1.1618168911304654,-0.42178860815477343,0.20087124642385584,0.54039165622383556,-0.53413899830676692,1.0465857217438057,1.4128562244371168,1.5939337763304391,2.4746291423570534,0.71323841030382529,0.99308553595714177,-0.25223417320011671,0.43339128465050886,0.71323841030382529,3.7092488143569793,2.0877816451304096,0.37989109886384548,0.28606000379185104,1.0959705086238023,0.098809353538529016,-0.44524638192277177,0.34696790761051421,-0.05510656557079549,1.0465857217438057,1.462241011317114,0.10374783222652832,0.95193154689047765,2.7544762680103703,-0.01683335573879749,0.28029844532251802,0.72970000593049122,1.7585497325970958,3.9726343443836303,0.92723915345047936,0.03707836993853271,-0.041525749178796367,1.5527797872637747,1.4828180058504461,0.43750668355717504,-0.27610348685878189,0.88196976547714889,1.7462035358770971,2.5322447270503834,1.6680109566504351,0.88196976547714889,1.5280873938237765,1.9313964866770863,1.5939337763304391,0.86550816985048296,1.4210870222504497,-0.022183374317463658,1.7132803446237654,0.46219907699717389,0.7502770004638234,0.482776071530506,1.6844725522771009,0.7832001917171546,0.92312375454381324,0.33050631198384833,0.8078925851571529,1.7997037216637599,2.2770899948370658,0.95604694579714444,1.1906246834771306,1.4087408255304508,1.4498948145971149,0.69266141577049323,-0.69834341468275685,1.5445489894504425,1.7585497325970958,1.1000859075304692,1.6103953719571049,1.8079345194770935,0.61446883654383155,0.63916122998382985,0.56919944857050064,0.81612338297048581,1.2729326616104588,2.5980911095570458,1.5610105850771083,0.62269963435716391,3.3841323007303319,0.2481983338505199,1.721511142437099,1.7173957435304317,2.0137044648104148,2.2729745959303984,0.70089221358382614,2.0301660604370806,1.7626651315037631,-0.76830519609608616,0.082347757911863106,1.5198565960104442,0.42927588574384262,2.1577434265437394,1.3346636452104552,1.0630473173704711,0.19510968795452285,0.44985288027717474,0.41692968902384292,1.721511142437099,1.3058558528637902,-0.034941110928129647,0.84081577641048477,1.0507011206504719,1.042470322837139,1.8984732954237544,1.4704718091304469,0.79143098953048752,3.9067879618769679,1.1124321042504683,0.73381540483715746,1.4869334047571123,0.62269963435716391,1.0877397108104701,1.2070862791037955,1.8861270987037555,0.01485521584253377,2.4746291423570534,0.48689147043717218,-0.13700300381345706,0.21774438194118859,1.1865092845704637,1.5857029785171066,3.0260925958503537,1.7585497325970958,1.8861270987037555,0.074116960098530138,0.47042987481050685,2.100127841850409,2.0589738527837449,1.6145107708637711,0.67208442123716117,1.9807812735570829],"y":[2.650541786383573,-0.02382489180553134,1.3622797889632119,1.9142128745181868,1.3698061492207798,0.86554001196373465,0.29980859926988551,0.06097210042973298,1.2180245506931615,1.7373434084653423,-0.70006836094800162,0.13473043095389772,1.4764295862029906,0.13272340155187956,1.555456368907453,0.94205800791567418,-0.18626883403137057,1.0461726581453628,0.74135506771386539,1.4914823067181264,0.26217679798204646,0.79905716302188545,1.6821500999098449,0.67361782539575465,0.75515339485273969,0.99725131647117204,0.12482072328143344,1.7950455037733626,0.41395839650966454,1.9179760546469704,0.96463708868837761,0.58455589568120203,0.57702953542363433,0.54065212751205627,-0.81308920414914521,0.21952742318916205,-0.72377639575934027,0.19569394904019727,1.5291141080059656,0.12130842182790172,-0.077889246322393746,1.3622797889632119,0.42399354351975488,1.1088923269584281,-0.4549598952265424,0.54566970101710166,0.50803789972926239,1.5642371225412821,0.30106299264614683,0.47542367194646856,0.24085211058560435,1.0085408568575234,-0.13684573500667507,0.11152415349306352,0.99850570984743303,3.5950999987083372,3.0745267475598945,1.3158672340415438,0.56072242153223739,0.39639688924200606,0.7275567405749912,0.29353663238857897,1.0185760038676142,0.72379356044620702,0.063731765857507658,-0.031978448751229981,1.4839559464605587,4.2348406206016032,1.0060320701050007,1.5617283357887597,-0.19906364646923591,0.71375841343611657,4.2398581941066489,-0.45094583642250619,0.049055363355250479,2.0785384068084176,0.72504795382246845,0.19443955566393592,0.33242282705267956,-0.52294801621990517,0.81661867028954382,0.071132686777449453,0.96714587544090036,1.2130069771881165,0.38259856210313181,2.0321258518867498,0.54692409439336276,-0.057442634289334368,1.5943425635715536,-0.37906909596273342,1.4350346047863676,1.1352345878599153,2.4874706474696038,2.0057835909852622,-0.28687118280752744,-0.43965629603615441,-0.089178786708745475,1.371060542597041,0.2471240774669107,1.0148128237388301,0.62344209034530274,0.26970315823961416,0.28350148537848857,0.36629144821173493,0.18565880203010668,3.3053351287919752,0.84045214443850846,-0.16682573669932035,-0.24208933927499859,0.94331240129193539,2.9014204616358343,0.99599692309491039,0.28475587875474995,0.12808214605971277,0.48169563882777505,0.32238768004258916,0.32489646679511164,1.0123040369863077,1.2819986128824885,0.83543457093346341,1.3321743479329409,0.020329755038866571,0.66358267838566432,1.4563592921828099,2.288022100644056,1.9179760546469704,0.47416927857020702,0.6159157300877347,0.11403294024558602,1.1239450474735635,1.956862249311071,2.8700606272293019,1.0825500660569407,0.79153080276431764,-0.75124761069946278,0.10249252118398212,-0.58591856370822282,0.022713102453762998,0.60086300957259897,1.6395007251169609,-0.39901395064528811,-0.107869248015039,1.2957969400213627,0.92575089402427724,1.329665561180418,-0.77708811425044577,1.6420095118694833,1.7498873422279555,0.30357177939866953,0.3349316138052022,2.103626274333644,0.74010067433760385,1.1427609481174834,0.39639688924200606,0.77773247562544312,0.21576424306037803,1.7812471766344882,1.2230421241982068,2.5414095626488402,3.1109041554714727,0.43528308390610665,0.11528733362184736,0.94456679466819682,0.35123872769659914,1.956862249311071,1.1578136686326193,1.3095952671602371,0.80156594977440809,1.0047776767287395,-0.061456693093370568,1.2142613705643777,1.2581651387335231,2.4109526515176638,2.8863677411206989,0.39263370911322221,-0.52608399966055841,0.7952939828931016,2.3143643615455431,1.5617283357887597,0.88561030598391544,0.29855420589362436,0.39639688924200606,0.25339604434821728,1.0160672171150915,0.85801365170616695,0.96212830193585519,0.14928139411852881,3.4458271869332413,1.5654915159175438,1.690930853543674,1.7160187210689002,-0.65616459277885597,0.35374751444912167,0.75640778822900112,1.6307199714831313,0.58831907580998588,0.9884705628373428,1.4325258180338452,0.69870569292098084,-0.17485385430739273,0.8542504715773831,0.65605631812809662,1.783755963387011,0.7965483762693627,1.5015174537282168,0.7212847736936846,2.0848103736897245,2.8675518404767795,1.9455727089247197,0.69243372603967468,0.046546576602727978,3.294045588405623],"z":[2.2155655418463049,0.00139113924357638,0.93885871991721925,2.8648621541416679,-0.0095520620872441495,1.0045179279021434,-0.06426806874134787,1.40212090958863,1.9638719112374272,0.79659710261655015,-1.0345652534074534,0.11082315255178382,2.1353153987536193,0.12906182143648506,0.93885871991721925,1.7924284237212369,-0.82299669434491918,1.2853934287265427,-0.83758762945267962,2.5876343870942096,-0.15546141316485407,0.66892642042364148,4.4808082173261967,1.6063940010972844,-0.41809824510455212,0.41723278981476403,-0.26489342647306152,1.3547003704884069,1.7851329561673559,1.591803065989523,0.15094822409812614,0.67986962175446208,0.30780077650655657,0.26767570496021426,-0.89959910366066398,-0.3342003682349266,-0.10074540651075034,0.30415304272961674,1.8179625601598184,0.59232401110789568,-0.23935929003447956,0.34792584805289994,1.1540750127566932,1.0227565967868448,-0.71356468103671178,0.38440318582230237,0.78565390128572865,0.50113066668438955,0.34063038049901923,0.51572160179215087,-0.83758762945267962,0.42088052359170486,-0.54576892729746074,-0.049677133633587479,1.2416206234032596,3.992011891216205,0.063402613451560799,-0.64790547305178747,1.1686659478644548,0.96074512257886036,0.51572160179215087,-0.34514356956574715,0.15824369165200683,1.0336997981176652,0.24578930229857321,-0.73909881747529371,0.41358505603782419,2.7153050692871181,1.2598592922879608,1.0373475318946062,1.1577227465336342,0.56314214089237391,3.076430713204203,-0.18464328338037583,0.490187465353569,1.4240073122502721,0.4354714586994653,1.2708024936187825,-0.43633691398925334,-0.82664442812185901,0.53031253689991231,0.18013009431364793,3.1603285900738274,0.58138080977707518,-0.2575979589191808,0.78565390128572865,-0.038733932302765929,0.29685757517573608,-0.99808791563805077,-0.77922388902163597,0.56314214089237391,-0.06426806874134787,-0.042381666079706788,2.1280199311997388,-0.70626921348283112,-0.30866623179634467,-0.69532601215201051,2.0878948596533964,0.4792442640227485,-0.27218889402694219,0.081641282336262042,-0.15181367938791421,-0.16275688071873476,0.50477840046133038,-1.1148153965001379,1.4167118446963911,1.6027462673203436,-0.79381482412939741,0.78200616750878882,-0.17005234827261545,-0.59683720017462361,-1.8370666843343069,1.5443825268892999,1.0738248696640087,1.0300520643407254,-1.399338631101477,0.45006239380722668,1.1358363438719921,1.1650182140875147,-1.3263839555626722,0.35522131560677961,-1.2570770138008081,-0.0095520620872441495,0.60691494621565711,1.4349505135810925,-0.28677982913470257,0.0050388730205162303,-0.12992727672627211,0.35157358182983978,0.29685757517573608,2.1389631325305603,2.4927933088937633,1.019108863009905,0.0086866067974570808,-0.90324683743760381,1.0811203372178884,-0.9652583116455884,0.20201649697529001,-0.15546141316485407,-0.33055263445798577,-0.99808791563805077,-0.95431511031476757,0.32968717916819867,0.29685757517573608,0.23484610096775163,-0.70262147970589128,-0.071563536295228561,1.5954507997664629,-0.016847529641124851,0.42452825736864475,2.7627256083873419,0.49748293290744966,0.20931196452917072,-0.10804087406463105,-0.30866623179634467,0.51572160179215087,-0.053324867410527318,0.9862792590174424,2.0550652556609337,0.52666480312297148,-0.60048493395156344,-0.70626921348283112,0.2311983671908118,-0.34514356956574715,0.045163944566859557,1.3255185002728851,0.58867627733095584,-0.87771270099902288,1.40212090958863,-0.67343960949036841,0.64704001776199949,0.42817599114558458,1.2780979611726622,1.0993590061025895,0.65798321909281998,0.14730049032118631,0.99722246034826278,0.83672217416289252,-0.31960943312716522,0.4792442640227485,-0.5202347908588788,-1.2570770138008081,-0.3342003682349266,-0.35973450467350754,-0.93972417520700635,-0.54212119352051991,-0.067915802518288729,0.9096768497016976,-0.42174597888149201,1.2379728896263198,0.041516210789918712,0.1254140876595442,1.110302207433411,0.07434581478238135,0.1327095552134249,1.6902918779669098,-1.1184631302770789,-0.016847529641124851,1.110302207433411,-0.91419003876842542,0.1764823605367091,-0.03508619852582609,0.65433548531588015,1.2926888962804224,1.1504272789797534,0.41723278981476403,1.1540750127566932,1.230677422072439,-0.3123139655732845,-0.21747288737283849,-0.80840575923715785,2.1353153987536193],"opacity":0.40000000000000002,"type":"scatter3d","mode":"markers","name":"Malignant","marker":{"color":"rgba(255,140,0,1)","size":[55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55],"sizemode":"area","symbol":"circle","line":{"color":"rgba(255,140,0,1)"}},"textfont":{"color":"rgba(255,140,0,1)","size":55},"error_y":{"color":"rgba(255,140,0,1)","width":55},"error_x":{"color":"rgba(255,140,0,1)","width":55},"line":{"color":"rgba(255,140,0,1)","width":55},"frame":null},{"x":[0],"y":[3.5],"z":[1],"opacity":0.40000000000000002,"type":"scatter3d","mode":"markers","name":"Unknown","marker":{"color":"rgba(255,0,0,1)","size":[55],"sizemode":"area","symbol":"diamond","line":{"color":"rgba(255,0,0,1)"}},"textfont":{"color":"rgba(255,0,0,1)","size":55},"error_y":{"color":"rgba(255,0,0,1)","width":55},"error_x":{"color":"rgba(255,0,0,1)","width":55},"line":{"color":"rgba(255,0,0,1)","width":55},"frame":null},{"x":[0,0.41692968902384292],"y":[3.5,2.3143643615455431],"z":[1,0.83672217416289252],"type":"scatter3d","mode":"lines","name":"lines","showlegend":false,"marker":{"color":"rgba(255,140,0,1)","line":{"color":"rgba(255,140,0,1)"}},"textfont":{"color":"rgba(255,140,0,1)"},"error_y":{"color":"rgba(255,140,0,1)"},"error_x":{"color":"rgba(255,140,0,1)"},"line":{"color":"rgba(255,140,0,1)"},"frame":null},{"x":[0,1.3346636452104552],"y":[3.5,2.8863677411206989],"z":[1,1.0993590061025895],"type":"scatter3d","mode":"lines","name":"lines","showlegend":false,"marker":{"color":"rgba(255,140,0,1)","line":{"color":"rgba(255,140,0,1)"}},"textfont":{"color":"rgba(255,140,0,1)"},"error_y":{"color":"rgba(255,140,0,1)"},"error_x":{"color":"rgba(255,140,0,1)"},"line":{"color":"rgba(255,140,0,1)"},"frame":null},{"x":[0,0.47042987481050685],"y":[3.5,2.0848103736897245],"z":[1,1.1540750127566932],"type":"scatter3d","mode":"lines","name":"lines","showlegend":false,"marker":{"color":"rgba(255,140,0,1)","line":{"color":"rgba(255,140,0,1)"}},"textfont":{"color":"rgba(255,140,0,1)"},"error_y":{"color":"rgba(255,140,0,1)"},"error_x":{"color":"rgba(255,140,0,1)"},"line":{"color":"rgba(255,140,0,1)"},"frame":null},{"x":[0,-1.3654495774533837],"y":[3.5,2.8123585319212818],"z":[1,1.0920635385487101],"type":"scatter3d","mode":"lines","name":"lines","showlegend":false,"marker":{"color":"rgba(70,130,180,1)","line":{"color":"rgba(70,130,180,1)"}},"textfont":{"color":"rgba(70,130,180,1)"},"error_y":{"color":"rgba(70,130,180,1)"},"error_x":{"color":"rgba(70,130,180,1)"},"line":{"color":"rgba(70,130,180,1)"},"frame":null},{"x":[0,0.62269963435716391],"y":[3.5,2.5414095626488402],"z":[1,2.0550652556609337],"type":"scatter3d","mode":"lines","name":"lines","showlegend":false,"marker":{"color":"rgba(255,140,0,1)","line":{"color":"rgba(255,140,0,1)"}},"textfont":{"color":"rgba(255,140,0,1)"},"error_y":{"color":"rgba(255,140,0,1)"},"error_x":{"color":"rgba(255,140,0,1)"},"line":{"color":"rgba(255,140,0,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 5.8: 3D scatter plot of the standardized symmetry, concavity, and perimeter variables. Note that in general we recommend against using 3D visualizations; here we show the data in 3D only to illustrate what higher dimensions and nearest neighbors look like, for learning purposes.
</p>
</div>
</div>
<div id="summary-of-k-nearest-neighbors-algorithm" class="section level3 hasAnchor" number="5.5.3">
<h3><span class="header-section-number">5.5.3</span> Summary of K-nearest neighbors algorithm<a href="classification1.html#summary-of-k-nearest-neighbors-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In order to classify a new observation using a K-nearest neighbors classifier, we have to do the following:</p>
<ol style="list-style-type: decimal">
<li>Compute the distance between the new observation and each observation in the training set.</li>
<li>Sort the data table in ascending order according to the distances.</li>
<li>Choose the top <span class="math inline">\(K\)</span> rows of the sorted table.</li>
<li>Classify the new observation based on a majority vote of the neighbor classes.</li>
</ol>
</div>
</div>
<div id="k-nearest-neighbors-with-tidymodels" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> K-nearest neighbors with <code>tidymodels</code><a href="classification1.html#k-nearest-neighbors-with-tidymodels" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Coding the K-nearest neighbors algorithm in R ourselves can get complicated,
especially if we want to handle multiple classes, more than two variables,
or predict the class for multiple new observations. Thankfully, in R,
the K-nearest neighbors algorithm is
implemented in <a href="https://parsnip.tidymodels.org/">the <code>parsnip</code> R package</a> <span class="citation">(<a href="#ref-parsnip">Kuhn and Vaughan 2021</a>)</span>
included in <code>tidymodels</code>, along with
many <a href="https://www.tidymodels.org/find/parsnip/">other models</a>
that you will encounter in this and future chapters of the book. The <code>tidymodels</code> collection
provides tools to help make and use models, such as classifiers. Using the packages
in this collection will help keep our code simple, readable and accurate; the
less we have to code ourselves, the fewer mistakes we will likely make. We
start by loading <code>tidymodels</code>.</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="classification1.html#cb277-1" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span></code></pre></div>
<p>Let’s walk through how to use <code>tidymodels</code> to perform K-nearest neighbors classification.
We will use the <code>cancer</code> data set from above, with
perimeter and concavity as predictors and <span class="math inline">\(K = 5\)</span> neighbors to build our classifier. Then
we will use the classifier to predict the diagnosis label for a new observation with
perimeter 0, concavity 3.5, and an unknown diagnosis label. Let’s pick out our two desired
predictor variables and class label and store them as a new data set named <code>cancer_train</code>:</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="classification1.html#cb278-1" tabindex="-1"></a>cancer_train <span class="ot">&lt;-</span> cancer <span class="sc">|&gt;</span></span>
<span id="cb278-2"><a href="classification1.html#cb278-2" tabindex="-1"></a>  <span class="fu">select</span>(Class, Perimeter, Concavity)</span>
<span id="cb278-3"><a href="classification1.html#cb278-3" tabindex="-1"></a>cancer_train</span></code></pre></div>
<pre><code>## # A tibble: 569 × 3
##    Class     Perimeter Concavity
##    &lt;fct&gt;         &lt;dbl&gt;     &lt;dbl&gt;
##  1 Malignant    1.27      2.65  
##  2 Malignant    1.68     -0.0238
##  3 Malignant    1.57      1.36  
##  4 Malignant   -0.592     1.91  
##  5 Malignant    1.78      1.37  
##  6 Malignant   -0.387     0.866 
##  7 Malignant    1.14      0.300 
##  8 Malignant   -0.0728    0.0610
##  9 Malignant   -0.184     1.22  
## 10 Malignant   -0.329     1.74  
## # ℹ 559 more rows</code></pre>
<p>Next, we create a <em>model specification</em> for K-nearest neighbors classification
by calling the <code>nearest_neighbor</code> function, specifying that we want to use <span class="math inline">\(K = 5\)</span> neighbors
(we will discuss how to choose <span class="math inline">\(K\)</span> in the next chapter) and that each neighboring point should have the same weight when voting
(<code>weight_func = "rectangular"</code>). The <code>weight_func</code> argument controls
how neighbors vote when classifying a new observation; by setting it to <code>"rectangular"</code>,
each of the <span class="math inline">\(K\)</span> nearest neighbors gets exactly 1 vote as described above. Other choices,
which weigh each neighbor’s vote differently, can be found on
<a href="https://parsnip.tidymodels.org/reference/nearest_neighbor.html">the <code>parsnip</code> website</a>.
In the <code>set_engine</code> argument, we specify which package or system will be used for training
the model. Here <code>kknn</code> is the R package we will use for performing K-nearest neighbors classification.
Finally, we specify that this is a classification problem with the <code>set_mode</code> function.</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="classification1.html#cb280-1" tabindex="-1"></a>knn_spec <span class="ot">&lt;-</span> <span class="fu">nearest_neighbor</span>(<span class="at">weight_func =</span> <span class="st">&quot;rectangular&quot;</span>, <span class="at">neighbors =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb280-2"><a href="classification1.html#cb280-2" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;kknn&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb280-3"><a href="classification1.html#cb280-3" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&quot;classification&quot;</span>)</span>
<span id="cb280-4"><a href="classification1.html#cb280-4" tabindex="-1"></a>knn_spec</span></code></pre></div>
<pre><code>## K-Nearest Neighbor Model Specification (classification)
## 
## Main Arguments:
##   neighbors = 5
##   weight_func = rectangular
## 
## Computational engine: kknn</code></pre>
<p>In order to fit the model on the breast cancer data, we need to pass the model specification
and the data set to the <code>fit</code> function. We also need to specify what variables to use as predictors
and what variable to use as the response. Below, the <code>Class ~ Perimeter + Concavity</code> argument specifies
that <code>Class</code> is the response variable (the one we want to predict),
and both <code>Perimeter</code> and <code>Concavity</code> are to be used as the predictors.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="classification1.html#cb282-1" tabindex="-1"></a>knn_fit <span class="ot">&lt;-</span> knn_spec <span class="sc">|&gt;</span></span>
<span id="cb282-2"><a href="classification1.html#cb282-2" tabindex="-1"></a>  <span class="fu">fit</span>(Class <span class="sc">~</span> Perimeter <span class="sc">+</span> Concavity, <span class="at">data =</span> cancer_train)</span></code></pre></div>
<p>We can also use a convenient shorthand syntax using a period, <code>Class ~ .</code>, to indicate
that we want to use every variable <em>except</em> <code>Class</code> as a predictor in the model.
In this particular setup, since <code>Concavity</code> and <code>Perimeter</code> are the only two predictors in the <code>cancer_train</code>
data frame, <code>Class ~ Perimeter + Concavity</code> and <code>Class ~ .</code> are equivalent.
In general, you can choose individual predictors using the <code>+</code> symbol, or you can specify to
use <em>all</em> predictors using the <code>.</code> symbol.</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="classification1.html#cb283-1" tabindex="-1"></a>knn_fit <span class="ot">&lt;-</span> knn_spec <span class="sc">|&gt;</span></span>
<span id="cb283-2"><a href="classification1.html#cb283-2" tabindex="-1"></a>  <span class="fu">fit</span>(Class <span class="sc">~</span> ., <span class="at">data =</span> cancer_train)</span>
<span id="cb283-3"><a href="classification1.html#cb283-3" tabindex="-1"></a>knn_fit</span></code></pre></div>
<pre><code>## parsnip model object
## 
## 
## Call:
## kknn::train.kknn(formula = Class ~ ., data = data, ks = min_rows(5,     data, 5)
## , kernel = ~&quot;rectangular&quot;)
## 
## Type of response variable: nominal
## Minimal misclassification: 0.07557118
## Best kernel: rectangular
## Best k: 5</code></pre>
<p>Here you can see the final trained model summary. It confirms that the computational engine used
to train the model was <code>kknn::train.kknn</code>. It also shows the fraction of errors made by
the K-nearest neighbors model, but we will ignore this for now and discuss it in more detail
in the next chapter.
Finally, it shows (somewhat confusingly) that the “best” weight function
was “rectangular” and “best” setting of <span class="math inline">\(K\)</span> was 5; but since we specified these earlier,
R is just repeating those settings to us here. In the next chapter, we will actually
let R find the value of <span class="math inline">\(K\)</span> for us.</p>
<p>Finally, we make the prediction on the new observation by calling the <code>predict</code> function,
passing both the fit object we just created and the new observation itself. As above,
when we ran the K-nearest neighbors
classification algorithm manually, the <code>knn_fit</code> object classifies the new observation as
malignant. Note that the <code>predict</code> function outputs a data frame with a single
variable named <code>.pred_class</code>.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="classification1.html#cb285-1" tabindex="-1"></a>new_obs <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Perimeter =</span> <span class="dv">0</span>, <span class="at">Concavity =</span> <span class="fl">3.5</span>)</span>
<span id="cb285-2"><a href="classification1.html#cb285-2" tabindex="-1"></a><span class="fu">predict</span>(knn_fit, new_obs)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   .pred_class
##   &lt;fct&gt;      
## 1 Malignant</code></pre>
<p>Is this predicted malignant label the actual class for this observation?
Well, we don’t know because we do not have this
observation’s diagnosis— that is what we were trying to predict! The
classifier’s prediction is not necessarily correct, but in the next chapter, we will
learn ways to quantify how accurate we think our predictions are.</p>
</div>
<div id="data-preprocessing-with-tidymodels" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> Data preprocessing with <code>tidymodels</code><a href="classification1.html#data-preprocessing-with-tidymodels" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="centering-and-scaling" class="section level3 hasAnchor" number="5.7.1">
<h3><span class="header-section-number">5.7.1</span> Centering and scaling<a href="classification1.html#centering-and-scaling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When using K-nearest neighbors classification, the <em>scale</em> of each variable
(i.e., its size and range of values) matters. Since the classifier predicts
classes by identifying observations nearest to it, any variables with
a large scale will have a much larger effect than variables with a small
scale. But just because a variable has a large scale <em>doesn’t mean</em> that it is
more important for making accurate predictions. For example, suppose you have a
data set with two features, salary (in dollars) and years of education, and
you want to predict the corresponding type of job. When we compute the
neighbor distances, a difference of $1000 is huge compared to a difference of
10 years of education. But for our conceptual understanding and answering of
the problem, it’s the opposite; 10 years of education is huge compared to a
difference of $1000 in yearly salary!</p>
<p>In many other predictive models, the <em>center</em> of each variable (e.g., its mean)
matters as well. For example, if we had a data set with a temperature variable
measured in degrees Kelvin, and the same data set with temperature measured in
degrees Celsius, the two variables would differ by a constant shift of 273
(even though they contain exactly the same information). Likewise, in our
hypothetical job classification example, we would likely see that the center of
the salary variable is in the tens of thousands, while the center of the years
of education variable is in the single digits. Although this doesn’t affect the
K-nearest neighbors classification algorithm, this large shift can change the
outcome of using many other predictive models. </p>
<p>To scale and center our data, we need to find
our variables’ <em>mean</em> (the average, which quantifies the “central” value of a
set of numbers) and <em>standard deviation</em> (a number quantifying how spread out values are).
For each observed value of the variable, we subtract the mean (i.e., center the variable)
and divide by the standard deviation (i.e., scale the variable). When we do this, the data
is said to be <em>standardized</em>, and all variables in a data set will have a mean of 0
and a standard deviation of 1. To illustrate the effect that standardization can have on the K-nearest
neighbors algorithm, we will read in the original, unstandardized Wisconsin breast
cancer data set; we have been using a standardized version of the data set up
until now. As before, we will convert the <code>Class</code> variable to the factor type
and rename the values to “Malignant” and “Benign.”
To keep things simple, we will just use the <code>Area</code>, <code>Smoothness</code>, and <code>Class</code>
variables:</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="classification1.html#cb287-1" tabindex="-1"></a>unscaled_cancer <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/wdbc_unscaled.csv&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb287-2"><a href="classification1.html#cb287-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">as_factor</span>(Class)) <span class="sc">|&gt;</span></span>
<span id="cb287-3"><a href="classification1.html#cb287-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">fct_recode</span>(Class, <span class="st">&quot;Benign&quot;</span> <span class="ot">=</span> <span class="st">&quot;B&quot;</span>, <span class="st">&quot;Malignant&quot;</span> <span class="ot">=</span> <span class="st">&quot;M&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb287-4"><a href="classification1.html#cb287-4" tabindex="-1"></a>  <span class="fu">select</span>(Class, Area, Smoothness)</span>
<span id="cb287-5"><a href="classification1.html#cb287-5" tabindex="-1"></a>unscaled_cancer</span></code></pre></div>
<pre><code>## # A tibble: 569 × 3
##    Class      Area Smoothness
##    &lt;fct&gt;     &lt;dbl&gt;      &lt;dbl&gt;
##  1 Malignant 1001      0.118 
##  2 Malignant 1326      0.0847
##  3 Malignant 1203      0.110 
##  4 Malignant  386.     0.142 
##  5 Malignant 1297      0.100 
##  6 Malignant  477.     0.128 
##  7 Malignant 1040      0.0946
##  8 Malignant  578.     0.119 
##  9 Malignant  520.     0.127 
## 10 Malignant  476.     0.119 
## # ℹ 559 more rows</code></pre>
<p>Looking at the unscaled and uncentered data above, you can see that the differences
between the values for area measurements are much larger than those for
smoothness. Will this affect
predictions? In order to find out, we will create a scatter plot of these two
predictors (colored by diagnosis) for both the unstandardized data we just
loaded, and the standardized version of that same data. But first, we need to
standardize the <code>unscaled_cancer</code> data set with <code>tidymodels</code>.</p>
<p>In the <code>tidymodels</code> framework, all data preprocessing happens
using a <code>recipe</code> from <a href="https://recipes.tidymodels.org/">the <code>recipes</code> R package</a> <span class="citation">(<a href="#ref-recipes">Kuhn and Wickham 2021</a>)</span>.
Here we will initialize a recipe for
the <code>unscaled_cancer</code> data above, specifying
that the <code>Class</code> variable is the response, and all other variables are predictors:</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="classification1.html#cb289-1" tabindex="-1"></a>uc_recipe <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Class <span class="sc">~</span> ., <span class="at">data =</span> unscaled_cancer)</span>
<span id="cb289-2"><a href="classification1.html#cb289-2" tabindex="-1"></a>uc_recipe</span></code></pre></div>
<pre><code>## 
## ── Recipe ──────────
## 
## ── Inputs 
## Number of variables by role
## outcome:   1
## predictor: 2</code></pre>
<p>So far, there is not much in the recipe; just a statement about the number of response variables
and predictors. Let’s add
scaling (<code>step_scale</code>) and
centering (<code>step_center</code>) steps for
all of the predictors so that they each have a mean of 0 and standard deviation of 1.
Note that <code>tidyverse</code> actually provides <code>step_normalize</code>, which does both centering and scaling in
a single recipe step; in this book we will keep <code>step_scale</code> and <code>step_center</code> separate
to emphasize conceptually that there are two steps happening.
The <code>prep</code> function finalizes the recipe by using the data (here, <code>unscaled_cancer</code>)
to compute anything necessary to run the recipe (in this case, the column means and standard
deviations):</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="classification1.html#cb291-1" tabindex="-1"></a>uc_recipe <span class="ot">&lt;-</span> uc_recipe <span class="sc">|&gt;</span></span>
<span id="cb291-2"><a href="classification1.html#cb291-2" tabindex="-1"></a>  <span class="fu">step_scale</span>(<span class="fu">all_predictors</span>()) <span class="sc">|&gt;</span></span>
<span id="cb291-3"><a href="classification1.html#cb291-3" tabindex="-1"></a>  <span class="fu">step_center</span>(<span class="fu">all_predictors</span>()) <span class="sc">|&gt;</span></span>
<span id="cb291-4"><a href="classification1.html#cb291-4" tabindex="-1"></a>  <span class="fu">prep</span>()</span>
<span id="cb291-5"><a href="classification1.html#cb291-5" tabindex="-1"></a>uc_recipe</span></code></pre></div>
<pre><code>## 
## ── Recipe ──────────
## 
## ── Inputs 
## Number of variables by role
## outcome:   1
## predictor: 2
## 
## ── Training information 
## Training data contained 569 data points and no incomplete rows.
## 
## ── Operations 
## • Scaling for: Area, Smoothness | Trained
## • Centering for: Area, Smoothness | Trained</code></pre>
<p>You can now see that the recipe includes a scaling and centering step for all predictor variables.
Note that when you add a step to a recipe, you must specify what columns to apply the step to.
Here we used the <code>all_predictors()</code> function to specify that each step should be applied to
all predictor variables. However, there are a number of different arguments one could use here,
as well as naming particular columns with the same syntax as the <code>select</code> function.
For example:</p>
<ul>
<li><code>all_nominal()</code> and <code>all_numeric()</code>: specify all categorical or all numeric variables</li>
<li><code>all_predictors()</code> and <code>all_outcomes()</code>: specify all predictor or all response variables</li>
<li><code>Area, Smoothness</code>: specify both the <code>Area</code> and <code>Smoothness</code> variable</li>
<li><code>-Class</code>: specify everything except the <code>Class</code> variable</li>
</ul>
<p>You can find a full set of all the steps and variable selection functions
on the <a href="https://recipes.tidymodels.org/reference/index.html"><code>recipes</code> reference page</a>.</p>
<p>At this point, we have calculated the required statistics based on the data input into the
recipe, but the data are not yet scaled and centered. To actually scale and center
the data, we need to apply the <code>bake</code> function to the unscaled data.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="classification1.html#cb293-1" tabindex="-1"></a>scaled_cancer <span class="ot">&lt;-</span> <span class="fu">bake</span>(uc_recipe, unscaled_cancer)</span>
<span id="cb293-2"><a href="classification1.html#cb293-2" tabindex="-1"></a>scaled_cancer</span></code></pre></div>
<pre><code>## # A tibble: 569 × 3
##      Area Smoothness Class    
##     &lt;dbl&gt;      &lt;dbl&gt; &lt;fct&gt;    
##  1  0.984      1.57  Malignant
##  2  1.91      -0.826 Malignant
##  3  1.56       0.941 Malignant
##  4 -0.764      3.28  Malignant
##  5  1.82       0.280 Malignant
##  6 -0.505      2.24  Malignant
##  7  1.09      -0.123 Malignant
##  8 -0.219      1.60  Malignant
##  9 -0.384      2.20  Malignant
## 10 -0.509      1.58  Malignant
## # ℹ 559 more rows</code></pre>
<p>It may seem redundant that we had to both <code>bake</code> <em>and</em> <code>prep</code> to scale and center the data.
However, we do this in two steps so we can specify a different data set in the <code>bake</code> step if we want.
For example, we may want to specify new data that were not part of the training set.</p>
<p>You may wonder why we are doing so much work just to center and
scale our variables. Can’t we just manually scale and center the <code>Area</code> and
<code>Smoothness</code> variables ourselves before building our K-nearest neighbors model? Well,
technically <em>yes</em>; but doing so is error-prone. In particular, we might
accidentally forget to apply the same centering / scaling when making
predictions, or accidentally apply a <em>different</em> centering / scaling than what
we used while training. Proper use of a <code>recipe</code> helps keep our code simple,
readable, and error-free. Furthermore, note that using <code>prep</code> and <code>bake</code> is
required only when you want to inspect the result of the preprocessing steps
yourself. You will see further on in Section
<a href="classification1.html#puttingittogetherworkflow">5.8</a> that <code>tidymodels</code> provides tools to
automatically apply <code>prep</code> and <code>bake</code> as necessary without additional coding effort.</p>
<p>Figure <a href="classification1.html#fig:05-scaling-plt">5.9</a> shows the two scatter plots side-by-side—one for <code>unscaled_cancer</code> and one for
<code>scaled_cancer</code>. Each has the same new observation annotated with its <span class="math inline">\(K=3\)</span> nearest neighbors.
In the original unstandardized data plot, you can see some odd choices
for the three nearest neighbors. In particular, the “neighbors” are visually
well within the cloud of benign observations, and the neighbors are all nearly
vertically aligned with the new observation (which is why it looks like there
is only one black line on this plot). Figure <a href="classification1.html#fig:05-scaling-plt-zoomed">5.10</a>
shows a close-up of that region on the unstandardized plot. Here the computation of nearest
neighbors is dominated by the much larger-scale area variable. The plot for standardized data
on the right in Figure <a href="classification1.html#fig:05-scaling-plt">5.9</a> shows a much more intuitively reasonable
selection of nearest neighbors. Thus, standardizing the data can change things
in an important way when we are using predictive algorithms.
Standardizing your data should be a part of the preprocessing you do
before predictive modeling and you should always think carefully about your problem domain and
whether you need to standardize your data.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:05-scaling-plt"></span>
<img src="_main_files/figure-html/05-scaling-plt-1.png" alt="Comparison of K = 3 nearest neighbors with unstandardized and standardized data." width="672" />
<p class="caption">
Figure 5.9: Comparison of K = 3 nearest neighbors with unstandardized and standardized data.
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:05-scaling-plt-zoomed"></span>
<img src="_main_files/figure-html/05-scaling-plt-zoomed-1.png" alt="Close-up of three nearest neighbors for unstandardized data." width="864" />
<p class="caption">
Figure 5.10: Close-up of three nearest neighbors for unstandardized data.
</p>
</div>
</div>
<div id="balancing" class="section level3 hasAnchor" number="5.7.2">
<h3><span class="header-section-number">5.7.2</span> Balancing<a href="classification1.html#balancing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another potential issue in a data set for a classifier is <em>class imbalance</em>,
i.e., when one label is much more common than another. Since classifiers like
the K-nearest neighbors algorithm use the labels of nearby points to predict
the label of a new point, if there are many more data points with one label
overall, the algorithm is more likely to pick that label in general (even if
the “pattern” of data suggests otherwise). Class imbalance is actually quite a
common and important problem: from rare disease diagnosis to malicious email
detection, there are many cases in which the “important” class to identify
(presence of disease, malicious email) is much rarer than the “unimportant”
class (no disease, normal email).</p>
<p>To better illustrate the problem, let’s revisit the scaled breast cancer data,
<code>cancer</code>; except now we will remove many of the observations of malignant tumors, simulating
what the data would look like if the cancer was rare. We will do this by
picking only 3 observations from the malignant group, and keeping all
of the benign observations.
We choose these 3 observations using the <code>slice_head</code>
function, which takes two arguments: a data frame-like object,
and the number of rows to select from the top (<code>n</code>).
We will use the <code>bind_rows</code> function to glue the two resulting filtered
data frames back together, and name the result <code>rare_cancer</code>.
The new imbalanced data is shown in Figure <a href="classification1.html#fig:05-unbalanced">5.11</a>.</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="classification1.html#cb295-1" tabindex="-1"></a>rare_cancer <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb295-2"><a href="classification1.html#cb295-2" tabindex="-1"></a>      <span class="fu">filter</span>(cancer, Class <span class="sc">==</span> <span class="st">&quot;Benign&quot;</span>),</span>
<span id="cb295-3"><a href="classification1.html#cb295-3" tabindex="-1"></a>      cancer <span class="sc">|&gt;</span> <span class="fu">filter</span>(Class <span class="sc">==</span> <span class="st">&quot;Malignant&quot;</span>) <span class="sc">|&gt;</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb295-4"><a href="classification1.html#cb295-4" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb295-5"><a href="classification1.html#cb295-5" tabindex="-1"></a>    <span class="fu">select</span>(Class, Perimeter, Concavity)</span>
<span id="cb295-6"><a href="classification1.html#cb295-6" tabindex="-1"></a></span>
<span id="cb295-7"><a href="classification1.html#cb295-7" tabindex="-1"></a>rare_plot <span class="ot">&lt;-</span> rare_cancer <span class="sc">|&gt;</span></span>
<span id="cb295-8"><a href="classification1.html#cb295-8" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Perimeter, <span class="at">y =</span> Concavity, <span class="at">color =</span> Class)) <span class="sc">+</span></span>
<span id="cb295-9"><a href="classification1.html#cb295-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb295-10"><a href="classification1.html#cb295-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Perimeter (standardized)&quot;</span>,</span>
<span id="cb295-11"><a href="classification1.html#cb295-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Concavity (standardized)&quot;</span>,</span>
<span id="cb295-12"><a href="classification1.html#cb295-12" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Diagnosis&quot;</span>) <span class="sc">+</span></span>
<span id="cb295-13"><a href="classification1.html#cb295-13" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;steelblue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb295-14"><a href="classification1.html#cb295-14" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb295-15"><a href="classification1.html#cb295-15" tabindex="-1"></a></span>
<span id="cb295-16"><a href="classification1.html#cb295-16" tabindex="-1"></a>rare_plot</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:05-unbalanced"></span>
<img src="_main_files/figure-html/05-unbalanced-1.png" alt="Imbalanced data." width="432"  />
<p class="caption">
Figure 5.11: Imbalanced data.
</p>
</div>
<p>Suppose we now decided to use <span class="math inline">\(K = 7\)</span> in K-nearest neighbors classification.
With only 3 observations of malignant tumors, the classifier
will <em>always predict that the tumor is benign, no matter what its concavity and perimeter
are!</em> This is because in a majority vote of 7 observations, at most 3 will be
malignant (we only have 3 total malignant observations), so at least 4 must be
benign, and the benign vote will always win. For example, Figure <a href="classification1.html#fig:05-upsample">5.12</a>
shows what happens for a new tumor observation that is quite close to three observations
in the training data that were tagged as malignant.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:05-upsample"></span>
<img src="_main_files/figure-html/05-upsample-1.png" alt="Imbalanced data with 7 nearest neighbors to a new observation highlighted." width="432" />
<p class="caption">
Figure 5.12: Imbalanced data with 7 nearest neighbors to a new observation highlighted.
</p>
</div>
<p>Figure <a href="classification1.html#fig:05-upsample-2">5.13</a> shows what happens if we set the background color of
each area of the plot to the prediction the K-nearest neighbors
classifier would make for a new observation at that location. We can see that the decision is
always “benign,” corresponding to the blue color.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:05-upsample-2"></span>
<img src="_main_files/figure-html/05-upsample-2-1.png" alt="Imbalanced data with background color indicating the decision of the classifier and the points represent the labeled data." width="432" />
<p class="caption">
Figure 5.13: Imbalanced data with background color indicating the decision of the classifier and the points represent the labeled data.
</p>
</div>
<p>Despite the simplicity of the problem, solving it in a statistically sound manner is actually
fairly nuanced, and a careful treatment would require a lot more detail and mathematics than we will cover in this textbook.
For the present purposes, it will suffice to rebalance the data by <em>oversampling</em> the rare class.
In other words, we will replicate rare observations multiple times in our data set to give them more
voting power in the K-nearest neighbors algorithm. In order to do this, we will add an oversampling
step to the earlier <code>uc_recipe</code> recipe with the <code>step_upsample</code> function from the <code>themis</code> R package.
We show below how to do this, and also
use the <code>group_by</code> and <code>summarize</code> functions to see that our classes are now balanced:</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="classification1.html#cb296-1" tabindex="-1"></a><span class="fu">library</span>(themis)</span>
<span id="cb296-2"><a href="classification1.html#cb296-2" tabindex="-1"></a></span>
<span id="cb296-3"><a href="classification1.html#cb296-3" tabindex="-1"></a>ups_recipe <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Class <span class="sc">~</span> ., <span class="at">data =</span> rare_cancer) <span class="sc">|&gt;</span></span>
<span id="cb296-4"><a href="classification1.html#cb296-4" tabindex="-1"></a>  <span class="fu">step_upsample</span>(Class, <span class="at">over_ratio =</span> <span class="dv">1</span>, <span class="at">skip =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb296-5"><a href="classification1.html#cb296-5" tabindex="-1"></a>  <span class="fu">prep</span>()</span>
<span id="cb296-6"><a href="classification1.html#cb296-6" tabindex="-1"></a></span>
<span id="cb296-7"><a href="classification1.html#cb296-7" tabindex="-1"></a>ups_recipe</span></code></pre></div>
<pre><code>## 
## ── Recipe ──────────
## 
## ── Inputs 
## Number of variables by role
## outcome:   1
## predictor: 2
## 
## ── Training information 
## Training data contained 360 data points and no incomplete rows.
## 
## ── Operations 
## • Up-sampling based on: Class | Trained</code></pre>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="classification1.html#cb298-1" tabindex="-1"></a>upsampled_cancer <span class="ot">&lt;-</span> <span class="fu">bake</span>(ups_recipe, rare_cancer)</span>
<span id="cb298-2"><a href="classification1.html#cb298-2" tabindex="-1"></a></span>
<span id="cb298-3"><a href="classification1.html#cb298-3" tabindex="-1"></a>upsampled_cancer <span class="sc">|&gt;</span></span>
<span id="cb298-4"><a href="classification1.html#cb298-4" tabindex="-1"></a>  <span class="fu">group_by</span>(Class) <span class="sc">|&gt;</span></span>
<span id="cb298-5"><a href="classification1.html#cb298-5" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   Class         n
##   &lt;fct&gt;     &lt;int&gt;
## 1 Malignant   357
## 2 Benign      357</code></pre>
<p>Now suppose we train our K-nearest neighbors classifier with <span class="math inline">\(K=7\)</span> on this <em>balanced</em> data.
Figure <a href="classification1.html#fig:05-upsample-plot">5.14</a> shows what happens now when we set the background color
of each area of our scatter plot to the decision the K-nearest neighbors
classifier would make. We can see that the decision is more reasonable; when the points are close
to those labeled malignant, the classifier predicts a malignant tumor, and vice versa when they are
closer to the benign tumor observations.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:05-upsample-plot"></span>
<img src="_main_files/figure-html/05-upsample-plot-1.png" alt="Upsampled data with background color indicating the decision of the classifier." width="432"  />
<p class="caption">
Figure 5.14: Upsampled data with background color indicating the decision of the classifier.
</p>
</div>
</div>
<div id="missing-data" class="section level3 hasAnchor" number="5.7.3">
<h3><span class="header-section-number">5.7.3</span> Missing data<a href="classification1.html#missing-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One of the most common issues in real data sets in the wild is <em>missing data</em>,
i.e., observations where the values of some of the variables were not recorded.
Unfortunately, as common as it is, handling missing data properly is very
challenging and generally relies on expert knowledge about the data, setting,
and how the data were collected. One typical challenge with missing data is
that missing entries can be <em>informative</em>: the very fact that an entries were
missing is related to the values of other variables. For example, survey
participants from a marginalized group of people may be less likely to respond
to certain kinds of questions if they fear that answering honestly will come
with negative consequences. In that case, if we were to simply throw away data
with missing entries, we would bias the conclusions of the survey by
inadvertently removing many members of that group of respondents. So ignoring
this issue in real problems can easily lead to misleading analyses, with
detrimental impacts. In this book, we will cover only those techniques for
dealing with missing entries in situations where missing entries are just
“randomly missing”, i.e., where the fact that certain entries are missing
<em>isn’t related to anything else</em> about the observation.</p>
<p>Let’s load and examine a modified subset of the tumor image data
that has a few missing entries:</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="classification1.html#cb300-1" tabindex="-1"></a>missing_cancer <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/wdbc_missing.csv&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb300-2"><a href="classification1.html#cb300-2" tabindex="-1"></a>  <span class="fu">select</span>(Class, Radius, Texture, Perimeter) <span class="sc">|&gt;</span></span>
<span id="cb300-3"><a href="classification1.html#cb300-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">as_factor</span>(Class)) <span class="sc">|&gt;</span></span>
<span id="cb300-4"><a href="classification1.html#cb300-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">fct_recode</span>(Class, <span class="st">&quot;Malignant&quot;</span> <span class="ot">=</span> <span class="st">&quot;M&quot;</span>, <span class="st">&quot;Benign&quot;</span> <span class="ot">=</span> <span class="st">&quot;B&quot;</span>))</span>
<span id="cb300-5"><a href="classification1.html#cb300-5" tabindex="-1"></a>missing_cancer</span></code></pre></div>
<pre><code>## # A tibble: 7 × 4
##   Class     Radius Texture Perimeter
##   &lt;fct&gt;      &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
## 1 Malignant NA      NA         1.27 
## 2 Malignant  1.83   -0.353     1.68 
## 3 Malignant  1.58   NA         1.57 
## 4 Malignant -0.768   0.254    -0.592
## 5 Malignant  1.75   -1.15      1.78 
## 6 Malignant -0.476  -0.835    -0.387
## 7 Malignant  1.17    0.161     1.14</code></pre>
<p>Recall that K-nearest neighbors classification makes predictions by computing
the straight-line distance to nearby training observations, and hence requires
access to the values of <em>all</em> variables for <em>all</em> observations in the training
data. So how can we perform K-nearest neighbors classification in the presence
of missing data? Well, since there are not too many observations with missing
entries, one option is to simply remove those observations prior to building
the K-nearest neighbors classifier. We can accomplish this by using the
<code>drop_na</code> function from <code>tidyverse</code> prior to working with the data.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="classification1.html#cb302-1" tabindex="-1"></a>no_missing_cancer <span class="ot">&lt;-</span> missing_cancer <span class="sc">|&gt;</span> <span class="fu">drop_na</span>()</span>
<span id="cb302-2"><a href="classification1.html#cb302-2" tabindex="-1"></a>no_missing_cancer</span></code></pre></div>
<pre><code>## # A tibble: 5 × 4
##   Class     Radius Texture Perimeter
##   &lt;fct&gt;      &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
## 1 Malignant  1.83   -0.353     1.68 
## 2 Malignant -0.768   0.254    -0.592
## 3 Malignant  1.75   -1.15      1.78 
## 4 Malignant -0.476  -0.835    -0.387
## 5 Malignant  1.17    0.161     1.14</code></pre>
<p>However, this strategy will not work when many of the rows have missing
entries, as we may end up throwing away too much data. In this case, another
possible approach is to <em>impute</em> the missing entries, i.e., fill in synthetic
values based on the other observations in the data set. One reasonable choice
is to perform <em>mean imputation</em>, where missing entries are filled in using the
mean of the present entries in each variable. To perform mean imputation, we
add the <code>step_impute_mean</code>
step to the <code>tidymodels</code> preprocessing recipe.</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="classification1.html#cb304-1" tabindex="-1"></a>impute_missing_recipe <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Class <span class="sc">~</span> ., <span class="at">data =</span> missing_cancer) <span class="sc">|&gt;</span></span>
<span id="cb304-2"><a href="classification1.html#cb304-2" tabindex="-1"></a>  <span class="fu">step_impute_mean</span>(<span class="fu">all_predictors</span>()) <span class="sc">|&gt;</span></span>
<span id="cb304-3"><a href="classification1.html#cb304-3" tabindex="-1"></a>  <span class="fu">prep</span>()</span>
<span id="cb304-4"><a href="classification1.html#cb304-4" tabindex="-1"></a>impute_missing_recipe</span></code></pre></div>
<pre><code>## 
## ── Recipe ──────────
## 
## ── Inputs 
## Number of variables by role
## outcome:   1
## predictor: 3
## 
## ── Training information 
## Training data contained 7 data points and 2 incomplete rows.
## 
## ── Operations 
## • Mean imputation for: Radius, Texture, Perimeter | Trained</code></pre>
<p>To visualize what mean imputation does, let’s just apply the recipe directly to the <code>missing_cancer</code>
data frame using the <code>bake</code> function. The imputation step fills in the missing
entries with the mean values of their corresponding variables.</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="classification1.html#cb306-1" tabindex="-1"></a>imputed_cancer <span class="ot">&lt;-</span> <span class="fu">bake</span>(impute_missing_recipe, missing_cancer)</span>
<span id="cb306-2"><a href="classification1.html#cb306-2" tabindex="-1"></a>imputed_cancer</span></code></pre></div>
<pre><code>## # A tibble: 7 × 4
##   Radius Texture Perimeter Class    
##    &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt;    
## 1  0.847  -0.385     1.27  Malignant
## 2  1.83   -0.353     1.68  Malignant
## 3  1.58   -0.385     1.57  Malignant
## 4 -0.768   0.254    -0.592 Malignant
## 5  1.75   -1.15      1.78  Malignant
## 6 -0.476  -0.835    -0.387 Malignant
## 7  1.17    0.161     1.14  Malignant</code></pre>
<p>Many other options for missing data imputation can be found in
<a href="https://recipes.tidymodels.org/reference/index.html">the <code>recipes</code> documentation</a>. However
you decide to handle missing data in your data analysis, it is always crucial
to think critically about the setting, how the data were collected, and the
question you are answering.</p>
</div>
</div>
<div id="puttingittogetherworkflow" class="section level2 hasAnchor" number="5.8">
<h2><span class="header-section-number">5.8</span> Putting it together in a <code>workflow</code><a href="classification1.html#puttingittogetherworkflow" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>tidymodels</code> package collection also provides the <code>workflow</code>, a way to
chain together
multiple data analysis steps without a lot of otherwise necessary code for
intermediate steps. To illustrate the whole pipeline, let’s start from scratch
with the <code>wdbc_unscaled.csv</code> data. First we will load the data, create a
model, and specify a recipe for how the data should be preprocessed:</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="classification1.html#cb308-1" tabindex="-1"></a><span class="co"># load the unscaled cancer data</span></span>
<span id="cb308-2"><a href="classification1.html#cb308-2" tabindex="-1"></a><span class="co"># and make sure the response variable, Class, is a factor</span></span>
<span id="cb308-3"><a href="classification1.html#cb308-3" tabindex="-1"></a>unscaled_cancer <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/wdbc_unscaled.csv&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb308-4"><a href="classification1.html#cb308-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">as_factor</span>(Class)) <span class="sc">|&gt;</span></span>
<span id="cb308-5"><a href="classification1.html#cb308-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Class =</span> <span class="fu">fct_recode</span>(Class, <span class="st">&quot;Malignant&quot;</span> <span class="ot">=</span> <span class="st">&quot;M&quot;</span>, <span class="st">&quot;Benign&quot;</span> <span class="ot">=</span> <span class="st">&quot;B&quot;</span>))</span>
<span id="cb308-6"><a href="classification1.html#cb308-6" tabindex="-1"></a></span>
<span id="cb308-7"><a href="classification1.html#cb308-7" tabindex="-1"></a><span class="co"># create the K-NN model</span></span>
<span id="cb308-8"><a href="classification1.html#cb308-8" tabindex="-1"></a>knn_spec <span class="ot">&lt;-</span> <span class="fu">nearest_neighbor</span>(<span class="at">weight_func =</span> <span class="st">&quot;rectangular&quot;</span>, <span class="at">neighbors =</span> <span class="dv">7</span>) <span class="sc">|&gt;</span></span>
<span id="cb308-9"><a href="classification1.html#cb308-9" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;kknn&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb308-10"><a href="classification1.html#cb308-10" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&quot;classification&quot;</span>)</span>
<span id="cb308-11"><a href="classification1.html#cb308-11" tabindex="-1"></a></span>
<span id="cb308-12"><a href="classification1.html#cb308-12" tabindex="-1"></a><span class="co"># create the centering / scaling recipe</span></span>
<span id="cb308-13"><a href="classification1.html#cb308-13" tabindex="-1"></a>uc_recipe <span class="ot">&lt;-</span> <span class="fu">recipe</span>(Class <span class="sc">~</span> Area <span class="sc">+</span> Smoothness, <span class="at">data =</span> unscaled_cancer) <span class="sc">|&gt;</span></span>
<span id="cb308-14"><a href="classification1.html#cb308-14" tabindex="-1"></a>  <span class="fu">step_scale</span>(<span class="fu">all_predictors</span>()) <span class="sc">|&gt;</span></span>
<span id="cb308-15"><a href="classification1.html#cb308-15" tabindex="-1"></a>  <span class="fu">step_center</span>(<span class="fu">all_predictors</span>())</span></code></pre></div>
<p>Note that each of these steps is exactly the same as earlier, except for one major difference:
we did not use the <code>select</code> function to extract the relevant variables from the data frame,
and instead simply specified the relevant variables to use via the
formula <code>Class ~ Area + Smoothness</code> (instead of <code>Class ~ .</code>) in the recipe.
You will also notice that we did not call <code>prep()</code> on the recipe; this is unnecessary when it is
placed in a workflow.</p>
<p>We will now place these steps in a <code>workflow</code> using the <code>add_recipe</code> and <code>add_model</code> functions,
and finally we will use the <code>fit</code> function to run the whole workflow on the <code>unscaled_cancer</code> data.
Note another difference from earlier here: we do not include a formula in the <code>fit</code> function. This
is again because we included the formula in the recipe, so there is no need to respecify it:</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="classification1.html#cb309-1" tabindex="-1"></a>knn_fit <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">|&gt;</span></span>
<span id="cb309-2"><a href="classification1.html#cb309-2" tabindex="-1"></a>  <span class="fu">add_recipe</span>(uc_recipe) <span class="sc">|&gt;</span></span>
<span id="cb309-3"><a href="classification1.html#cb309-3" tabindex="-1"></a>  <span class="fu">add_model</span>(knn_spec) <span class="sc">|&gt;</span></span>
<span id="cb309-4"><a href="classification1.html#cb309-4" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> unscaled_cancer)</span>
<span id="cb309-5"><a href="classification1.html#cb309-5" tabindex="-1"></a></span>
<span id="cb309-6"><a href="classification1.html#cb309-6" tabindex="-1"></a>knn_fit</span></code></pre></div>
<pre><code>## ══ Workflow [trained] ══════════
## Preprocessor: Recipe
## Model: nearest_neighbor()
## 
## ── Preprocessor ──────────
## 2 Recipe Steps
## 
## • step_scale()
## • step_center()
## 
## ── Model ──────────
## 
## Call:
## kknn::train.kknn(formula = ..y ~ ., data = data, ks = min_rows(7,     data, 5), 
## kernel = ~&quot;rectangular&quot;)
## 
## Type of response variable: nominal
## Minimal misclassification: 0.112478
## Best kernel: rectangular
## Best k: 7</code></pre>
<p>As before, the fit object lists the function that trains the model as well as the “best” settings
for the number of neighbors and weight function (for now, these are just the values we chose
manually when we created <code>knn_spec</code> above). But now the fit object also includes information about
the overall workflow, including the centering and scaling preprocessing steps.
In other words, when we use the <code>predict</code> function with the <code>knn_fit</code> object to make a prediction for a new
observation, it will first apply the same recipe steps to the new observation.
As an example, we will predict the class label of two new observations:
one with <code>Area = 500</code> and <code>Smoothness = 0.075</code>, and one with <code>Area = 1500</code> and <code>Smoothness = 0.1</code>.</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="classification1.html#cb311-1" tabindex="-1"></a>new_observation <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Area =</span> <span class="fu">c</span>(<span class="dv">500</span>, <span class="dv">1500</span>), <span class="at">Smoothness =</span> <span class="fu">c</span>(<span class="fl">0.075</span>, <span class="fl">0.1</span>))</span>
<span id="cb311-2"><a href="classification1.html#cb311-2" tabindex="-1"></a>prediction <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_fit, new_observation)</span>
<span id="cb311-3"><a href="classification1.html#cb311-3" tabindex="-1"></a></span>
<span id="cb311-4"><a href="classification1.html#cb311-4" tabindex="-1"></a>prediction</span></code></pre></div>
<pre><code>## # A tibble: 2 × 1
##   .pred_class
##   &lt;fct&gt;      
## 1 Benign     
## 2 Malignant</code></pre>
<p>The classifier predicts that the first observation is benign, while the second is
malignant. Figure <a href="classification1.html#fig:05-workflow-plot-show">5.15</a> visualizes the predictions that this
trained K-nearest neighbors model will make on a large range of new observations.
Although you have seen colored prediction map visualizations like this a few times now,
we have not included the code to generate them, as it is a little bit complicated.
For the interested reader who wants a learning challenge, we now include it below.
The basic idea is to create a grid of synthetic new observations using the <code>expand.grid</code> function,
predict the label of each, and visualize the predictions with a colored scatter having a very high transparency
(low <code>alpha</code> value) and large point radius. See if you can figure out what each line is doing!</p>
<div style="page-break-after: always;"></div>
<blockquote>
<p><strong>Note:</strong> Understanding this code is not required for the remainder of the
textbook. It is included for those readers who would like to use similar
visualizations in their own data analyses.</p>
</blockquote>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="classification1.html#cb313-1" tabindex="-1"></a><span class="co"># create the grid of area/smoothness vals, and arrange in a data frame</span></span>
<span id="cb313-2"><a href="classification1.html#cb313-2" tabindex="-1"></a>are_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(unscaled_cancer<span class="sc">$</span>Area),</span>
<span id="cb313-3"><a href="classification1.html#cb313-3" tabindex="-1"></a>                <span class="fu">max</span>(unscaled_cancer<span class="sc">$</span>Area),</span>
<span id="cb313-4"><a href="classification1.html#cb313-4" tabindex="-1"></a>                <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb313-5"><a href="classification1.html#cb313-5" tabindex="-1"></a>smo_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(unscaled_cancer<span class="sc">$</span>Smoothness),</span>
<span id="cb313-6"><a href="classification1.html#cb313-6" tabindex="-1"></a>                <span class="fu">max</span>(unscaled_cancer<span class="sc">$</span>Smoothness),</span>
<span id="cb313-7"><a href="classification1.html#cb313-7" tabindex="-1"></a>                <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb313-8"><a href="classification1.html#cb313-8" tabindex="-1"></a>asgrid <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">expand.grid</span>(<span class="at">Area =</span> are_grid,</span>
<span id="cb313-9"><a href="classification1.html#cb313-9" tabindex="-1"></a>                                <span class="at">Smoothness =</span> smo_grid))</span>
<span id="cb313-10"><a href="classification1.html#cb313-10" tabindex="-1"></a></span>
<span id="cb313-11"><a href="classification1.html#cb313-11" tabindex="-1"></a><span class="co"># use the fit workflow to make predictions at the grid points</span></span>
<span id="cb313-12"><a href="classification1.html#cb313-12" tabindex="-1"></a>knnPredGrid <span class="ot">&lt;-</span> <span class="fu">predict</span>(knn_fit, asgrid)</span>
<span id="cb313-13"><a href="classification1.html#cb313-13" tabindex="-1"></a></span>
<span id="cb313-14"><a href="classification1.html#cb313-14" tabindex="-1"></a><span class="co"># bind the predictions as a new column with the grid points</span></span>
<span id="cb313-15"><a href="classification1.html#cb313-15" tabindex="-1"></a>prediction_table <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(knnPredGrid, asgrid) <span class="sc">|&gt;</span></span>
<span id="cb313-16"><a href="classification1.html#cb313-16" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Class =</span> .pred_class)</span>
<span id="cb313-17"><a href="classification1.html#cb313-17" tabindex="-1"></a></span>
<span id="cb313-18"><a href="classification1.html#cb313-18" tabindex="-1"></a><span class="co"># plot:</span></span>
<span id="cb313-19"><a href="classification1.html#cb313-19" tabindex="-1"></a><span class="co"># 1. the colored scatter of the original data</span></span>
<span id="cb313-20"><a href="classification1.html#cb313-20" tabindex="-1"></a><span class="co"># 2. the faded colored scatter for the grid points</span></span>
<span id="cb313-21"><a href="classification1.html#cb313-21" tabindex="-1"></a>wkflw_plot <span class="ot">&lt;-</span></span>
<span id="cb313-22"><a href="classification1.html#cb313-22" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb313-23"><a href="classification1.html#cb313-23" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> unscaled_cancer,</span>
<span id="cb313-24"><a href="classification1.html#cb313-24" tabindex="-1"></a>             <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Area,</span>
<span id="cb313-25"><a href="classification1.html#cb313-25" tabindex="-1"></a>                           <span class="at">y =</span> Smoothness,</span>
<span id="cb313-26"><a href="classification1.html#cb313-26" tabindex="-1"></a>                           <span class="at">color =</span> Class),</span>
<span id="cb313-27"><a href="classification1.html#cb313-27" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb313-28"><a href="classification1.html#cb313-28" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> prediction_table,</span>
<span id="cb313-29"><a href="classification1.html#cb313-29" tabindex="-1"></a>             <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Area,</span>
<span id="cb313-30"><a href="classification1.html#cb313-30" tabindex="-1"></a>                           <span class="at">y =</span> Smoothness,</span>
<span id="cb313-31"><a href="classification1.html#cb313-31" tabindex="-1"></a>                           <span class="at">color =</span> Class),</span>
<span id="cb313-32"><a href="classification1.html#cb313-32" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.02</span>,</span>
<span id="cb313-33"><a href="classification1.html#cb313-33" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb313-34"><a href="classification1.html#cb313-34" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;Diagnosis&quot;</span>,</span>
<span id="cb313-35"><a href="classification1.html#cb313-35" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Area&quot;</span>,</span>
<span id="cb313-36"><a href="classification1.html#cb313-36" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Smoothness&quot;</span>) <span class="sc">+</span></span>
<span id="cb313-37"><a href="classification1.html#cb313-37" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;darkorange&quot;</span>, <span class="st">&quot;steelblue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb313-38"><a href="classification1.html#cb313-38" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb313-39"><a href="classification1.html#cb313-39" tabindex="-1"></a></span>
<span id="cb313-40"><a href="classification1.html#cb313-40" tabindex="-1"></a>wkflw_plot</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:05-workflow-plot-show"></span>
<img src="_main_files/figure-html/05-workflow-plot-show-1.png" alt="Scatter plot of smoothness versus area where background color indicates the decision of the classifier." width="441.6" />
<p class="caption">
Figure 5.15: Scatter plot of smoothness versus area where background color indicates the decision of the classifier.
</p>
</div>
</div>
<div id="exercises-4" class="section level2 hasAnchor" number="5.9">
<h2><span class="header-section-number">5.9</span> Exercises<a href="classification1.html#exercises-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Practice exercises for the material covered in this chapter
can be found in the accompanying
<a href="https://worksheets.datasciencebook.ca">worksheets repository</a>
in the “Classification I: training and predicting” row.
You can launch an interactive version of the worksheet in your browser by clicking the “launch binder” button.
You can also preview a non-interactive version of the worksheet by clicking “view worksheet.”
If you instead decide to download the worksheet and run it on your own machine,
make sure to follow the instructions for computer setup
found in Chapter <a href="setup.html#setup">13</a>. This will ensure that the automated feedback
and guidance that the worksheets provide will function as intended.</p>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-knncover" class="csl-entry">
Cover, Thomas, and Peter Hart. 1967. <span>“Nearest Neighbor Pattern Classification.”</span> <em>IEEE Transactions on Information Theory</em> 13 (1): 21–27.
</div>
<div id="ref-knnfix" class="csl-entry">
Fix, Evelyn, and Joseph Hodges. 1951. <span>“Discriminatory Analysis. Nonparametric Discrimination: Consistency Properties.”</span> USAF School of Aviation Medicine, Randolph Field, Texas.
</div>
<div id="ref-parsnip" class="csl-entry">
Kuhn, Max, and David Vaughan. 2021. <em><span class="nocase">parsnip R package</span></em>. <a href="https://parsnip.tidymodels.org/">https://parsnip.tidymodels.org/</a>.
</div>
<div id="ref-recipes" class="csl-entry">
Kuhn, Max, and Hadley Wickham. 2021. <em><span class="nocase">recipes R package</span></em>. <a href="https://recipes.tidymodels.org/">https://recipes.tidymodels.org/</a>.
</div>
<div id="ref-stanfordhealthcare" class="csl-entry">
Stanford Health Care. 2021. <span>“What Is Cancer?”</span> <a href="https://stanfordhealthcare.org/medical-conditions/cancer/cancer.html">https://stanfordhealthcare.org/medical-conditions/cancer/cancer.html</a>.
</div>
<div id="ref-streetbreastcancer" class="csl-entry">
Street, William Nick, William Wolberg, and Olvi Mangasarian. 1993. <span>“Nuclear Feature Extraction for Breast Tumor Diagnosis.”</span> In <em>International Symposium on Electronic Imaging: Science and Technology</em>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="viz.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="classification2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
